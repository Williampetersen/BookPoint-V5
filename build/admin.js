(()=>{"use strict";var e={338(e,t,i){var d=i(795);t.H=d.createRoot,d.hydrateRoot},795(e){e.exports=window.ReactDOM}},t={};const i=window.React;var d=function i(d){var l=t[d];if(void 0!==l)return l.exports;var n=t[d]={exports:{}};return e[d](n,n.exports,i),n.exports}(338);async function l(e,t={}){const i=(window.BP_ADMIN?.restUrl||"/wp-json/bp/v1").replace(/\/$/,"")+e,d={"Content-Type":"application/json",...t.headers||{}},l=window.BP_ADMIN?.nonce;l&&(d["X-WP-Nonce"]=l);const n="string"==typeof t.body?t.body:t.body?JSON.stringify(t.body):void 0,s=await fetch(i,{method:t.method||"GET",credentials:"same-origin",headers:d,body:n}),o=await s.json().catch(()=>({}));if(!s.ok||"error"===o?.status){const e=new Error(o?.message||"Request failed");throw e.status=s.status,e.payload=o,e}return o}const n=window.ReactJSXRuntime,s=["text","email","tel","textarea","number","date","select","checkbox"],o=[{value:"details",label:"Details"},{value:"payment",label:"Payment"},{value:"summary",label:"Summary"}];function r(){const[e,t]=(0,i.useState)("customer"),[d,r]=(0,i.useState)([]),[c,f]=(0,i.useState)(""),[p,h]=(0,i.useState)(""),[x,W]=(0,i.useState)(!1),[A,B]=(0,i.useState)(!1),[T,D]=(0,i.useState)(null),[E,F]=(0,i.useState)(null),[N,q]=(0,i.useState)(!1),[P,I]=(0,i.useState)({field_key:"",label:"",type:"text",step_key:"details",placeholder:"",is_required:!1,is_enabled:!0,show_in_wizard:!0});async function L(){W(!0),f("");try{const t=await l(`/admin/form-fields?scope=${e}`);r(t?.data||[])}catch(e){r([]),f(e.message||"Failed to load")}finally{W(!1)}}return(0,i.useEffect)(()=>{L()},[e]),(0,n.jsxs)("div",{style:{padding:18},children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:12,flexWrap:"wrap",marginBottom:20},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{style:{margin:"0 0 6px 0",fontSize:24,fontWeight:1e3},children:"Form Fields"}),(0,n.jsx)("p",{style:{margin:0,opacity:.7,fontSize:13},children:"Manage custom form fields for booking wizard"})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[(0,n.jsx)("button",{onClick:()=>t("customer"),style:C("customer"===e),children:"ðŸ‘¤ Customer"}),(0,n.jsx)("button",{onClick:()=>t("booking"),style:C("booking"===e),children:"ðŸ“… Booking"}),(0,n.jsx)("button",{onClick:async function(){if(confirm("Reseed all default fields (first_name, last_name, email, phone, notes)?")){f(""),h("");try{await l("/admin/form-fields/reseed",{method:"POST",body:{}}),h("Defaults reseeded!"),await L(),setTimeout(()=>h(""),3e3)}catch(e){f(e.message||"Reseed failed")}}},style:{...S,fontSize:12,padding:"8px 12px"},children:"ðŸ”„ Reseed Defaults"}),(0,n.jsx)("button",{onClick:()=>{D(null),I({field_key:"",label:"",type:"text",step_key:"details",placeholder:"",is_required:!1,is_enabled:!0,show_in_wizard:!0}),B(!0)},style:_,children:"+ Add Field"})]})]}),c&&(0,n.jsx)("div",{style:k,children:c}),p&&(0,n.jsx)("div",{style:w,children:p}),(0,n.jsxs)("div",{style:y,children:[x?(0,n.jsx)("div",{style:{padding:20,textAlign:"center",fontWeight:900},children:"â³ Loadingâ€¦"}):null,!x&&0===d.length&&(0,n.jsx)("div",{style:{padding:20,textAlign:"center",opacity:.7,fontWeight:900},children:"ðŸ“­ No fields yet. Add one to get started!"}),!x&&d.length>0&&(0,n.jsx)("div",{style:{overflowX:"auto"},children:(0,n.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",minWidth:900},children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{style:{background:"#f9fafb",borderBottom:"2px solid #e5e7eb"},children:[(0,n.jsx)("th",{style:b,children:"Key"}),(0,n.jsx)("th",{style:b,children:"Label"}),(0,n.jsx)("th",{style:b,children:"Type"}),(0,n.jsx)("th",{style:b,style:{textAlign:"center"},children:"Step"}),(0,n.jsx)("th",{style:b,style:{textAlign:"center"},children:"Required"}),(0,n.jsx)("th",{style:b,style:{textAlign:"center"},children:"Wizard"}),(0,n.jsx)("th",{style:b,style:{textAlign:"center"},children:"Enabled"}),(0,n.jsx)("th",{style:{...b,textAlign:"right"},children:"Actions"})]})}),(0,n.jsx)("tbody",{children:d.map(e=>(0,n.jsxs)("tr",{style:{borderBottom:"1px solid #f3f4f6",":hover":{background:"#fafbfc"}},children:[(0,n.jsx)("td",{style:u,children:(0,n.jsx)("code",{style:{background:"#f1f5f9",padding:"4px 8px",borderRadius:6,fontSize:12,fontWeight:900},children:e.field_key})}),(0,n.jsx)("td",{style:u,children:e.label}),(0,n.jsx)("td",{style:u,children:(0,n.jsx)("span",{style:{background:"#eef2ff",color:"#3730a3",padding:"4px 8px",borderRadius:6,fontSize:12,fontWeight:900},children:e.type})}),(0,n.jsx)("td",{style:{...u,textAlign:"center",fontSize:12},children:e.step_key}),(0,n.jsx)("td",{style:{...u,textAlign:"center"},children:Number(e.is_required)?"âœ…":"âŒ"}),(0,n.jsx)("td",{style:{...u,textAlign:"center"},children:Number(e.show_in_wizard)?"âœ…":"âŒ"}),(0,n.jsx)("td",{style:{...u,textAlign:"center"},children:Number(e.is_enabled)?"âœ…":"âŒ"}),(0,n.jsxs)("td",{style:{...u,textAlign:"right",whiteSpace:"nowrap"},children:[(0,n.jsx)("button",{onClick:()=>{return I({field_key:(t=e).field_key,label:t.label,type:t.type,step_key:t.step_key,placeholder:t.placeholder,is_required:Number(t.is_required),is_enabled:Number(t.is_enabled),show_in_wizard:Number(t.show_in_wizard)}),D(t.id),void B(!0);var t},style:R,disabled:E===e.id,children:"âœï¸ Edit"}),(0,n.jsxs)("button",{onClick:()=>async function(e){if(confirm("Delete this field?")){F(e),f("");try{await l(`/admin/form-fields/${e}`,{method:"DELETE"}),await L(),h("Field deleted!"),setTimeout(()=>h(""),3e3)}catch(e){f(e.message||"Delete failed")}finally{F(null)}}}(e.id),style:{...R,...z},disabled:E===e.id,children:[E===e.id?"â³":"ðŸ—‘ï¸"," Delete"]})]})]},e.id))})]})})]}),A&&(0,n.jsx)(a,{title:T?"Edit Field":"Create Field",onClose:()=>{B(!1),D(null)},onSave:async function(){q(!0),f(""),h("");try{const t={...P,scope:e};T?(await l(`/admin/form-fields/${T}`,{method:"PATCH",body:t}),h("Field updated!")):(await l("/admin/form-fields",{method:"POST",body:t}),h("Field created!")),B(!1),D(null),I({field_key:"",label:"",type:"text",step_key:"details",placeholder:"",is_required:!1,is_enabled:!0,show_in_wizard:!0}),await L(),setTimeout(()=>h(""),3e3)}catch(e){f(e.message||"Save failed")}finally{q(!1)}},submitting:N,children:(0,n.jsxs)("div",{style:{display:"grid",gap:16},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:j,children:"Field Key *"}),(0,n.jsx)("input",{type:"text",value:P.field_key,onChange:e=>I({...P,field_key:e.target.value}),placeholder:"e.g., company_name",style:g,disabled:null!==T})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:j,children:"Label *"}),(0,n.jsx)("input",{type:"text",value:P.label,onChange:e=>I({...P,label:e.target.value}),placeholder:"Display name",style:g})]}),(0,n.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:j,children:"Type *"}),(0,n.jsx)("select",{value:P.type,onChange:e=>I({...P,type:e.target.value}),style:m,children:s.map(e=>(0,n.jsx)("option",{children:e},e))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:j,children:"Step"}),(0,n.jsx)("select",{value:P.step_key,onChange:e=>I({...P,step_key:e.target.value}),style:m,children:o.map(e=>(0,n.jsx)("option",{value:e.value,children:e.label},e.value))})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{style:j,children:"Placeholder"}),(0,n.jsx)("input",{type:"text",value:P.placeholder,onChange:e=>I({...P,placeholder:e.target.value}),placeholder:"Optional placeholder text",style:g})]}),(0,n.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[(0,n.jsxs)("label",{style:v,children:[(0,n.jsx)("input",{type:"checkbox",checked:P.is_required,onChange:e=>I({...P,is_required:e.target.checked})})," Required"]}),(0,n.jsxs)("label",{style:v,children:[(0,n.jsx)("input",{type:"checkbox",checked:P.is_enabled,onChange:e=>I({...P,is_enabled:e.target.checked})})," Enabled"]})]}),(0,n.jsxs)("label",{style:v,children:[(0,n.jsx)("input",{type:"checkbox",checked:P.show_in_wizard,onChange:e=>I({...P,show_in_wizard:e.target.checked})})," Show in Wizard"]})]})})]})}function a({title:e,onClose:t,onSave:i,submitting:d,children:l}){return(0,n.jsx)("div",{style:c,onClick:t,children:(0,n.jsxs)("div",{style:f,onClick:e=>e.stopPropagation(),children:[(0,n.jsxs)("div",{style:p,children:[(0,n.jsx)("h2",{style:{margin:0,fontSize:18,fontWeight:1e3},children:e}),(0,n.jsx)("button",{onClick:t,style:W,disabled:d,children:"âœ•"})]}),(0,n.jsx)("div",{style:h,children:l}),(0,n.jsxs)("div",{style:x,children:[(0,n.jsx)("button",{onClick:t,style:S,disabled:d,children:"Cancel"}),(0,n.jsx)("button",{onClick:i,style:_,disabled:d,children:d?"â³ Savingâ€¦":"ðŸ’¾ Save"})]})]})})}const c={position:"fixed",inset:0,background:"rgba(0,0,0,.3)",zIndex:999998,display:"flex",alignItems:"center",justifyContent:"center"},f={width:"min(600px, calc(100% - 24px))",background:"#fff",borderRadius:18,border:"1px solid #e5e7eb",boxShadow:"0 20px 60px rgba(0,0,0,.25)"},p={padding:20,borderBottom:"1px solid #f3f4f6",display:"flex",justifyContent:"space-between",alignItems:"center"},h={padding:20,maxHeight:"60vh",overflowY:"auto"},x={padding:20,borderTop:"1px solid #f3f4f6",display:"flex",justifyContent:"flex-end",gap:10},y={background:"#fff",border:"1px solid #e5e7eb",borderRadius:18,padding:0,overflow:"hidden"},b={textAlign:"left",padding:"14px 16px",fontWeight:1e3,fontSize:13,background:"#f9fafb",borderBottom:"2px solid #e5e7eb"},u={padding:"14px 16px",verticalAlign:"middle",fontSize:14},g={width:"100%",padding:"10px 12px",borderRadius:10,border:"1px solid #e5e7eb",fontFamily:"inherit",fontWeight:900,fontSize:14,boxSizing:"border-box"},m={width:"100%",padding:"10px 12px",borderRadius:10,border:"1px solid #e5e7eb",fontFamily:"inherit",fontWeight:900,fontSize:14,background:"#fff",boxSizing:"border-box"},j={fontWeight:950,display:"block",marginBottom:8,fontSize:14},v={display:"flex",alignItems:"center",gap:8,fontWeight:900,fontSize:14},k={background:"#fef2f2",border:"1px solid #fecaca",color:"#991b1b",padding:14,borderRadius:12,fontWeight:900,marginBottom:16,fontSize:14},w={background:"#f0fdf4",border:"1px solid #86efac",color:"#166534",padding:14,borderRadius:12,fontWeight:900,marginBottom:16,fontSize:14},_={padding:"10px 16px",borderRadius:10,border:"none",background:"#4318ff",color:"#fff",fontWeight:900,cursor:"pointer",fontSize:14,transition:"all 0.2s",":hover":{background:"#3010e0"}},S={padding:"10px 16px",borderRadius:10,border:"1px solid #e5e7eb",background:"#fff",color:"#111",fontWeight:900,cursor:"pointer",fontSize:14,transition:"all 0.2s"},z={color:"#dc2626",":hover":{background:"#fef2f2"}},C=e=>({padding:"10px 14px",borderRadius:10,border:"1px solid "+(e?"#4318ff":"#e5e7eb"),background:e?"#f0f4ff":"#fff",color:e?"#4318ff":"#111",fontWeight:900,cursor:"pointer",fontSize:14}),R={padding:"6px 10px",borderRadius:8,border:"1px solid #e5e7eb",background:"#fff",color:"#111",fontWeight:900,cursor:"pointer",fontSize:12,marginRight:6},W={background:"none",border:"none",fontSize:20,cursor:"pointer",fontWeight:900,opacity:.7,":hover":{opacity:1}};function A(){const e=window.BP_ADMIN?.page||"bp";return"bp-form-fields"===e?(0,n.jsx)(r,{}):(0,n.jsxs)("div",{style:{padding:18,fontWeight:900},children:["BookPoint admin page: ",e]})}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("bp-admin-app");e&&(0,d.H)(e).render((0,n.jsx)(A,{}))})})();