(()=>{"use strict";var e={338(e,a,s){var n=s(795);a.H=n.createRoot,n.hydrateRoot},795(e){e.exports=window.ReactDOM}},a={};function s(n){var i=a[n];if(void 0!==i)return i.exports;var t=a[n]={exports:{}};return e[n](t,t.exports,s),t.exports}s.n=e=>{var a=e&&e.__esModule?()=>e.default:()=>e;return s.d(a,{a}),a},s.d=(e,a)=>{for(var n in a)s.o(a,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:a[n]})},s.o=(e,a)=>Object.prototype.hasOwnProperty.call(e,a);const n=window.React;var i=s.n(n),t=s(338);const l=window.ReactJSXRuntime;function d({theme:e,onToggleTheme:a,active:s,children:n}){const i=window.BP_ADMIN?.page||"bp_dashboard",t=e=>i===e;return(0,l.jsx)("div",{className:"bp-app",children:(0,l.jsxs)("div",{className:"bp-shell",children:[(0,l.jsxs)("aside",{className:"bp-sidebar",children:[(0,l.jsxs)("div",{className:"bp-brand",children:[(0,l.jsx)("div",{className:"bp-logo",children:"BP"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"bp-title",children:"BookPoint"}),(0,l.jsx)("div",{className:"bp-sub",children:"Admin"})]})]}),(0,l.jsxs)("nav",{className:"bp-nav",children:[(0,l.jsx)("div",{className:"bp-group-title",children:"OVERVIEW"}),(0,l.jsx)("a",{className:"bp-nav-item "+(t("bp_dashboard")?"active":""),href:"admin.php?page=bp_dashboard",children:"Dashboard"}),(0,l.jsx)("a",{className:"bp-nav-item "+(t("bp_bookings")?"active":""),href:"admin.php?page=bp_bookings",children:"Bookings"}),(0,l.jsx)("a",{className:"bp-nav-item "+(t("bp_calendar")?"active":""),href:"admin.php?page=bp_calendar",children:"Calendar"}),(0,l.jsx)("a",{className:"bp-nav-item "+(t("bp_schedule")?"active":""),href:"admin.php?page=bp_schedule",children:"Schedule"}),(0,l.jsx)("a",{className:"bp-nav-item "+(t("bp_holidays")?"active":""),href:"admin.php?page=bp_holidays",children:"Holidays"}),(0,l.jsx)("div",{className:"bp-group-title",children:"RESOURCES"}),(0,l.jsxs)("div",{className:"bp-sidegroup",children:[(0,l.jsx)("a",{className:"bp-nav-item "+(["bp_services","bp_categories","bp_extras"].includes(i)?"active":""),href:"admin.php?page=bp_services",children:"Services"}),(0,l.jsxs)("div",{className:"bp-subnav",children:[(0,l.jsx)("a",{className:"bp-sub-item "+(t("bp_services")?"active":""),href:"admin.php?page=bp_services",children:"Services"}),(0,l.jsx)("a",{className:"bp-sub-item "+(t("bp_categories")?"active":""),href:"admin.php?page=bp_categories",children:"Categories"}),(0,l.jsx)("a",{className:"bp-sub-item "+(t("bp_extras")?"active":""),href:"admin.php?page=bp_extras",children:"Service Extras"})]})]}),(0,l.jsx)("a",{className:"bp-nav-item "+(t("bp_agents")?"active":""),href:"admin.php?page=bp_agents",children:"Agents"}),(0,l.jsx)("a",{className:"bp-nav-item "+(t("bp_customers")?"active":""),href:"admin.php?page=bp_customers",children:"Customers"}),(0,l.jsx)("a",{className:"bp-nav-item "+(t("bp_promo_codes")?"active":""),href:"admin.php?page=bp_promo_codes",children:"Promo Codes"}),(0,l.jsx)("a",{className:"bp-nav-item "+(t("bp-form-fields")?"active":""),href:"admin.php?page=bp-form-fields",children:"Form Fields"}),(0,l.jsx)("div",{className:"bp-group-title",children:"SYSTEM"}),(0,l.jsx)("a",{className:"bp-nav-item "+(t("bp_settings")?"active":""),href:"admin.php?page=bp_settings",children:"Settings"}),(0,l.jsx)("a",{className:"bp-nav-item "+(t("bp_audit")?"active":""),href:"admin.php?page=bp_audit",children:"Audit Log"}),(0,l.jsx)("a",{className:"bp-nav-item "+(t("bp_tools")?"active":""),href:"admin.php?page=bp_tools",children:"Tools"})]}),(0,l.jsx)("div",{className:"bp-sidebar-footer",children:(0,l.jsx)("a",{className:"bp-top-btn",href:"/wp-admin/index.php",children:"‚Üê Back to WordPress"})})]}),(0,l.jsxs)("main",{className:"bp-main",children:[(0,l.jsxs)("header",{className:"bp-topbar",children:[(0,l.jsx)("div",{className:"bp-search",children:(0,l.jsx)("input",{placeholder:"Search‚Ä¶"})}),(0,l.jsxs)("div",{className:"bp-top-actions",children:[(0,l.jsx)("button",{className:"bp-top-btn",onClick:a,children:"dark"===e?"‚òÄÔ∏è Light":"üåô Dark"}),(0,l.jsx)("div",{className:"bp-avatar",children:"W"})]})]}),(0,l.jsx)("div",{className:"bp-content",children:n})]})]})})}async function r(e,a={}){const s=(window.BP_ADMIN?.restUrl||"/wp-json/bp/v1").replace(/\/$/,"")+e,n={"Content-Type":"application/json",...a.headers||{}},i=window.BP_ADMIN?.nonce;i&&(n["X-WP-Nonce"]=i);const t="string"==typeof a.body?a.body:a.body?JSON.stringify(a.body):void 0,l=await fetch(s,{method:a.method||"GET",credentials:"same-origin",headers:n,body:t}),d=await l.json().catch(()=>({}));if(!l.ok||"error"===d?.status){const e=new Error(d?.message||"Request failed");throw e.status=l.status,e.payload=d,e}return d}function c({status:e}){const a=(e||"pending").toLowerCase();return(0,l.jsx)("span",{className:`bp-badge ${a}`,children:a})}function o(){const[e,a]=(0,n.useState)(!0),[s,i]=(0,n.useState)(""),[t,d]=(0,n.useState)({kpi:{bookings_today:0,upcoming_7d:0,pending:0,services:0,agents:0},recent:[],chart7:[]});return(0,n.useEffect)(()=>{!async function(){a(!0),i("");try{const e=await r("/admin/dashboard");d(e?.data||t)}catch(e){i(e.message||"Failed to load dashboard")}finally{a(!1)}}()},[]),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"bp-page-head",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"bp-h1",children:"Main Dashboard"}),(0,l.jsx)("div",{className:"bp-muted",children:"Overview of bookings, services, agents"})]}),(0,l.jsxs)("div",{className:"bp-head-actions",children:[(0,l.jsx)("a",{className:"bp-top-btn",href:"admin.php?page=bp-services",children:"+ Add Service"}),(0,l.jsx)("a",{className:"bp-top-btn",href:"admin.php?page=bp-agents",children:"+ Add Agent"}),(0,l.jsx)("button",{className:"bp-primary-btn",onClick:()=>alert("Next: open booking wizard"),children:"+ Create Booking"})]})]}),s?(0,l.jsx)("div",{className:"bp-error",children:s}):null,(0,l.jsxs)("div",{className:"bp-cards",children:[(0,l.jsxs)("div",{className:"bp-card",children:[(0,l.jsx)("div",{className:"bp-card-label",children:"Bookings Today"}),(0,l.jsx)("div",{className:"bp-card-value",children:e?"‚Ä¶":t.kpi.bookings_today})]}),(0,l.jsxs)("div",{className:"bp-card",children:[(0,l.jsx)("div",{className:"bp-card-label",children:"Upcoming (7 days)"}),(0,l.jsx)("div",{className:"bp-card-value",children:e?"‚Ä¶":t.kpi.upcoming_7d})]}),(0,l.jsxs)("div",{className:"bp-card",children:[(0,l.jsx)("div",{className:"bp-card-label",children:"Pending"}),(0,l.jsx)("div",{className:"bp-card-value",children:e?"‚Ä¶":t.kpi.pending})]}),(0,l.jsxs)("div",{className:"bp-card",children:[(0,l.jsx)("div",{className:"bp-card-label",children:"Services"}),(0,l.jsx)("div",{className:"bp-card-value",children:e?"‚Ä¶":t.kpi.services})]}),(0,l.jsxs)("div",{className:"bp-card",children:[(0,l.jsx)("div",{className:"bp-card-label",children:"Agents"}),(0,l.jsx)("div",{className:"bp-card-value",children:e?"‚Ä¶":t.kpi.agents})]})]}),(0,l.jsxs)("div",{className:"bp-grid",style:{marginTop:14},children:[(0,l.jsxs)("div",{className:"bp-card bp-card-big",children:[(0,l.jsx)("div",{className:"bp-card-label",style:{marginBottom:10},children:"Bookings (last 7 days)"}),(0,l.jsxs)("div",{className:"bp-mini-chart",children:[(t.chart7||[]).map(e=>(0,l.jsxs)("div",{className:"bp-mini-bar",children:[(0,l.jsx)("div",{className:"bp-mini-bar-fill",style:{height:`${Math.min(100,18*e.count+10)}%`},title:`${e.day} ‚Ä¢ ${e.count} bookings`}),(0,l.jsx)("div",{className:"bp-mini-bar-label",children:e.day.slice(5)})]},e.day)),(!t.chart7||0===t.chart7.length)&&(0,l.jsx)("div",{className:"bp-muted",children:"No chart data yet."})]})]}),(0,l.jsxs)("div",{className:"bp-card",children:[(0,l.jsx)("div",{className:"bp-card-label",style:{marginBottom:10},children:"Quick Links"}),(0,l.jsxs)("div",{className:"bp-quick",children:[(0,l.jsx)("a",{className:"bp-quick-item",href:"admin.php?page=bp-bookings",children:"Manage bookings"}),(0,l.jsx)("a",{className:"bp-quick-item",href:"admin.php?page=bp-calendar",children:"Open calendar"}),(0,l.jsx)("a",{className:"bp-quick-item",href:"admin.php?page=bp-form-fields",children:"Edit form fields"}),(0,l.jsx)("a",{className:"bp-quick-item",href:"admin.php?page=bp-settings",children:"Settings"})]})]})]}),(0,l.jsxs)("div",{className:"bp-card",style:{marginTop:14},children:[(0,l.jsx)("div",{className:"bp-card-label",style:{marginBottom:10},children:"Recent Bookings"}),(0,l.jsxs)("div",{className:"bp-table",children:[(0,l.jsxs)("div",{className:"bp-tr bp-th",children:[(0,l.jsx)("div",{children:"ID"}),(0,l.jsx)("div",{children:"When"}),(0,l.jsx)("div",{children:"Service"}),(0,l.jsx)("div",{children:"Agent"}),(0,l.jsx)("div",{children:"Customer"}),(0,l.jsx)("div",{children:"Status"})]}),(t.recent||[]).map(e=>(0,l.jsxs)("a",{className:"bp-tr",href:`admin.php?page=bp-bookings&view=${e.id}`,children:[(0,l.jsxs)("div",{children:["#",e.id]}),(0,l.jsx)("div",{className:"bp-muted",children:e.start}),(0,l.jsx)("div",{children:e.service_name||"-"}),(0,l.jsx)("div",{children:e.agent_name||"-"}),(0,l.jsx)("div",{children:e.customer_name||"-"}),(0,l.jsx)("div",{children:(0,l.jsx)(c,{status:e.status})})]},e.id)),(!t.recent||0===t.recent.length)&&(0,l.jsx)("div",{className:"bp-muted",style:{padding:10},children:"No bookings yet."})]})]})]})}function m({status:e}){const a=(e||"pending").toLowerCase();return(0,l.jsx)("span",{className:`bp-badge ${a}`,children:a})}function p(){const[e,a]=(0,n.useState)(""),[s,i]=(0,n.useState)("all"),[t,d]=(0,n.useState)("desc"),[c,o]=(0,n.useState)(""),[p,h]=(0,n.useState)(""),[j,g]=(0,n.useState)(1),[N]=(0,n.useState)(20),[y,f]=(0,n.useState)(!1),[_,S]=(0,n.useState)(""),[k,w]=(0,n.useState)([]),[C,B]=(0,n.useState)(0),[D,P]=(0,n.useState)({total:0,pending:0,confirmed:0,cancelled:0}),[A,R]=(0,n.useState)(null),[L,M]=(0,n.useState)(!1),[T,I]=(0,n.useState)("");async function E(){f(!0),S("");try{const a=`/admin/bookings?q=${encodeURIComponent(e)}&status=${encodeURIComponent(s)}&sort=${encodeURIComponent(t)}&date_from=${encodeURIComponent(c)}&date_to=${encodeURIComponent(p)}&page=${j}&per=${N}`,n=await r(a),i=[...n?.data?.items||[]].sort((e,a)=>(Number(a.id)||0)-(Number(e.id)||0));w(i),B(n?.data?.total||0);const l={total:n?.data?.total||0,pending:0,confirmed:0,cancelled:0};for(const e of i){const a=(e.status||"pending").toLowerCase();"pending"===a&&l.pending++,"confirmed"===a&&l.confirmed++,"cancelled"===a&&l.cancelled++}P(l)}catch(e){S(e.message||"Failed to load bookings")}finally{f(!1)}}(0,n.useEffect)(()=>{E()},[s,j]);const $=Math.max(1,Math.ceil(C/N));async function F(e,a){await async function(e,a={}){return r(e,{method:"POST",body:a})}(`/admin/bookings/${e}/status`,{status:a}),await E(),A&&A.booking&&A.booking.id===e&&R({...A,booking:{...A.booking,status:a}})}return(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"bp-page-head",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"bp-h1",children:"Bookings"}),(0,l.jsx)("div",{className:"bp-muted",children:"Search, filter, and manage appointments"})]})}),_?(0,l.jsx)("div",{className:"bp-error",children:_}):null,(0,l.jsxs)("div",{className:"bp-cards",style:{marginBottom:14},children:[(0,l.jsxs)("div",{className:"bp-card",children:[(0,l.jsx)("div",{className:"bp-card-label",children:"Total (filtered)"}),(0,l.jsx)("div",{className:"bp-card-value",children:y?"‚Ä¶":D.total})]}),(0,l.jsxs)("div",{className:"bp-card",children:[(0,l.jsx)("div",{className:"bp-card-label",children:"Pending"}),(0,l.jsx)("div",{className:"bp-card-value",children:y?"‚Ä¶":D.pending})]}),(0,l.jsxs)("div",{className:"bp-card",children:[(0,l.jsx)("div",{className:"bp-card-label",children:"Confirmed"}),(0,l.jsx)("div",{className:"bp-card-value",children:y?"‚Ä¶":D.confirmed})]}),(0,l.jsxs)("div",{className:"bp-card",children:[(0,l.jsx)("div",{className:"bp-card-label",children:"Cancelled"}),(0,l.jsx)("div",{className:"bp-card-value",children:y?"‚Ä¶":D.cancelled})]})]}),(0,l.jsx)("div",{className:"bp-card",style:{marginBottom:14},children:(0,l.jsxs)("form",{className:"bp-filters",onSubmit:function(e){e.preventDefault(),g(1),E()},children:[(0,l.jsxs)("div",{className:"bp-filter-group",children:[(0,l.jsx)("label",{className:"bp-filter-label",children:"Search"}),(0,l.jsx)("input",{className:"bp-input",placeholder:"Search customer, email, service, agent‚Ä¶",value:e,onChange:e=>a(e.target.value)})]}),(0,l.jsxs)("div",{className:"bp-filter-group",children:[(0,l.jsx)("label",{className:"bp-filter-label",children:"Status"}),(0,l.jsxs)("select",{className:"bp-input",value:s,onChange:e=>{i(e.target.value),g(1)},children:[(0,l.jsx)("option",{value:"all",children:"All statuses"}),(0,l.jsx)("option",{value:"pending",children:"Pending"}),(0,l.jsx)("option",{value:"confirmed",children:"Confirmed"}),(0,l.jsx)("option",{value:"cancelled",children:"Cancelled"})]})]}),(0,l.jsxs)("div",{className:"bp-filter-group",children:[(0,l.jsx)("label",{className:"bp-filter-label",children:"From date"}),(0,l.jsx)("input",{className:"bp-input",type:"date",value:c,onChange:e=>o(e.target.value)})]}),(0,l.jsxs)("div",{className:"bp-filter-group",children:[(0,l.jsx)("label",{className:"bp-filter-label",children:"To date"}),(0,l.jsx)("input",{className:"bp-input",type:"date",value:p,onChange:e=>h(e.target.value)})]}),(0,l.jsxs)("div",{className:"bp-filter-group",children:[(0,l.jsx)("label",{className:"bp-filter-label",children:"Sort by"}),(0,l.jsxs)("select",{className:"bp-input",value:t,onChange:e=>{d(e.target.value),g(1)},children:[(0,l.jsx)("option",{value:"desc",children:"Newest created first"}),(0,l.jsx)("option",{value:"asc",children:"Oldest created first"})]})]}),(0,l.jsxs)("div",{className:"bp-filter-group",children:[(0,l.jsx)("label",{className:"bp-filter-label",children:"¬†"}),(0,l.jsx)("button",{className:"bp-primary-btn",type:"submit",children:"Search"})]})]})}),(0,l.jsxs)("div",{className:"bp-card",children:[(0,l.jsxs)("div",{className:"bp-table",children:[(0,l.jsxs)("div",{className:"bp-tr bp-th",children:[(0,l.jsx)("div",{children:"ID"}),(0,l.jsx)("div",{children:"When"}),(0,l.jsx)("div",{children:"Service"}),(0,l.jsx)("div",{children:"Agent"}),(0,l.jsx)("div",{children:"Customer"}),(0,l.jsx)("div",{children:"Status"})]}),y?(0,l.jsx)("div",{className:"bp-muted",style:{padding:10},children:"Loading‚Ä¶"}):null,!y&&k.map(e=>(0,l.jsxs)("button",{className:"bp-tr bp-tr-btn",onClick:()=>async function(e){M(!0),I(""),R({id:e,_loading:!0});try{const a=await r(`/admin/bookings/${e}`),s=a?.data?.booking?a.data:a?.booking?a:a?.data?a.data:a;R(s),s&&(s.booking||s.id||s.status)||I("Booking details response is empty or wrong format.")}catch(e){I(e?.message||"Failed to load booking details")}finally{M(!1)}}(e.id),children:[(0,l.jsxs)("div",{children:["#",e.id]}),(0,l.jsx)("div",{className:"bp-muted",children:e.start_datetime}),(0,l.jsx)("div",{children:e.service_name||"-"}),(0,l.jsx)("div",{children:e.agent_name||"-"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{style:{fontWeight:1100},children:e.customer_name||"-"}),(0,l.jsx)("div",{className:"bp-muted",style:{fontSize:12},children:e.customer_email||"-"})]}),(0,l.jsxs)("div",{className:"bp-row-actions",children:[(0,l.jsx)(m,{status:e.status}),(0,l.jsx)("button",{className:"bp-chip",onClick:a=>{a.stopPropagation(),F(e.id,"confirmed")},children:"Confirm"}),(0,l.jsx)("button",{className:"bp-chip",onClick:a=>{a.stopPropagation(),F(e.id,"cancelled")},children:"Cancel"})]})]},e.id)),y||0!==k.length?null:(0,l.jsx)("div",{className:"bp-muted",style:{padding:10},children:"No bookings found."})]}),(0,l.jsxs)("div",{className:"bp-pager",children:[(0,l.jsx)("button",{className:"bp-top-btn",disabled:j<=1,onClick:()=>g(e=>Math.max(1,e-1)),children:"Prev"}),(0,l.jsxs)("div",{className:"bp-muted",style:{fontWeight:1e3},children:["Page ",j," / ",$]}),(0,l.jsx)("button",{className:"bp-top-btn",disabled:j>=$,onClick:()=>g(e=>Math.min($,e+1)),children:"Next"})]})]}),A?(0,l.jsx)("div",{className:"bp-drawer-wrap",onMouseDown:e=>{e.target.classList.contains("bp-drawer-wrap")&&R(null)},children:(0,l.jsxs)("div",{className:"bp-drawer",children:[(0,l.jsxs)("div",{className:"bp-drawer-head",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"bp-drawer-title",children:["Booking #",A?.booking?.id||A?.id]}),(0,l.jsxs)("div",{className:"bp-muted",children:[A?.booking?.start_datetime||""," ‚Üí ",A?.booking?.end_datetime||""]})]}),(0,l.jsx)("button",{className:"bp-top-btn",onClick:()=>R(null),children:"Close"})]}),T?(0,l.jsx)("div",{className:"bp-error",children:T}):null,L?(0,l.jsx)("div",{className:"bp-muted",style:{padding:12},children:"Loading booking details‚Ä¶"}):null,!L&&(A?.booking||A?.id||A?.status)?(0,l.jsx)("div",{className:"bp-drawer-body",children:(()=>{const e=A.booking||A,a=A.customer||{},s=A.service||{},n=A.agent||{};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"bp-drawer-grid",children:[(0,l.jsxs)("div",{className:"bp-section",children:[(0,l.jsx)("div",{className:"bp-section-title",children:"Status"}),(0,l.jsxs)("div",{className:"bp-row2",children:[(0,l.jsx)("div",{children:(0,l.jsx)(m,{status:e.status})}),(0,l.jsxs)("div",{className:"bp-row-actions",children:[(0,l.jsx)("button",{className:"bp-chip",onClick:()=>F(e.id,"confirmed"),children:"Confirm"}),(0,l.jsx)("button",{className:"bp-chip",onClick:()=>F(e.id,"cancelled"),children:"Cancel"}),(0,l.jsx)("button",{className:"bp-chip",onClick:()=>F(e.id,"pending"),children:"Set Pending"})]})]})]}),(0,l.jsxs)("div",{className:"bp-section",children:[(0,l.jsx)("div",{className:"bp-section-title",children:"Customer"}),(0,l.jsxs)("div",{className:"bp-kv",children:[(0,l.jsx)("div",{className:"bp-k",children:"Name"}),(0,l.jsx)("div",{className:"bp-v",children:a.name||"-"}),(0,l.jsx)("div",{className:"bp-k",children:"Email"}),(0,l.jsx)("div",{className:"bp-v",children:a.email||"-"}),(0,l.jsx)("div",{className:"bp-k",children:"Phone"}),(0,l.jsx)("div",{className:"bp-v",children:a.phone||"-"})]})]}),(0,l.jsxs)("div",{className:"bp-section",children:[(0,l.jsx)("div",{className:"bp-section-title",children:"Service"}),(0,l.jsxs)("div",{className:"bp-kv",children:[(0,l.jsx)("div",{className:"bp-k",children:"Service"}),(0,l.jsx)("div",{className:"bp-v",children:s.name||"-"}),(0,l.jsx)("div",{className:"bp-k",children:"Agent"}),(0,l.jsx)("div",{className:"bp-v",children:n.name||"-"}),(0,l.jsx)("div",{className:"bp-k",children:"Extras"}),(0,l.jsx)("div",{className:"bp-v",children:x(A)||"-"})]})]}),(0,l.jsxs)("div",{className:"bp-section",children:[(0,l.jsx)("div",{className:"bp-section-title",children:"Pricing"}),(0,l.jsx)(b,{pricing:A.pricing||{}})]})]}),(0,l.jsxs)("div",{className:"bp-section",style:{marginTop:12},children:[(0,l.jsx)("div",{className:"bp-section-title",children:"Order Items"}),(0,l.jsx)(u,{items:A.order_items||[]})]}),(0,l.jsxs)("div",{className:"bp-section",style:{marginTop:12},children:[(0,l.jsx)("div",{className:"bp-section-title",children:"Form Responses"}),(0,l.jsx)(v,{fields:A.form_fields||[],answers:A.form_answers||{}})]}),(0,l.jsxs)("div",{className:"bp-section",style:{marginTop:12},children:[(0,l.jsx)("div",{className:"bp-section-title",children:"Raw Booking Data (Debug)"}),(0,l.jsx)("pre",{className:"bp-pre",children:JSON.stringify(A.raw||{},null,2)})]})]})})()}):null]})}):null]})}function h(e,a){if(null==e||""===e)return"-";const s=Number(e);return Number.isNaN(s)?String(e):a?`${s.toFixed(2)} ${a}`:s.toFixed(2)}function b({pricing:e}){const a=e.currency||"";return(0,l.jsxs)("div",{className:"bp-kv",children:[(0,l.jsx)("div",{className:"bp-k",children:"Subtotal"}),(0,l.jsx)("div",{className:"bp-v",children:h(e.subtotal,a)}),(0,l.jsx)("div",{className:"bp-k",children:"Extras"}),(0,l.jsx)("div",{className:"bp-v",children:h(e.extras_total,a)}),(0,l.jsx)("div",{className:"bp-k",children:"Discount"}),(0,l.jsx)("div",{className:"bp-v",children:h(e.discount_total,a)}),(0,l.jsx)("div",{className:"bp-k",children:"Tax"}),(0,l.jsx)("div",{className:"bp-v",children:h(e.tax_total,a)}),(0,l.jsx)("div",{className:"bp-k",children:"Total"}),(0,l.jsx)("div",{className:"bp-v",style:{fontWeight:1200},children:h(e.total,a)}),(0,l.jsx)("div",{className:"bp-k",children:"Promo"}),(0,l.jsx)("div",{className:"bp-v",children:e.promo_code||"-"})]})}function u({items:e}){return e&&0!==e.length?(0,l.jsx)("div",{className:"bp-items",children:e.map((e,a)=>{var s,n;return(0,l.jsxs)("div",{className:"bp-item",children:[(0,l.jsx)("div",{style:{fontWeight:1100},children:e.name||e.title||e.service_name||`Item ${a+1}`}),(0,l.jsxs)("div",{className:"bp-muted",style:{fontSize:12},children:["Qty: ",null!==(s=null!==(n=e.qty)&&void 0!==n?n:e.quantity)&&void 0!==s?s:1,e.price?` ‚Ä¢ Price: ${e.price}`:""]})]},a)})}):(0,l.jsx)("div",{className:"bp-muted",children:"No order items stored."})}function x(e){const a=e?.order_items||[];if(!a.length)return"";const s=a.map(e=>{const a=e.name||e.title||e.service_name,s=void 0!==e.price&&null!==e.price?` (${e.price})`:"";return a?`${a}${s}`:""}).filter(Boolean);return s.length?s.join(", "):""}function v({fields:e,answers:a}){const s=e||[],n=s.length>0;return n||0!==Object.keys(a||{}).length?n?(0,l.jsx)("div",{className:"bp-kv",children:s.map(e=>{var s;const n=e.key,t=e.scope?`${e.scope}.${e.key}`:null,d=null!==(s=a?.[n])&&void 0!==s?s:t?a?.[t]:void 0,r=Array.isArray(d)?d.join(", "):!0===d?"Yes":!1===d?"No":null!=d?d:"-";return(0,l.jsxs)(i().Fragment,{children:[(0,l.jsx)("div",{className:"bp-k",children:e.label||n}),(0,l.jsx)("div",{className:"bp-v",children:String(r)})]},`${e.scope||"field"}:${n}`)})}):(0,l.jsx)("div",{className:"bp-kv",children:Object.keys(a||{}).map(e=>{const s=a[e],n=Array.isArray(s)?s.join(", "):!0===s?"Yes":!1===s?"No":null!=s?s:"-";return(0,l.jsxs)(i().Fragment,{children:[(0,l.jsx)("div",{className:"bp-k",children:e}),(0,l.jsx)("div",{className:"bp-v",children:String(n)})]},e)})}):(0,l.jsx)("div",{className:"bp-muted",children:"No form answers stored."})}const j=["text","email","tel","textarea","number","date","select","checkbox"],g=[{value:"details",label:"Details"},{value:"payment",label:"Payment"},{value:"summary",label:"Summary"}];function N(){const[e,a]=(0,n.useState)("customer"),[s,i]=(0,n.useState)([]),[t,d]=(0,n.useState)(""),[c,o]=(0,n.useState)(""),[m,p]=(0,n.useState)(!1),[h,b]=(0,n.useState)(!1),[u,x]=(0,n.useState)(null),[v,N]=(0,n.useState)(null),[f,_]=(0,n.useState)(!1),[S,k]=(0,n.useState)({field_key:"",label:"",type:"text",step_key:"details",placeholder:"",is_required:!1,is_enabled:!0,show_in_wizard:!0});async function w(){p(!0),d("");try{const a=await r(`/admin/form-fields?scope=${e}`);i(a?.data||[])}catch(e){i([]),d(e.message||"Failed to load")}finally{p(!1)}}return(0,n.useEffect)(()=>{w()},[e]),(0,l.jsxs)("div",{style:{padding:18},children:[(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:12,flexWrap:"wrap",marginBottom:20},children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{style:{margin:"0 0 6px 0",fontSize:24,fontWeight:1e3},children:"Form Fields"}),(0,l.jsx)("p",{style:{margin:0,opacity:.7,fontSize:13},children:"Manage custom form fields for booking wizard"})]}),(0,l.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[(0,l.jsx)("button",{onClick:()=>a("form"),style:F("form"===e),children:"üß© Form"}),(0,l.jsx)("button",{onClick:()=>a("customer"),style:F("customer"===e),children:"üë§ Customer"}),(0,l.jsx)("button",{onClick:()=>a("booking"),style:F("booking"===e),children:"üìÖ Booking"}),(0,l.jsx)("button",{onClick:async function(){if(confirm("Reseed all default fields (first_name, last_name, email, phone, notes)?")){d(""),o("");try{await r("/admin/form-fields/reseed",{method:"POST",body:{}}),o("Defaults reseeded!"),await w(),setTimeout(()=>o(""),3e3)}catch(e){d(e.message||"Reseed failed")}}},style:{...E,fontSize:12,padding:"8px 12px"},children:"üîÑ Reseed Defaults"}),(0,l.jsx)("button",{onClick:()=>{x(null),k({field_key:"",label:"",type:"text",step_key:"details",placeholder:"",is_required:!1,is_enabled:!0,show_in_wizard:!0}),b(!0)},style:I,children:"+ Add Field"})]})]}),t&&(0,l.jsx)("div",{style:M,children:t}),c&&(0,l.jsx)("div",{style:T,children:c}),(0,l.jsxs)("div",{style:C,children:[m?(0,l.jsx)("div",{style:{padding:20,textAlign:"center",fontWeight:900},children:"‚è≥ Loading‚Ä¶"}):null,!m&&0===s.length&&(0,l.jsx)("div",{style:{padding:20,textAlign:"center",opacity:.7,fontWeight:900},children:"üì≠ No fields yet. Add one to get started!"}),!m&&s.length>0&&(0,l.jsx)("div",{style:{overflowX:"auto"},children:(0,l.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",minWidth:900},children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{style:{background:"#f9fafb",borderBottom:"2px solid #e5e7eb"},children:[(0,l.jsx)("th",{style:B,children:"Key"}),(0,l.jsx)("th",{style:B,children:"Label"}),(0,l.jsx)("th",{style:B,children:"Type"}),(0,l.jsx)("th",{style:{...B,textAlign:"center"},children:"Step"}),(0,l.jsx)("th",{style:{...B,textAlign:"center"},children:"Required"}),(0,l.jsx)("th",{style:{...B,textAlign:"center"},children:"Wizard"}),(0,l.jsx)("th",{style:{...B,textAlign:"center"},children:"Enabled"}),(0,l.jsx)("th",{style:{...B,textAlign:"right"},children:"Actions"})]})}),(0,l.jsx)("tbody",{children:s.map(e=>(0,l.jsxs)("tr",{style:{borderBottom:"1px solid #f3f4f6",":hover":{background:"#fafbfc"}},children:[(0,l.jsx)("td",{style:D,children:(0,l.jsx)("code",{style:{background:"#f1f5f9",padding:"4px 8px",borderRadius:6,fontSize:12,fontWeight:900},children:e.field_key||e.name_key||""})}),(0,l.jsx)("td",{style:D,children:e.label}),(0,l.jsx)("td",{style:D,children:(0,l.jsx)("span",{style:{background:"#eef2ff",color:"#3730a3",padding:"4px 8px",borderRadius:6,fontSize:12,fontWeight:900},children:e.type})}),(0,l.jsx)("td",{style:{...D,textAlign:"center",fontSize:12},children:e.step_key}),(0,l.jsx)("td",{style:{...D,textAlign:"center"},children:Number(e.is_required)?"‚úÖ":"‚ùå"}),(0,l.jsx)("td",{style:{...D,textAlign:"center"},children:Number(e.show_in_wizard)?"‚úÖ":"‚ùå"}),(0,l.jsx)("td",{style:{...D,textAlign:"center"},children:Number(e.is_enabled)?"‚úÖ":"‚ùå"}),(0,l.jsxs)("td",{style:{...D,textAlign:"right",whiteSpace:"nowrap"},children:[(0,l.jsx)("button",{onClick:()=>{return k({field_key:(a=e).field_key||a.name_key||"",label:a.label,type:a.type,step_key:a.step_key,placeholder:a.placeholder,is_required:Number(a.is_required),is_enabled:Number(a.is_enabled),show_in_wizard:Number(a.show_in_wizard)}),x(a.id),void b(!0);var a},style:W,disabled:v===e.id,children:"‚úèÔ∏è Edit"}),(0,l.jsxs)("button",{onClick:()=>async function(e){if(confirm("Delete this field?")){N(e),d("");try{await r(`/admin/form-fields/${e}`,{method:"DELETE"}),await w(),o("Field deleted!"),setTimeout(()=>o(""),3e3)}catch(e){d(e.message||"Delete failed")}finally{N(null)}}}(e.id),style:{...W,...$},disabled:v===e.id,children:[v===e.id?"‚è≥":"üóëÔ∏è"," Delete"]})]})]},e.id))})]})})]}),h&&(0,l.jsx)(y,{title:u?"Edit Field":"Create Field",onClose:()=>{b(!1),x(null)},onSave:async function(){_(!0),d(""),o("");try{const a={...S,scope:e};u?(await r(`/admin/form-fields/${u}`,{method:"PATCH",body:a}),o("Field updated!")):(await r("/admin/form-fields",{method:"POST",body:a}),o("Field created!")),b(!1),x(null),k({field_key:"",label:"",type:"text",step_key:"details",placeholder:"",is_required:!1,is_enabled:!0,show_in_wizard:!0}),await w(),setTimeout(()=>o(""),3e3)}catch(e){d(e.message||"Save failed")}finally{_(!1)}},submitting:f,children:(0,l.jsxs)("div",{style:{display:"grid",gap:16},children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{style:R,children:"Field Key *"}),(0,l.jsx)("input",{type:"text",value:S.field_key,onChange:e=>k({...S,field_key:e.target.value}),placeholder:"e.g., company_name",style:P,disabled:null!==u&&!!S.field_key})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{style:R,children:"Label *"}),(0,l.jsx)("input",{type:"text",value:S.label,onChange:e=>k({...S,label:e.target.value}),placeholder:"Display name",style:P})]}),(0,l.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{style:R,children:"Type *"}),(0,l.jsx)("select",{value:S.type,onChange:e=>k({...S,type:e.target.value}),style:A,children:j.map(e=>(0,l.jsx)("option",{children:e},e))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{style:R,children:"Step"}),(0,l.jsx)("select",{value:S.step_key,onChange:e=>k({...S,step_key:e.target.value}),style:A,children:g.map(e=>(0,l.jsx)("option",{value:e.value,children:e.label},e.value))})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{style:R,children:"Placeholder"}),(0,l.jsx)("input",{type:"text",value:S.placeholder,onChange:e=>k({...S,placeholder:e.target.value}),placeholder:"Optional placeholder text",style:P})]}),(0,l.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[(0,l.jsxs)("label",{style:L,children:[(0,l.jsx)("input",{type:"checkbox",checked:S.is_required,onChange:e=>k({...S,is_required:e.target.checked})})," Required"]}),(0,l.jsxs)("label",{style:L,children:[(0,l.jsx)("input",{type:"checkbox",checked:S.is_enabled,onChange:e=>k({...S,is_enabled:e.target.checked})})," Enabled"]})]}),(0,l.jsxs)("label",{style:L,children:[(0,l.jsx)("input",{type:"checkbox",checked:S.show_in_wizard,onChange:e=>k({...S,show_in_wizard:e.target.checked})})," Show in Wizard"]})]})})]})}function y({title:e,onClose:a,onSave:s,submitting:n,children:i}){return(0,l.jsx)("div",{style:f,onClick:a,children:(0,l.jsxs)("div",{style:_,onClick:e=>e.stopPropagation(),children:[(0,l.jsxs)("div",{style:S,children:[(0,l.jsx)("h2",{style:{margin:0,fontSize:18,fontWeight:1e3},children:e}),(0,l.jsx)("button",{onClick:a,style:z,disabled:n,children:"‚úï"})]}),(0,l.jsx)("div",{style:k,children:i}),(0,l.jsxs)("div",{style:w,children:[(0,l.jsx)("button",{onClick:a,style:E,disabled:n,children:"Cancel"}),(0,l.jsx)("button",{onClick:s,style:I,disabled:n,children:n?"‚è≥ Saving‚Ä¶":"üíæ Save"})]})]})})}const f={position:"fixed",inset:0,background:"rgba(0,0,0,.3)",zIndex:999998,display:"flex",alignItems:"center",justifyContent:"center"},_={width:"min(600px, calc(100% - 24px))",background:"#fff",borderRadius:18,border:"1px solid #e5e7eb",boxShadow:"0 20px 60px rgba(0,0,0,.25)"},S={padding:20,borderBottom:"1px solid #f3f4f6",display:"flex",justifyContent:"space-between",alignItems:"center"},k={padding:20,maxHeight:"60vh",overflowY:"auto"},w={padding:20,borderTop:"1px solid #f3f4f6",display:"flex",justifyContent:"flex-end",gap:10},C={background:"#fff",border:"1px solid #e5e7eb",borderRadius:18,padding:0,overflow:"hidden"},B={textAlign:"left",padding:"14px 16px",fontWeight:1e3,fontSize:13,background:"#f9fafb",borderBottom:"2px solid #e5e7eb"},D={padding:"14px 16px",verticalAlign:"middle",fontSize:14},P={width:"100%",padding:"10px 12px",borderRadius:10,border:"1px solid #e5e7eb",fontFamily:"inherit",fontWeight:900,fontSize:14,boxSizing:"border-box"},A={width:"100%",padding:"10px 12px",borderRadius:10,border:"1px solid #e5e7eb",fontFamily:"inherit",fontWeight:900,fontSize:14,background:"#fff",boxSizing:"border-box"},R={fontWeight:950,display:"block",marginBottom:8,fontSize:14},L={display:"flex",alignItems:"center",gap:8,fontWeight:900,fontSize:14},M={background:"#fef2f2",border:"1px solid #fecaca",color:"#991b1b",padding:14,borderRadius:12,fontWeight:900,marginBottom:16,fontSize:14},T={background:"#f0fdf4",border:"1px solid #86efac",color:"#166534",padding:14,borderRadius:12,fontWeight:900,marginBottom:16,fontSize:14},I={padding:"10px 16px",borderRadius:10,border:"none",background:"#4318ff",color:"#fff",fontWeight:900,cursor:"pointer",fontSize:14,transition:"all 0.2s",":hover":{background:"#3010e0"}},E={padding:"10px 16px",borderRadius:10,border:"1px solid #e5e7eb",background:"#fff",color:"#111",fontWeight:900,cursor:"pointer",fontSize:14,transition:"all 0.2s"},$={color:"#dc2626",":hover":{background:"#fef2f2"}},F=e=>({padding:"10px 14px",borderRadius:10,border:"1px solid "+(e?"#4318ff":"#e5e7eb"),background:e?"#f0f4ff":"#fff",color:e?"#4318ff":"#111",fontWeight:900,cursor:"pointer",fontSize:14}),W={padding:"6px 10px",borderRadius:8,border:"1px solid #e5e7eb",background:"#fff",color:"#111",fontWeight:900,cursor:"pointer",fontSize:12,marginRight:6},z={background:"none",border:"none",fontSize:20,cursor:"pointer",fontWeight:900,opacity:.7,":hover":{opacity:1}};function U(){const[e,a]=(0,n.useState)([]),[s,i]=(0,n.useState)(!0),[t,d]=(0,n.useState)(""),[r,c]=(0,n.useState)("all"),[o,m]=(0,n.useState)("name");(0,n.useEffect)(()=>{!async function(){try{i(!0);const e=await fetch(`${window.BP_ADMIN?.restUrl}/admin/services`,{headers:{"X-WP-Nonce":window.BP_ADMIN?.nonce}}),s=await e.json();a(s.data||[])}catch(e){console.error(e)}finally{i(!1)}}()},[]);const p=e.filter(e=>(e.name||"").toLowerCase().includes(t.toLowerCase())).filter(e=>{if("all"===r)return!0;const a=void 0!==e.is_active?!!Number(e.is_active):void 0===e.is_enabled||!!Number(e.is_enabled);return"active"===r?a:!a}).sort((e,a)=>{var s,n,i,t,l,d;if("price"===o)return(null!==(s=e.price_cents)&&void 0!==s?s:e.price?Math.round(100*parseFloat(e.price)):0)-(null!==(n=a.price_cents)&&void 0!==n?n:a.price?Math.round(100*parseFloat(a.price)):0);if("duration"===o)return(null!==(i=null!==(t=e.duration_minutes)&&void 0!==t?t:e.duration)&&void 0!==i?i:0)-(null!==(l=null!==(d=a.duration_minutes)&&void 0!==d?d:a.duration)&&void 0!==l?l:0);const r=(e.name||"").toLowerCase(),c=(a.name||"").toLowerCase();return r.localeCompare(c)}),h=e.reduce((e,a)=>{const s=void 0!==a.is_active?!!Number(a.is_active):void 0===a.is_enabled||!!Number(a.is_enabled);return e.total+=1,s?e.active+=1:e.inactive+=1,e},{total:0,active:0,inactive:0});return(0,l.jsxs)("div",{className:"bp-container",children:[(0,l.jsxs)("div",{className:"bp-header",children:[(0,l.jsx)("h1",{children:"Services"}),(0,l.jsx)("a",{className:"bp-btn bp-btn-primary",href:"admin.php?page=bp_services_edit",children:"+ New Service"})]}),(0,l.jsxs)("div",{className:"bp-cards",style:{marginBottom:14},children:[(0,l.jsxs)("div",{className:"bp-card",children:[(0,l.jsx)("div",{className:"bp-card-label",children:"Total"}),(0,l.jsx)("div",{className:"bp-card-value",children:s?"‚Ä¶":h.total})]}),(0,l.jsxs)("div",{className:"bp-card",children:[(0,l.jsx)("div",{className:"bp-card-label",children:"Active"}),(0,l.jsx)("div",{className:"bp-card-value",children:s?"‚Ä¶":h.active})]}),(0,l.jsxs)("div",{className:"bp-card",children:[(0,l.jsx)("div",{className:"bp-card-label",children:"Inactive"}),(0,l.jsx)("div",{className:"bp-card-value",children:s?"‚Ä¶":h.inactive})]})]}),(0,l.jsx)("div",{className:"bp-card",style:{marginBottom:16},children:(0,l.jsxs)("div",{className:"bp-filters",children:[(0,l.jsx)("input",{type:"text",placeholder:"Search services...",value:t,onChange:e=>d(e.target.value),className:"bp-input",style:{flex:1,minWidth:240}}),(0,l.jsxs)("select",{className:"bp-input",value:r,onChange:e=>c(e.target.value),children:[(0,l.jsx)("option",{value:"all",children:"All statuses"}),(0,l.jsx)("option",{value:"active",children:"Active"}),(0,l.jsx)("option",{value:"inactive",children:"Inactive"})]}),(0,l.jsxs)("select",{className:"bp-input",value:o,onChange:e=>m(e.target.value),children:[(0,l.jsx)("option",{value:"name",children:"Sort: Name"}),(0,l.jsx)("option",{value:"price",children:"Sort: Price"}),(0,l.jsx)("option",{value:"duration",children:"Sort: Duration"})]})]})}),s?(0,l.jsx)("div",{className:"bp-card",children:"Loading..."}):0===p.length?(0,l.jsx)("div",{className:"bp-card",children:"No services found."}):(0,l.jsx)("div",{className:"bp-service-grid",children:p.map(e=>{var a,s,n,i;const t=e.name||e.title||`#${e.id}`,d=null!==(a=null!==(s=null!==(n=e.duration_minutes)&&void 0!==n?n:e.duration)&&void 0!==s?s:e.duration_min)&&void 0!==a?a:e.duration_minutes,r=null!==(i=e.price_cents)&&void 0!==i?i:void 0!==e.price&&null!==e.price?Math.round(100*parseFloat(e.price)):null,c=null!==r?`$${(r/100).toFixed(2)}`:"-",o=void 0!==e.is_active?!!Number(e.is_active):void 0===e.is_enabled||!!Number(e.is_enabled),m=e.image_url||e.image||"",p=(t||"?").trim().slice(0,1).toUpperCase();return(0,l.jsxs)("div",{className:"bp-service-card",children:[(0,l.jsx)("div",{className:"bp-service-media",children:m?(0,l.jsx)("img",{src:m,alt:t}):(0,l.jsx)("div",{className:"bp-service-placeholder",children:p})}),(0,l.jsxs)("div",{className:"bp-service-body",children:[(0,l.jsxs)("div",{className:"bp-service-head",children:[(0,l.jsx)("div",{className:"bp-service-name",children:t}),(0,l.jsx)("span",{className:"bp-status-pill "+(o?"active":"inactive"),children:o?"Active":"Inactive"})]}),(0,l.jsxs)("div",{className:"bp-service-meta",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"bp-muted",style:{fontSize:12},children:"Price"}),(0,l.jsx)("div",{className:"bp-service-value",children:c})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"bp-muted",style:{fontSize:12},children:"Duration"}),(0,l.jsx)("div",{className:"bp-service-value",children:d?`${d} min`:"-"})]})]}),(0,l.jsxs)("div",{className:"bp-service-actions",children:[(0,l.jsx)("a",{className:"bp-btn-sm",href:`admin.php?page=bp_services_edit&id=${e.id}`,children:"Edit"}),(0,l.jsx)("button",{className:"bp-btn-sm bp-btn-danger",children:"Delete"})]})]})]},e.id)})})]})}function O(){const e=new URLSearchParams(window.location.search).get("id"),a=(0,n.useMemo)(()=>{const a="admin.php?page=bp_services&action=edit&legacy=1&noadmin=1";return e?`${a}&id=${encodeURIComponent(e)}`:a},[e]);return(0,l.jsxs)("div",{className:"bp-container",children:[(0,l.jsxs)("div",{className:"bp-header",children:[(0,l.jsx)("h1",{children:e?"Edit Service":"Add Service"}),(0,l.jsx)("a",{className:"bp-btn",href:"admin.php?page=bp_services",children:"Back to Services"})]}),(0,l.jsx)("div",{className:"bp-card bp-iframe-card",children:(0,l.jsx)("iframe",{title:"Service Edit",src:a,className:"bp-legacy-iframe"})})]})}function K(){const[e,a]=(0,n.useState)([]),[s,i]=(0,n.useState)(!0),[t,d]=(0,n.useState)("");(0,n.useEffect)(()=>{!async function(){try{i(!0);const e=await fetch(`${window.BP_ADMIN?.restUrl}/admin/categories`,{headers:{"X-WP-Nonce":window.BP_ADMIN?.nonce}}),s=await e.json();a(s.data||[])}catch(e){console.error(e)}finally{i(!1)}}()},[]);const r=e.filter(e=>(e.name||"").toLowerCase().includes(t.toLowerCase()));return(0,l.jsxs)("div",{className:"bp-container",children:[(0,l.jsxs)("div",{className:"bp-header",children:[(0,l.jsx)("h1",{children:"Categories"}),(0,l.jsx)("button",{className:"bp-btn bp-btn-primary",children:"+ New Category"})]}),(0,l.jsx)("div",{className:"bp-card",style:{marginBottom:20},children:(0,l.jsx)("input",{type:"text",placeholder:"Search categories...",value:t,onChange:e=>d(e.target.value),className:"bp-input",style:{width:"100%"}})}),s?(0,l.jsx)("div",{className:"bp-card",children:"Loading..."}):0===r.length?(0,l.jsx)("div",{className:"bp-card",children:"No categories found."}):(0,l.jsx)("div",{className:"bp-table-wrapper",children:(0,l.jsxs)("table",{className:"bp-table",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"Name"}),(0,l.jsx)("th",{children:"Services Count"}),(0,l.jsx)("th",{children:"Status"}),(0,l.jsx)("th",{children:"Actions"})]})}),(0,l.jsx)("tbody",{children:r.map(e=>{var a,s;const n=e.name||e.title||`#${e.id}`,i=null!==(a=null!==(s=e.services_count)&&void 0!==s?s:e.service_count)&&void 0!==a?a:0,t=void 0!==e.is_active?!!Number(e.is_active):void 0===e.is_enabled||!!Number(e.is_enabled);return(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:n}),(0,l.jsx)("td",{children:i}),(0,l.jsx)("td",{children:t?"Active":"Inactive"}),(0,l.jsxs)("td",{children:[(0,l.jsx)("button",{className:"bp-btn-sm",children:"Edit"}),(0,l.jsx)("button",{className:"bp-btn-sm bp-btn-danger",children:"Delete"})]})]},e.id)})})]})})]})}function G(){const[e,a]=(0,n.useState)([]),[s,i]=(0,n.useState)(!0),[t,d]=(0,n.useState)("");(0,n.useEffect)(()=>{!async function(){try{i(!0);const e=await fetch(`${window.BP_ADMIN?.restUrl}/admin/extras`,{headers:{"X-WP-Nonce":window.BP_ADMIN?.nonce}}),s=await e.json();a(s.data||[])}catch(e){console.error(e)}finally{i(!1)}}()},[]);const r=e.filter(e=>(e.name||"").toLowerCase().includes(t.toLowerCase()));return(0,l.jsxs)("div",{className:"bp-container",children:[(0,l.jsxs)("div",{className:"bp-header",children:[(0,l.jsx)("h1",{children:"Service Extras"}),(0,l.jsx)("button",{className:"bp-btn bp-btn-primary",children:"+ New Extra"})]}),(0,l.jsx)("div",{className:"bp-card",style:{marginBottom:20},children:(0,l.jsx)("input",{type:"text",placeholder:"Search extras...",value:t,onChange:e=>d(e.target.value),className:"bp-input",style:{width:"100%"}})}),s?(0,l.jsx)("div",{className:"bp-card",children:"Loading..."}):0===r.length?(0,l.jsx)("div",{className:"bp-card",children:"No extras found."}):(0,l.jsx)("div",{className:"bp-table-wrapper",children:(0,l.jsxs)("table",{className:"bp-table",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"Name"}),(0,l.jsx)("th",{children:"Price"}),(0,l.jsx)("th",{children:"Type"}),(0,l.jsx)("th",{children:"Status"}),(0,l.jsx)("th",{children:"Actions"})]})}),(0,l.jsx)("tbody",{children:r.map(e=>{var a;const s=e.name||e.title||`#${e.id}`,n=null!==(a=e.price_cents)&&void 0!==a?a:void 0!==e.price&&null!==e.price?Math.round(100*parseFloat(e.price)):null,i=null!==n?`$${(n/100).toFixed(2)}`:"-",t=e.type||(e.duration_min?`Duration ${e.duration_min} min`:"-"),d=void 0!==e.is_active?!!Number(e.is_active):void 0===e.is_enabled||!!Number(e.is_enabled);return(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:s}),(0,l.jsx)("td",{children:i}),(0,l.jsx)("td",{children:t}),(0,l.jsx)("td",{children:d?"Active":"Inactive"}),(0,l.jsxs)("td",{children:[(0,l.jsx)("button",{className:"bp-btn-sm",children:"Edit"}),(0,l.jsx)("button",{className:"bp-btn-sm bp-btn-danger",children:"Delete"})]})]},e.id)})})]})})]})}function H(){const[e,a]=(0,n.useState)([]),[s,i]=(0,n.useState)(!0),[t,d]=(0,n.useState)("");(0,n.useEffect)(()=>{!async function(){try{i(!0);const e=await fetch(`${window.BP_ADMIN?.restUrl}/admin/promo-codes`,{headers:{"X-WP-Nonce":window.BP_ADMIN?.nonce}}),s=await e.json();a(s.data||[])}catch(e){console.error(e)}finally{i(!1)}}()},[]);const r=e.filter(e=>(e.code||"").toLowerCase().includes(t.toLowerCase()));return(0,l.jsxs)("div",{className:"bp-container",children:[(0,l.jsxs)("div",{className:"bp-header",children:[(0,l.jsx)("h1",{children:"Promo Codes"}),(0,l.jsx)("button",{className:"bp-btn bp-btn-primary",children:"+ New Promo Code"})]}),(0,l.jsx)("div",{className:"bp-card",style:{marginBottom:20},children:(0,l.jsx)("input",{type:"text",placeholder:"Search promo codes...",value:t,onChange:e=>d(e.target.value),className:"bp-input",style:{width:"100%"}})}),s?(0,l.jsx)("div",{className:"bp-card",children:"Loading..."}):0===r.length?(0,l.jsx)("div",{className:"bp-card",children:"No promo codes found."}):(0,l.jsx)("div",{className:"bp-table-wrapper",children:(0,l.jsxs)("table",{className:"bp-table",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"Code"}),(0,l.jsx)("th",{children:"Discount"}),(0,l.jsx)("th",{children:"Uses"}),(0,l.jsx)("th",{children:"Status"}),(0,l.jsx)("th",{children:"Actions"})]})}),(0,l.jsx)("tbody",{children:r.map(e=>{var a,s,n,i,t,d;const r=e.code||e.name||`#${e.id}`,c=e.type||e.discount_type||"percent",o=null!==(a=null!==(s=e.amount)&&void 0!==s?s:e.discount_value)&&void 0!==a?a:0,m="percent"===c||"percentage"===c?`${o}%`:`$${(parseFloat(o)||0).toFixed(2)}`,p=null!==(n=null!==(i=e.uses_count)&&void 0!==i?i:e.usage_count)&&void 0!==n?n:0,h=null!==(t=null!==(d=e.max_uses)&&void 0!==d?d:e.usage_limit)&&void 0!==t?t:"‚àû",b=void 0!==e.is_active?!!Number(e.is_active):void 0===e.is_enabled||!!Number(e.is_enabled);return(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:r}),(0,l.jsx)("td",{children:m}),(0,l.jsxs)("td",{children:[p," / ",h]}),(0,l.jsx)("td",{children:b?"Active":"Inactive"}),(0,l.jsxs)("td",{children:[(0,l.jsx)("button",{className:"bp-btn-sm",children:"Edit"}),(0,l.jsx)("button",{className:"bp-btn-sm bp-btn-danger",children:"Delete"})]})]},e.id)})})]})})]})}function J(){const[e,a]=(0,n.useState)([]),[s,i]=(0,n.useState)(!0),[t,d]=(0,n.useState)("");(0,n.useEffect)(()=>{!async function(){try{i(!0);const e=await fetch(`${window.BP_ADMIN?.restUrl}/admin/customers`,{headers:{"X-WP-Nonce":window.BP_ADMIN?.nonce}}),s=await e.json();a(s.data||[])}catch(e){console.error(e)}finally{i(!1)}}()},[]);const r=e.filter(e=>(`${e.first_name||""} ${e.last_name||""}`.trim()||e.name||"").toLowerCase().includes(t.toLowerCase())||(e.email||"").toLowerCase().includes(t.toLowerCase()));return(0,l.jsxs)("div",{className:"bp-container",children:[(0,l.jsxs)("div",{className:"bp-header",children:[(0,l.jsx)("h1",{children:"Customers"}),(0,l.jsx)("button",{className:"bp-btn bp-btn-primary",children:"+ New Customer"})]}),(0,l.jsx)("div",{className:"bp-card",style:{marginBottom:20},children:(0,l.jsx)("input",{type:"text",placeholder:"Search customers...",value:t,onChange:e=>d(e.target.value),className:"bp-input",style:{width:"100%"}})}),s?(0,l.jsx)("div",{className:"bp-card",children:"Loading..."}):0===r.length?(0,l.jsx)("div",{className:"bp-card",children:"No customers found."}):(0,l.jsx)("div",{className:"bp-table-wrapper",children:(0,l.jsxs)("table",{className:"bp-table",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"Name"}),(0,l.jsx)("th",{children:"Email"}),(0,l.jsx)("th",{children:"Phone"}),(0,l.jsx)("th",{children:"Bookings"}),(0,l.jsx)("th",{children:"Actions"})]})}),(0,l.jsx)("tbody",{children:r.map(e=>{var a,s;const n=`${e.first_name||""} ${e.last_name||""}`.trim()||e.name||`#${e.id}`,i=null!==(a=null!==(s=e.bookings_count)&&void 0!==s?s:e.booking_count)&&void 0!==a?a:0;return(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:n}),(0,l.jsx)("td",{children:e.email||"-"}),(0,l.jsx)("td",{children:e.phone||"-"}),(0,l.jsx)("td",{children:i}),(0,l.jsxs)("td",{children:[(0,l.jsx)("button",{className:"bp-btn-sm",children:"View"}),(0,l.jsx)("button",{className:"bp-btn-sm",children:"Edit"})]})]},e.id)})})]})})]})}function q(){const[e,a]=(0,n.useState)([]),[s,i]=(0,n.useState)(!0),[t,d]=(0,n.useState)("");(0,n.useEffect)(()=>{!async function(){try{i(!0);const e=await fetch(`${window.BP_ADMIN?.restUrl}/admin/agents-full`,{headers:{"X-WP-Nonce":window.BP_ADMIN?.nonce}}),s=await e.json();a(s.data||[])}catch(e){console.error(e)}finally{i(!1)}}()},[]);const r=e.filter(e=>(`${e.first_name||""} ${e.last_name||""}`.trim()||e.name||"").toLowerCase().includes(t.toLowerCase()));return(0,l.jsxs)("div",{className:"bp-container",children:[(0,l.jsxs)("div",{className:"bp-header",children:[(0,l.jsx)("h1",{children:"Agents"}),(0,l.jsx)("button",{className:"bp-btn bp-btn-primary",children:"+ New Agent"})]}),(0,l.jsx)("div",{className:"bp-card",style:{marginBottom:20},children:(0,l.jsx)("input",{type:"text",placeholder:"Search agents...",value:t,onChange:e=>d(e.target.value),className:"bp-input",style:{width:"100%"}})}),s?(0,l.jsx)("div",{className:"bp-card",children:"Loading..."}):0===r.length?(0,l.jsx)("div",{className:"bp-card",children:"No agents found."}):(0,l.jsx)("div",{className:"bp-table-wrapper",children:(0,l.jsxs)("table",{className:"bp-table",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"Name"}),(0,l.jsx)("th",{children:"Email"}),(0,l.jsx)("th",{children:"Phone"}),(0,l.jsx)("th",{children:"Services"}),(0,l.jsx)("th",{children:"Status"}),(0,l.jsx)("th",{children:"Actions"})]})}),(0,l.jsx)("tbody",{children:r.map(e=>{var a,s;const n=`${e.first_name||""} ${e.last_name||""}`.trim()||e.name||`#${e.id}`,i=null!==(a=null!==(s=e.services_count)&&void 0!==s?s:e.service_count)&&void 0!==a?a:0,t=void 0!==e.is_active?!!Number(e.is_active):void 0===e.is_enabled||!!Number(e.is_enabled);return(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:n}),(0,l.jsx)("td",{children:e.email||"-"}),(0,l.jsx)("td",{children:e.phone||"-"}),(0,l.jsx)("td",{children:i}),(0,l.jsx)("td",{children:t?"Active":"Inactive"}),(0,l.jsxs)("td",{children:[(0,l.jsx)("button",{className:"bp-btn-sm",children:"Edit"}),(0,l.jsx)("button",{className:"bp-btn-sm bp-btn-danger",children:"Delete"})]})]},e.id)})})]})})]})}const X=[{id:"general",label:"General"},{id:"emails",label:"Emails"},{id:"webhooks",label:"Webhooks"},{id:"license",label:"License"},{id:"import_export",label:"Import / Export"}],V=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function Y(){const[e,a]=(0,n.useState)({}),[s,t]=(0,n.useState)(!0),[d,r]=(0,n.useState)(!1),[c,o]=(0,n.useState)(()=>{const e=new URLSearchParams(window.location.search).get("tab");return X.find(a=>a.id===e)?.id||"general"}),m=(0,n.useMemo)(()=>[{code:"AED",name:"UAE Dirham"},{code:"AFN",name:"Afghan Afghani"},{code:"ALL",name:"Albanian Lek"},{code:"AMD",name:"Armenian Dram"},{code:"ANG",name:"Netherlands Antillean Guilder"},{code:"AOA",name:"Angolan Kwanza"},{code:"ARS",name:"Argentine Peso"},{code:"AUD",name:"Australian Dollar"},{code:"AWG",name:"Aruban Florin"},{code:"AZN",name:"Azerbaijani Manat"},{code:"BAM",name:"Bosnia-Herzegovina Convertible Mark"},{code:"BBD",name:"Barbadian Dollar"},{code:"BDT",name:"Bangladeshi Taka"},{code:"BGN",name:"Bulgarian Lev"},{code:"BHD",name:"Bahraini Dinar"},{code:"BIF",name:"Burundian Franc"},{code:"BMD",name:"Bermudian Dollar"},{code:"BND",name:"Brunei Dollar"},{code:"BOB",name:"Bolivian Boliviano"},{code:"BRL",name:"Brazilian Real"},{code:"BSD",name:"Bahamian Dollar"},{code:"BTN",name:"Bhutanese Ngultrum"},{code:"BWP",name:"Botswana Pula"},{code:"BYN",name:"Belarusian Ruble"},{code:"BZD",name:"Belize Dollar"},{code:"CAD",name:"Canadian Dollar"},{code:"CDF",name:"Congolese Franc"},{code:"CHF",name:"Swiss Franc"},{code:"CLP",name:"Chilean Peso"},{code:"CNY",name:"Chinese Yuan"},{code:"COP",name:"Colombian Peso"},{code:"CRC",name:"Costa Rican Col√≥n"},{code:"CUC",name:"Cuban Convertible Peso"},{code:"CUP",name:"Cuban Peso"},{code:"CVE",name:"Cape Verdean Escudo"},{code:"CZK",name:"Czech Koruna"},{code:"DJF",name:"Djiboutian Franc"},{code:"DKK",name:"Danish Krone"},{code:"DOP",name:"Dominican Peso"},{code:"DZD",name:"Algerian Dinar"},{code:"EGP",name:"Egyptian Pound"},{code:"ERN",name:"Eritrean Nakfa"},{code:"ETB",name:"Ethiopian Birr"},{code:"EUR",name:"Euro"},{code:"FJD",name:"Fijian Dollar"},{code:"FKP",name:"Falkland Islands Pound"},{code:"GBP",name:"British Pound"},{code:"GEL",name:"Georgian Lari"},{code:"GHS",name:"Ghanaian Cedi"},{code:"GIP",name:"Gibraltar Pound"},{code:"GMD",name:"Gambian Dalasi"},{code:"GNF",name:"Guinean Franc"},{code:"GTQ",name:"Guatemalan Quetzal"},{code:"GYD",name:"Guyanaese Dollar"},{code:"HKD",name:"Hong Kong Dollar"},{code:"HNL",name:"Honduran Lempira"},{code:"HRK",name:"Croatian Kuna"},{code:"HTG",name:"Haitian Gourde"},{code:"HUF",name:"Hungarian Forint"},{code:"IDR",name:"Indonesian Rupiah"},{code:"ILS",name:"Israeli New Shekel"},{code:"INR",name:"Indian Rupee"},{code:"IQD",name:"Iraqi Dinar"},{code:"IRR",name:"Iranian Rial"},{code:"ISK",name:"Icelandic Kr√≥na"},{code:"JMD",name:"Jamaican Dollar"},{code:"JOD",name:"Jordanian Dinar"},{code:"JPY",name:"Japanese Yen"},{code:"KES",name:"Kenyan Shilling"},{code:"KGS",name:"Kyrgystani Som"},{code:"KHR",name:"Cambodian Riel"},{code:"KMF",name:"Comorian Franc"},{code:"KPW",name:"North Korean Won"},{code:"KRW",name:"South Korean Won"},{code:"KWD",name:"Kuwaiti Dinar"},{code:"KYD",name:"Cayman Islands Dollar"},{code:"KZT",name:"Kazakhstani Tenge"},{code:"LAK",name:"Laotian Kip"},{code:"LBP",name:"Lebanese Pound"},{code:"LKR",name:"Sri Lankan Rupee"},{code:"LRD",name:"Liberian Dollar"},{code:"LSL",name:"Lesotho Loti"},{code:"LYD",name:"Libyan Dinar"},{code:"MAD",name:"Moroccan Dirham"},{code:"MDL",name:"Moldovan Leu"},{code:"MGA",name:"Malagasy Ariary"},{code:"MKD",name:"Macedonian Denar"},{code:"MMK",name:"Myanmar Kyat"},{code:"MNT",name:"Mongolian T√∂gr√∂g"},{code:"MOP",name:"Macanese Pataca"},{code:"MRU",name:"Mauritanian Ouguiya"},{code:"MUR",name:"Mauritian Rupee"},{code:"MVR",name:"Maldivian Rufiyaa"},{code:"MWK",name:"Malawian Kwacha"},{code:"MXN",name:"Mexican Peso"},{code:"MYR",name:"Malaysian Ringgit"},{code:"MZN",name:"Mozambican Metical"},{code:"NAD",name:"Namibian Dollar"},{code:"NGN",name:"Nigerian Naira"},{code:"NIO",name:"Nicaraguan C√≥rdoba"},{code:"NOK",name:"Norwegian Krone"},{code:"NPR",name:"Nepalese Rupee"},{code:"NZD",name:"New Zealand Dollar"},{code:"OMR",name:"Omani Rial"},{code:"PAB",name:"Panamanian Balboa"},{code:"PEN",name:"Peruvian Sol"},{code:"PGK",name:"Papua New Guinean Kina"},{code:"PHP",name:"Philippine Peso"},{code:"PKR",name:"Pakistani Rupee"},{code:"PLN",name:"Polish Z≈Çoty"},{code:"PYG",name:"Paraguayan Guaran√≠"},{code:"QAR",name:"Qatari Riyal"},{code:"RON",name:"Romanian Leu"},{code:"RSD",name:"Serbian Dinar"},{code:"RUB",name:"Russian Ruble"},{code:"RWF",name:"Rwandan Franc"},{code:"SAR",name:"Saudi Riyal"},{code:"SBD",name:"Solomon Islands Dollar"},{code:"SCR",name:"Seychellois Rupee"},{code:"SDG",name:"Sudanese Pound"},{code:"SEK",name:"Swedish Krona"},{code:"SGD",name:"Singapore Dollar"},{code:"SHP",name:"Saint Helena Pound"},{code:"SLE",name:"Sierra Leonean Leone"},{code:"SOS",name:"Somali Shilling"},{code:"SRD",name:"Surinamese Dollar"},{code:"SSP",name:"South Sudanese Pound"},{code:"STN",name:"S√£o Tom√© and Pr√≠ncipe Dobra"},{code:"SYP",name:"Syrian Pound"},{code:"SZL",name:"Swazi Lilangeni"},{code:"THB",name:"Thai Baht"},{code:"TJS",name:"Tajikistani Somoni"},{code:"TMT",name:"Turkmenistani Manat"},{code:"TND",name:"Tunisian Dinar"},{code:"TOP",name:"Tongan Pa ªanga"},{code:"TRY",name:"Turkish Lira"},{code:"TTD",name:"Trinidad and Tobago Dollar"},{code:"TWD",name:"New Taiwan Dollar"},{code:"TZS",name:"Tanzanian Shilling"},{code:"UAH",name:"Ukrainian Hryvnia"},{code:"UGX",name:"Ugandan Shilling"},{code:"USD",name:"US Dollar"},{code:"UYU",name:"Uruguayan Peso"},{code:"UZS",name:"Uzbekistan Som"},{code:"VES",name:"Venezuelan Bol√≠var"},{code:"VND",name:"Vietnamese ƒê·ªìng"},{code:"VUV",name:"Vanuatu Vatu"},{code:"WST",name:"Samoan TƒÅlƒÅ"},{code:"XAF",name:"Central African CFA Franc"},{code:"XCD",name:"East Caribbean Dollar"},{code:"XOF",name:"West African CFA Franc"},{code:"XPF",name:"CFP Franc"},{code:"YER",name:"Yemeni Rial"},{code:"ZAR",name:"South African Rand"},{code:"ZMW",name:"Zambian Kwacha"},{code:"ZWL",name:"Zimbabwean Dollar"}],[]),p=window.BP_ADMIN?.adminPostUrl||"admin-post.php",h=window.BP_ADMIN?.adminNonce||"",b=window.BP_ADMIN?.license||{};function u(s,n){a({...e,[s]:n})}function x(a,s){const n=Array.isArray(a)?a:[a];for(const a of n)if(Object.prototype.hasOwnProperty.call(e,a))return e[a];return s}function v(e){return!0===e||1===e||"1"===e||"true"===e}async function j(){try{const a=await fetch(`${window.BP_ADMIN?.restUrl}/admin/settings`,{method:"POST",headers:{"X-WP-Nonce":window.BP_ADMIN?.nonce,"Content-Type":"application/json"},body:JSON.stringify(e)});"success"===(await a.json()).status&&(r(!0),setTimeout(()=>r(!1),3e3))}catch(e){console.error(e)}}(0,n.useEffect)(()=>{!async function(){try{t(!0);const e=await fetch(`${window.BP_ADMIN?.restUrl}/admin/settings`,{headers:{"X-WP-Nonce":window.BP_ADMIN?.nonce}}),s=await e.json();a(s.data||{})}catch(e){console.error(e)}finally{t(!1)}}()},[]),(0,n.useEffect)(()=>{const e=new URL(window.location.href);e.searchParams.set("tab",c),window.history.replaceState({},"",e.toString())},[c]);const g=(0,n.useMemo)(()=>Object.keys(e||{}).filter(e=>!["slot_interval_minutes","currency","currency_position","bp_open_time","bp_close_time","bp_future_days_limit","bp_breaks","bp_email_enabled","bp_admin_email","bp_email_from_name","bp_email_from_email","webhooks_enabled","webhooks_secret","webhooks_url_booking_created","webhooks_url_booking_status_changed","webhooks_url_booking_updated","webhooks_url_booking_cancelled","bp_remove_data_on_uninstall"].includes(e)).sort(),[e]);function N(e,a){return"boolean"==typeof a?(0,l.jsx)("input",{type:"checkbox",checked:a,onChange:a=>u(e,a.target.checked)}):"number"==typeof a?(0,l.jsx)("input",{type:"number",value:a,onChange:a=>u(e,Number(a.target.value)),className:"bp-input"}):Array.isArray(a)||a&&"object"==typeof a?(0,l.jsx)("textarea",{className:"bp-input",rows:3,value:JSON.stringify(a),onChange:a=>{try{u(e,JSON.parse(a.target.value))}catch{u(e,a.target.value)}}}):(0,l.jsx)("input",{type:"text",value:null!=a?a:"",onChange:a=>u(e,a.target.value),className:"bp-input"})}if(s)return(0,l.jsx)("div",{className:"bp-card",children:"Loading..."});const y=(()=>{const e=(b.status||"").toLowerCase();return"valid"===e?"‚úÖ valid":"expired"===e?"‚ö†Ô∏è expired":"invalid"===e?"‚ùå invalid":"‚Äî unset"})(),f=`${p}?action=bp_admin_settings_export_json&_wpnonce=${encodeURIComponent(h)}`;return(0,l.jsxs)("div",{className:"bp-container",children:[(0,l.jsx)("div",{className:"bp-header",children:(0,l.jsx)("h1",{children:"Settings"})}),(0,l.jsx)("div",{className:"bp-card",style:{marginBottom:12},children:(0,l.jsx)("div",{className:"bp-tabs",children:X.map(e=>(0,l.jsx)("button",{className:"bp-tab "+(c===e.id?"active":""),onClick:()=>o(e.id),type:"button",children:e.label},e.id))})}),"general"===c&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"bp-card",children:[(0,l.jsxs)("div",{style:{marginBottom:20},children:[(0,l.jsx)("label",{className:"bp-label",children:"Open time"}),(0,l.jsx)("input",{type:"text",placeholder:"09:00",value:x("bp_open_time","09:00"),onChange:e=>u("bp_open_time",e.target.value),className:"bp-input"})]}),(0,l.jsxs)("div",{style:{marginBottom:20},children:[(0,l.jsx)("label",{className:"bp-label",children:"Close time"}),(0,l.jsx)("input",{type:"text",placeholder:"17:00",value:x("bp_close_time","17:00"),onChange:e=>u("bp_close_time",e.target.value),className:"bp-input"})]}),(0,l.jsxs)("div",{style:{marginBottom:20},children:[(0,l.jsx)("label",{className:"bp-label",children:"Slot Interval (minutes)"}),(0,l.jsx)("input",{type:"number",min:5,max:120,value:x("slot_interval_minutes",15),onChange:e=>u("slot_interval_minutes",parseInt(e.target.value||15,10)),className:"bp-input"})]}),(0,l.jsxs)("div",{style:{marginBottom:20},children:[(0,l.jsx)("label",{className:"bp-label",children:"Currency"}),(0,l.jsx)("select",{value:x(["currency","bp_default_currency"],"USD"),onChange:e=>u("currency",e.target.value),className:"bp-input",children:m.map(e=>(0,l.jsxs)("option",{value:e.code,children:[e.code," - ",e.name]},e.code))})]}),(0,l.jsxs)("div",{style:{marginBottom:20},children:[(0,l.jsx)("label",{className:"bp-label",children:"Currency Position"}),(0,l.jsxs)("select",{value:x(["currency_position","bp_currency_position"],"before"),onChange:e=>u("currency_position",e.target.value),className:"bp-input",children:[(0,l.jsx)("option",{value:"before",children:"Before amount (e.g., $10)"}),(0,l.jsx)("option",{value:"after",children:"After amount (e.g., 10$)"})]})]}),(0,l.jsx)("div",{className:"bp-section-title",style:{marginBottom:10},children:"Availability & Scheduling"}),(0,l.jsxs)("div",{style:{marginBottom:20},children:[(0,l.jsx)("label",{className:"bp-label",children:"Booking limit (days ahead)"}),(0,l.jsx)("input",{type:"number",min:1,max:365,value:x("bp_future_days_limit",60),onChange:e=>u("bp_future_days_limit",parseInt(e.target.value||60,10)),className:"bp-input"}),(0,l.jsx)("div",{className:"bp-muted",style:{fontSize:12,marginTop:6},children:"Customers can only book up to this many days in advance"})]}),(0,l.jsxs)("div",{style:{marginBottom:20},children:[(0,l.jsx)("label",{className:"bp-label",children:"Daily breaks"}),(0,l.jsx)("input",{type:"text",placeholder:"12:00-13:00,15:00-15:15",value:x("bp_breaks","12:00-13:00"),onChange:e=>u("bp_breaks",e.target.value),className:"bp-input"}),(0,l.jsx)("div",{className:"bp-muted",style:{fontSize:12,marginTop:6},children:"Comma-separated break times (e.g., 12:00-13:00,15:00-15:15)"})]}),(0,l.jsx)("div",{className:"bp-section-title",style:{marginBottom:10},children:"Weekly Schedule"}),(0,l.jsxs)("div",{className:"bp-card",style:{padding:12,background:"var(--bp-bg)",border:"1px solid var(--bp-border)",marginBottom:20},children:[V.map((e,a)=>(0,l.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"140px 1fr",gap:12,alignItems:"center",marginBottom:10},children:[(0,l.jsx)("div",{style:{fontWeight:900},children:e}),(0,l.jsx)("input",{type:"text",placeholder:"09:00-17:00",value:x(`bp_schedule_${a}`,""),onChange:e=>u(`bp_schedule_${a}`,e.target.value),className:"bp-input"})]},e)),(0,l.jsx)("div",{className:"bp-muted",style:{fontSize:12},children:"Leave empty for closed days. Format: HH:MM-HH:MM (e.g., 09:00-17:00)"})]}),(0,l.jsx)("div",{className:"bp-section-title",style:{marginBottom:10},children:"Uninstall"}),(0,l.jsxs)("label",{style:{display:"flex",gap:10,alignItems:"center"},children:[(0,l.jsx)("input",{type:"checkbox",checked:v(x("bp_remove_data_on_uninstall",0)),onChange:e=>u("bp_remove_data_on_uninstall",e.target.checked?1:0)}),"Delete all BookPoint data when the plugin is uninstalled."]}),(0,l.jsxs)("div",{style:{marginTop:16},children:[(0,l.jsx)("button",{onClick:j,className:"bp-btn bp-btn-primary",style:{marginRight:10},children:"Save Settings"}),d&&(0,l.jsx)("span",{style:{color:"green",marginLeft:10},children:"‚úì Saved!"})]})]}),(0,l.jsxs)("div",{className:"bp-card",style:{marginTop:16},children:[(0,l.jsx)("div",{className:"bp-section-title",style:{marginBottom:10},children:"All Settings"}),0===g.length?(0,l.jsx)("div",{className:"bp-muted",children:"No additional settings found."}):(0,l.jsx)("div",{className:"bp-kv",children:g.map(a=>(0,l.jsxs)(i().Fragment,{children:[(0,l.jsx)("div",{className:"bp-k",children:a}),(0,l.jsx)("div",{className:"bp-v",children:N(a,e[a])})]},a))})]})]}),"emails"===c&&(0,l.jsxs)("div",{className:"bp-card",children:[(0,l.jsx)("div",{className:"bp-section-title",style:{marginBottom:10},children:"Email Notifications"}),(0,l.jsxs)("label",{style:{display:"flex",gap:10,alignItems:"center",marginBottom:16},children:[(0,l.jsx)("input",{type:"checkbox",checked:v(x("bp_email_enabled",1)),onChange:e=>u("bp_email_enabled",e.target.checked?1:0)}),"Send email notifications for bookings"]}),(0,l.jsxs)("div",{style:{marginBottom:20},children:[(0,l.jsx)("label",{className:"bp-label",children:"Admin email"}),(0,l.jsx)("input",{type:"email",value:x("bp_admin_email",""),onChange:e=>u("bp_admin_email",e.target.value),className:"bp-input"})]}),(0,l.jsxs)("div",{style:{marginBottom:20},children:[(0,l.jsx)("label",{className:"bp-label",children:"From name"}),(0,l.jsx)("input",{type:"text",value:x("bp_email_from_name",""),onChange:e=>u("bp_email_from_name",e.target.value),className:"bp-input"})]}),(0,l.jsxs)("div",{style:{marginBottom:20},children:[(0,l.jsx)("label",{className:"bp-label",children:"From email"}),(0,l.jsx)("input",{type:"email",value:x("bp_email_from_email",""),onChange:e=>u("bp_email_from_email",e.target.value),className:"bp-input"})]}),(0,l.jsx)("button",{onClick:j,className:"bp-btn bp-btn-primary",style:{marginRight:10},children:"Save Settings"}),d&&(0,l.jsx)("span",{style:{color:"green",marginLeft:10},children:"‚úì Saved!"})]}),"webhooks"===c&&(0,l.jsxs)("div",{className:"bp-card",children:[(0,l.jsx)("div",{className:"bp-section-title",style:{marginBottom:10},children:"Webhooks"}),(0,l.jsxs)("label",{style:{display:"flex",gap:10,alignItems:"center",marginBottom:16},children:[(0,l.jsx)("input",{type:"checkbox",checked:v(x("webhooks_enabled",0)),onChange:e=>u("webhooks_enabled",e.target.checked?1:0)}),"Send webhook events for bookings"]}),(0,l.jsxs)("div",{style:{marginBottom:20},children:[(0,l.jsx)("label",{className:"bp-label",children:"Webhook secret"}),(0,l.jsx)("input",{type:"text",value:x("webhooks_secret",""),onChange:e=>u("webhooks_secret",e.target.value),className:"bp-input"}),(0,l.jsx)("div",{className:"bp-muted",style:{fontSize:12,marginTop:6},children:"Used to sign webhook payloads (optional)."})]}),(0,l.jsxs)("div",{style:{marginBottom:20},children:[(0,l.jsx)("label",{className:"bp-label",children:"Booking created URL"}),(0,l.jsx)("input",{type:"url",value:x("webhooks_url_booking_created",""),onChange:e=>u("webhooks_url_booking_created",e.target.value),className:"bp-input"})]}),(0,l.jsxs)("div",{style:{marginBottom:20},children:[(0,l.jsx)("label",{className:"bp-label",children:"Booking status changed URL"}),(0,l.jsx)("input",{type:"url",value:x("webhooks_url_booking_status_changed",""),onChange:e=>u("webhooks_url_booking_status_changed",e.target.value),className:"bp-input"})]}),(0,l.jsxs)("div",{style:{marginBottom:20},children:[(0,l.jsx)("label",{className:"bp-label",children:"Booking updated URL"}),(0,l.jsx)("input",{type:"url",value:x("webhooks_url_booking_updated",""),onChange:e=>u("webhooks_url_booking_updated",e.target.value),className:"bp-input"})]}),(0,l.jsxs)("div",{style:{marginBottom:20},children:[(0,l.jsx)("label",{className:"bp-label",children:"Booking cancelled URL"}),(0,l.jsx)("input",{type:"url",value:x("webhooks_url_booking_cancelled",""),onChange:e=>u("webhooks_url_booking_cancelled",e.target.value),className:"bp-input"})]}),(0,l.jsx)("button",{onClick:j,className:"bp-btn bp-btn-primary",style:{marginRight:10},children:"Save Settings"}),d&&(0,l.jsx)("span",{style:{color:"green",marginLeft:10},children:"‚úì Saved!"})]}),"license"===c&&(0,l.jsxs)("div",{className:"bp-card",children:[(0,l.jsx)("div",{className:"bp-section-title",style:{marginBottom:10},children:"License"}),(0,l.jsxs)("div",{style:{marginBottom:10},children:[(0,l.jsx)("strong",{children:"Status:"})," ",y]}),b.checked_at?(0,l.jsxs)("div",{className:"bp-muted",style:{fontSize:12,marginBottom:8},children:["Last checked: ",new Date(1e3*Number(b.checked_at)).toLocaleString()]}):null,b.last_error?(0,l.jsxs)("div",{className:"bp-muted",style:{fontSize:12,marginBottom:12},children:["Message: ",b.last_error]}):null,(0,l.jsxs)("form",{method:"post",action:p,style:{marginBottom:16},children:[(0,l.jsx)("input",{type:"hidden",name:"action",value:"bp_admin_settings_save_license"}),(0,l.jsx)("input",{type:"hidden",name:"_wpnonce",value:h}),(0,l.jsxs)("div",{style:{marginBottom:12},children:[(0,l.jsx)("label",{className:"bp-label",children:"License key"}),(0,l.jsx)("input",{type:"text",name:"bp_license_key",defaultValue:b.key||"",className:"bp-input"}),(0,l.jsx)("div",{className:"bp-muted",style:{fontSize:12,marginTop:6},children:"Paste your license key here and save."})]}),(0,l.jsx)("button",{className:"bp-btn bp-btn-primary",type:"submit",children:"Save License"})]}),(0,l.jsxs)("form",{method:"post",action:p,children:[(0,l.jsx)("input",{type:"hidden",name:"action",value:"bp_admin_settings_validate_license"}),(0,l.jsx)("input",{type:"hidden",name:"_wpnonce",value:h}),(0,l.jsx)("button",{className:"bp-btn",type:"submit",children:"Validate Now"}),(0,l.jsx)("div",{className:"bp-muted",style:{fontSize:12,marginTop:6},children:"Forces a license check immediately."})]}),(0,l.jsx)("hr",{style:{margin:"16px 0"}}),(0,l.jsx)("div",{className:"bp-section-title",style:{marginBottom:6},children:"Updates"}),(0,l.jsx)("div",{className:"bp-muted",style:{fontSize:12,marginBottom:10},children:"If your update server is configured, WordPress will show updates on the Plugins page."}),(0,l.jsx)("a",{className:"bp-btn",href:"update-core.php",children:"Go to Updates"})]}),"import_export"===c&&(0,l.jsxs)("div",{className:"bp-card",children:[(0,l.jsx)("div",{className:"bp-section-title",style:{marginBottom:10},children:"Import / Export"}),(0,l.jsxs)("div",{style:{marginBottom:12},children:[(0,l.jsx)("div",{style:{fontWeight:900,marginBottom:6},children:"Export settings"}),(0,l.jsx)("div",{className:"bp-muted",style:{fontSize:12,marginBottom:10},children:"Downloads a JSON file with BookPoint settings."}),(0,l.jsx)("a",{className:"bp-btn bp-btn-primary",href:f,children:"Export JSON"})]}),(0,l.jsx)("hr",{style:{margin:"16px 0"}}),(0,l.jsxs)("div",{style:{marginBottom:12},children:[(0,l.jsx)("div",{style:{fontWeight:900,marginBottom:6},children:"Import settings"}),(0,l.jsx)("div",{className:"bp-muted",style:{fontSize:12,marginBottom:10},children:"Upload a previously exported JSON file. Only whitelisted settings keys are imported."}),(0,l.jsxs)("form",{method:"post",action:p,encType:"multipart/form-data",onSubmit:e=>{confirm("Import settings JSON?")||e.preventDefault()},children:[(0,l.jsx)("input",{type:"hidden",name:"action",value:"bp_admin_settings_import_json"}),(0,l.jsx)("input",{type:"hidden",name:"_wpnonce",value:h}),(0,l.jsx)("input",{type:"file",name:"bp_settings_file",accept:"application/json",required:!0}),(0,l.jsx)("button",{className:"bp-btn",type:"submit",style:{marginLeft:8},children:"Import JSON"})]})]})]})]})}function Z(){const[e,a]=(0,n.useState)([]),[s,i]=(0,n.useState)(!0),[t,d]=(0,n.useState)("all");(0,n.useEffect)(()=>{!async function(){try{i(!0);const e=await fetch(`${window.BP_ADMIN?.restUrl}/admin/audit-logs`,{headers:{"X-WP-Nonce":window.BP_ADMIN?.nonce}}),s=await e.json(),n=s.data?.items||s.data||[];a(n)}catch(e){console.error(e)}finally{i(!1)}}()},[]);const r="all"===t?e:e.filter(e=>(e.event||e.action)===t);return(0,l.jsxs)("div",{className:"bp-container",children:[(0,l.jsxs)("div",{className:"bp-header",children:[(0,l.jsx)("h1",{children:"Audit Log"}),(0,l.jsx)("button",{onClick:()=>a([]),className:"bp-btn bp-btn-secondary",children:"Clear Log"})]}),(0,l.jsx)("div",{className:"bp-card",style:{marginBottom:20},children:(0,l.jsxs)("select",{value:t,onChange:e=>d(e.target.value),className:"bp-input",children:[(0,l.jsx)("option",{value:"all",children:"All Actions"}),(0,l.jsx)("option",{value:"create",children:"Create"}),(0,l.jsx)("option",{value:"update",children:"Update"}),(0,l.jsx)("option",{value:"delete",children:"Delete"}),(0,l.jsx)("option",{value:"view",children:"View"})]})}),s?(0,l.jsx)("div",{className:"bp-card",children:"Loading..."}):0===r.length?(0,l.jsx)("div",{className:"bp-card",children:"No audit logs found."}):(0,l.jsx)("div",{className:"bp-table-wrapper",children:(0,l.jsxs)("table",{className:"bp-table",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"User"}),(0,l.jsx)("th",{children:"Action"}),(0,l.jsx)("th",{children:"Item"}),(0,l.jsx)("th",{children:"Timestamp"}),(0,l.jsx)("th",{children:"Details"})]})}),(0,l.jsx)("tbody",{children:r.map((e,a)=>{const s=e.actor_name||e.user_name||e.actor_type||"-",n=e.event||e.action||"-",i=e.item_type||e.resource||(e.booking_id?`Booking #${e.booking_id}`:"-"),t=e.created_at?new Date(e.created_at).toLocaleString():"-",d=e.details||e.meta||e.message||"-";return(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:s}),(0,l.jsx)("td",{children:n}),(0,l.jsx)("td",{children:i}),(0,l.jsx)("td",{children:t}),(0,l.jsx)("td",{children:"string"==typeof d?d:JSON.stringify(d)})]},a)})})]})})]})}function Q(){const[e]=(0,n.useState)([{id:"sync_relations",name:"Sync Relations",description:"Rebuild service/agent/category relations"},{id:"generate_demo",name:"Generate Demo Data",description:"Create sample services, agents, customers, bookings"},{id:"reset_cache",name:"Reset Cache",description:"Clear cached data"}]),[a,s]=(0,n.useState)(null),[i,t]=(0,n.useState)(null);async function d(){try{const e=await fetch(`${window.BP_ADMIN?.restUrl}/admin/tools/status`,{headers:{"X-WP-Nonce":window.BP_ADMIN?.nonce}}),a=await e.json();t(a.data||null)}catch(e){console.error(e)}}return(0,n.useEffect)(()=>{d()},[]),(0,l.jsxs)("div",{className:"bp-container",children:[(0,l.jsx)("div",{className:"bp-header",children:(0,l.jsx)("h1",{children:"Tools"})}),i?(0,l.jsxs)("div",{className:"bp-card",style:{marginBottom:20},children:[(0,l.jsx)("div",{className:"bp-card-label",children:"System Status"}),(0,l.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:10,marginTop:10},children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("strong",{children:"DB Version:"})," ",i.db_version||"-"]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("strong",{children:"Plugin Version:"})," ",i.plugin_version||"-"]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("strong",{children:"Tables:"})," ",i.tables_ok_count||0," / ",i.tables_total||0]})]})]}):null,(0,l.jsx)("div",{className:"bp-grid",style:{gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:20},children:e.map(e=>(0,l.jsxs)("div",{className:"bp-card",children:[(0,l.jsx)("h3",{children:e.name}),(0,l.jsx)("p",{style:{color:"#666",marginBottom:15},children:e.description}),(0,l.jsx)("button",{onClick:()=>async function(e){try{s(e);const a=await fetch(`${window.BP_ADMIN?.restUrl}/admin/tools/run/${e}`,{method:"POST",headers:{"X-WP-Nonce":window.BP_ADMIN?.nonce,"Content-Type":"application/json"},body:JSON.stringify({})}),n=await a.json();alert(n.message||n.data?.message||"Tool completed"),d()}catch(e){console.error(e),alert("Error running tool")}finally{s(null)}}(e.id),disabled:a===e.id,className:"bp-btn bp-btn-primary",style:{width:"100%"},children:a===e.id?"Running...":"Run"})]},e.id))})]})}function ee(){const e=window.BP_ADMIN?.page||"bp_dashboard",a=(0,n.useMemo)(()=>function(e){switch(e){case"bp_dashboard":default:return"dashboard";case"bp-bookings":case"bp_bookings":return"bookings";case"bp-calendar":case"bp_calendar":return"calendar";case"bp-schedule":case"bp_schedule":return"schedule";case"bp-holidays":case"bp_holidays":return"holidays";case"bp-services":case"bp_services":return"services";case"bp_services_edit":return"services-edit";case"bp-categories":case"bp_categories":return"categories";case"bp-extras":case"bp_extras":return"extras";case"bp-promo-codes":case"bp_promo_codes":return"promo";case"bp-form-fields":return"form-fields";case"bp-customers":case"bp_customers":return"customers";case"bp-agents":case"bp_agents":return"agents";case"bp-settings":case"bp_settings":return"settings";case"bp-audit-log":case"bp_audit":return"audit";case"bp-tools":case"bp_tools":return"tools"}}(e),[e]),[s,i]=(0,n.useState)("light");return(0,n.useEffect)(()=>{const e="dark"===localStorage.getItem("bp_theme")?"dark":"light";i(e),document.documentElement.classList.toggle("bp-dark","dark"===e)},[]),(0,l.jsxs)(d,{theme:s,onToggleTheme:function(){const e="dark"===s?"light":"dark";i(e),localStorage.setItem("bp_theme",e),document.documentElement.classList.toggle("bp-dark","dark"===e)},active:a,children:["dashboard"===a?(0,l.jsx)(o,{}):null,"bookings"===a?(0,l.jsx)(p,{}):null,"form-fields"===a?(0,l.jsx)(N,{}):null,"services"===a?(0,l.jsx)(U,{}):null,"services-edit"===a?(0,l.jsx)(O,{}):null,"categories"===a?(0,l.jsx)(K,{}):null,"extras"===a?(0,l.jsx)(G,{}):null,"promo"===a?(0,l.jsx)(H,{}):null,"customers"===a?(0,l.jsx)(J,{}):null,"agents"===a?(0,l.jsx)(q,{}):null,"settings"===a?(0,l.jsx)(Y,{}):null,"audit"===a?(0,l.jsx)(Z,{}):null,"tools"===a?(0,l.jsx)(Q,{}):null,["calendar","schedule","holidays","catalog"].includes(a)?(0,l.jsx)(ae,{title:a}):null]})}function ae({title:e}){return(0,l.jsxs)("div",{className:"bp-card",children:[(0,l.jsx)("div",{className:"bp-card-label",children:"Page"}),(0,l.jsxs)("div",{className:"bp-card-value",style:{fontSize:18,marginTop:6},children:[e," (UI shell active ‚úÖ)"]}),(0,l.jsx)("div",{className:"bp-muted",style:{marginTop:8},children:"Next: we design and connect this page with Horizon UI layout."})]})}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("bp-admin-app");e&&(0,t.H)(e).render((0,l.jsx)(ee,{}))})})();