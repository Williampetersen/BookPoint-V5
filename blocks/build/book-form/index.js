(()=>{"use strict";var e={n:o=>{var t=o&&o.__esModule?()=>o.default:()=>o;return e.d(t,{a:t}),t},d:(o,t)=>{for(var i in t)e.o(t,i)&&!e.o(o,i)&&Object.defineProperty(o,i,{enumerable:!0,get:t[i]})},o:(e,o)=>Object.prototype.hasOwnProperty.call(e,o)};const o=window.wp.blocks,t=window.wp.blockEditor,i=window.wp.components,n=window.wp.i18n,s=window.wp.apiFetch;var r=e.n(s);const a=window.wp.element,l=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":2,"name":"bookpoint/booking-form","title":"BookPoint – Booking Form","category":"widgets","icon":"calendar-alt","description":"Insert the BookPoint booking form.","textdomain":"bookpoint","attributes":{"serviceId":{"type":"number","default":0},"defaultDate":{"type":"string","default":""},"hideNotes":{"type":"boolean","default":false},"requirePhone":{"type":"boolean","default":false},"compact":{"type":"boolean","default":false}},"supports":{"html":false},"editorScript":"file:./index.js"}'),c=window.ReactJSXRuntime;(0,o.registerBlockType)(l.name,{...l,edit:({attributes:e,setAttributes:o})=>{const s=e.serviceId||0,[l,d]=(0,a.useState)([]),[p,u]=(0,a.useState)(!0),[b,h]=(0,a.useState)("");(0,a.useEffect)(()=>{let e=!0;return u(!0),h(""),r()({path:"/bp/v1/services"}).then(o=>{if(!e)return;const t=o&&o.data?o.data:[];d(Array.isArray(t)?t:[])}).catch(o=>{e&&h(o?.message||"Failed to load services")}).finally(()=>{e&&u(!1)}),()=>{e=!1}},[]);const m=(0,a.useMemo)(()=>{const e=[{label:(0,n.__)("Select a service…","bookpoint"),value:"0"}],o=l.map(e=>({label:`${e.name} (${e.duration_minutes} min)`,value:String(e.id)}));return e.concat(o)},[l]),k=(0,a.useMemo)(()=>{const e=l.find(e=>Number(e.id)===Number(s));return e?e.name:""},[l,s]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(t.InspectorControls,{children:(0,c.jsxs)(i.PanelBody,{title:(0,n.__)("BookPoint Settings","bookpoint"),initialOpen:!0,children:[p&&(0,c.jsx)(i.Notice,{status:"info",isDismissible:!1,children:(0,n.__)("Loading services…","bookpoint")}),!!b&&(0,c.jsxs)(i.Notice,{status:"error",isDismissible:!1,children:[(0,n.__)("Could not load services:","bookpoint")," ",b]}),(0,c.jsx)(i.SelectControl,{label:(0,n.__)("Service","bookpoint"),value:String(s||0),options:m,onChange:e=>o({serviceId:parseInt(e||"0",10)||0}),help:(0,n.__)("Services are loaded from BookPoint → Services.","bookpoint")}),(0,c.jsx)(i.TextControl,{label:(0,n.__)("Default Date (YYYY-MM-DD)","bookpoint"),value:e.defaultDate||"",onChange:e=>o({defaultDate:e||""}),placeholder:"2026-01-19"}),(0,c.jsx)(i.ToggleControl,{label:(0,n.__)("Hide Notes Field","bookpoint"),checked:!!e.hideNotes,onChange:e=>o({hideNotes:!!e})}),(0,c.jsx)(i.ToggleControl,{label:(0,n.__)("Require Phone","bookpoint"),checked:!!e.requirePhone,onChange:e=>o({requirePhone:!!e})}),(0,c.jsx)(i.ToggleControl,{label:(0,n.__)("Compact Layout","bookpoint"),checked:!!e.compact,onChange:e=>o({compact:!!e})})]})}),(0,c.jsxs)("div",{style:{padding:"14px",border:"1px solid #ddd",borderRadius:"6px"},children:[(0,c.jsx)("strong",{children:(0,n.__)("BookPoint – Booking Form","bookpoint")}),s>0?(0,c.jsxs)("p",{style:{marginTop:"8px"},children:[(0,n.__)("This block will render the booking form for:","bookpoint")," ",(0,c.jsx)("code",{children:k||`#${s}`})]}):(0,c.jsx)(i.Notice,{status:"warning",isDismissible:!1,children:(0,n.__)("Please choose a service in the block settings.","bookpoint")})]})]})},save:()=>null})})();