(()=>{"use strict";var e={338(e,s,t){var a=t(795);s.H=a.createRoot,a.hydrateRoot},795(e){e.exports=window.ReactDOM}},s={};const t=window.React;var a=function t(a){var n=s[a];if(void 0!==n)return n.exports;var i=s[a]={exports:{}};return e[a](i,i.exports,t),i.exports}(338);async function n(e,s={}){var t;const a=window.BP_FRONT?.restUrl||"/wp-json/bp/v1",n=window.BP_FRONT?.nonce,i=await fetch(`${a}${e}`,{...s,headers:{"Content-Type":"application/json",...n?{"X-WP-Nonce":n}:{},...s.headers||{}}}),l=await i.json().catch(()=>({}));if(!i.ok||"error"===l?.status)throw new Error(l?.message||"Request failed");return null!==(t=l?.data)&&void 0!==t?t:l}const i=({service_id:e})=>n("/front/extras",{method:"POST",body:JSON.stringify({service_id:e})}),l=({service_id:e,location_id:s})=>n("/front/agents",{method:"POST",body:JSON.stringify({service_id:e,location_id:s})}),o=async()=>{const e=await n("/front/form-fields"),s=[],t=[],a=[];return(Array.isArray(e)?e:[]).forEach(e=>{const n=e.scope||"customer";"booking"===n?a.push(e):"form"===n?s.push(e):t.push(e)}),{form:s,customer:t,booking:a}},c=window.ReactJSXRuntime;function r({locations:e,value:s,onChange:a,onNext:n}){const[i,l]=(0,t.useState)(""),o=(0,t.useMemo)(()=>{const s=i.trim().toLowerCase();return s?e.filter(e=>(e.name||"").toLowerCase().includes(s)):e},[i,e]),r=!!s;return(0,c.jsxs)("div",{className:"bp-step",children:[(0,c.jsx)("div",{className:"bp-step-search",children:(0,c.jsx)("input",{value:i,onChange:e=>l(e.target.value),placeholder:"Search...",className:"bp-input"})}),(0,c.jsxs)("div",{className:"bp-list",children:[o.map(e=>(0,c.jsxs)("button",{type:"button",className:String(s)===String(e.id)?"bp-card active":"bp-card",onClick:()=>a(e.id),children:[(0,c.jsx)("div",{className:"bp-card-title",children:e.name}),(0,c.jsx)("div",{className:"bp-card-sub",children:e.address||""})]},e.id)),o.length?null:(0,c.jsx)("div",{className:"bp-empty",children:"No locations found."})]}),(0,c.jsxs)("div",{className:"bp-step-footer",children:[(0,c.jsx)("div",{}),(0,c.jsx)("button",{type:"button",className:"bp-next",disabled:!r,onClick:()=>n(),children:"Next ->"})]})]})}function d({categories:e,value:s,onChange:a,onBack:n,onNext:i}){const[l,o]=(0,t.useState)(""),r=(0,t.useMemo)(()=>{const s=l.trim().toLowerCase();return s?e.filter(e=>(e.name||"").toLowerCase().includes(s)):e},[l,e]),d=s.length>0;return(0,c.jsxs)("div",{className:"bp-step",children:[(0,c.jsx)("input",{value:l,onChange:e=>o(e.target.value),placeholder:"Search...",className:"bp-input"}),(0,c.jsxs)("div",{className:"bp-grid",children:[r.map(e=>{const t=s.some(s=>String(s)===String(e.id));return(0,c.jsx)("button",{type:"button",className:t?"bp-tile active":"bp-tile",onClick:()=>function(e){const t=String(e),n=s.some(e=>String(e)===t)?s.filter(e=>String(e)!==t):[...s,e];a(n)}(e.id),children:(0,c.jsx)("div",{className:"bp-tile-title",children:e.name})},e.id)}),r.length?null:(0,c.jsx)("div",{className:"bp-empty",children:"No categories found."})]}),(0,c.jsxs)("div",{className:"bp-step-footer",children:[(0,c.jsx)("button",{type:"button",className:"bp-back",onClick:n,children:"<- Back"}),(0,c.jsx)("button",{type:"button",className:"bp-next",disabled:!d,onClick:i,children:"Next ->"})]})]})}function m({services:e,value:s,onChange:t,onBack:a,onNext:n}){const i=!!s;return(0,c.jsxs)("div",{className:"bp-step",children:[(0,c.jsxs)("div",{className:"bp-grid",children:[e.map(e=>{const a=String(s)===String(e.id);return(0,c.jsxs)("button",{type:"button",className:a?"bp-tile active":"bp-tile",onClick:()=>t(e.id),children:[e.image_url?(0,c.jsx)("img",{className:"bp-tile-img",src:e.image_url,alt:""}):null,(0,c.jsx)("div",{className:"bp-tile-title",children:e.name}),(0,c.jsxs)("div",{className:"bp-tile-sub",children:[Number(e.price||0).toFixed(2)," â€¢ ",e.duration||0," min"]})]},e.id)}),e.length?null:(0,c.jsx)("div",{className:"bp-empty",children:"No services found."})]}),(0,c.jsxs)("div",{className:"bp-step-footer",children:[(0,c.jsx)("button",{type:"button",className:"bp-back",onClick:a,children:"<- Back"}),(0,c.jsx)("button",{type:"button",className:"bp-next",disabled:!i,onClick:n,children:"Next ->"})]})]})}function u({extras:e,value:s,onChange:t,onBack:a,onNext:n}){return(0,c.jsxs)("div",{className:"bp-step",children:[(0,c.jsxs)("div",{className:"bp-grid",children:[e.map(e=>{const a=s.some(s=>String(s)===String(e.id));return(0,c.jsxs)("button",{type:"button",className:a?"bp-tile active":"bp-tile",onClick:()=>function(e){const a=String(e),n=s.some(e=>String(e)===a)?s.filter(e=>String(e)!==a):[...s,e];t(n)}(e.id),children:[e.image_url?(0,c.jsx)("img",{className:"bp-tile-img",src:e.image_url,alt:""}):null,(0,c.jsx)("div",{className:"bp-tile-title",children:e.name}),(0,c.jsxs)("div",{className:"bp-tile-sub",children:["+ ",Number(e.price||0).toFixed(2)]})]},e.id)}),e.length?null:(0,c.jsx)("div",{className:"bp-empty",children:"No extras for this service."})]}),(0,c.jsxs)("div",{className:"bp-step-footer",children:[(0,c.jsx)("button",{type:"button",className:"bp-back",onClick:a,children:"<- Back"}),(0,c.jsx)("button",{type:"button",className:"bp-next",onClick:n,children:"Next ->"})]})]})}function p({agents:e,value:s,onChange:t,onBack:a,onNext:n}){const i=!!s;return(0,c.jsxs)("div",{className:"bp-step",children:[(0,c.jsxs)("div",{className:"bp-grid",children:[e.map(e=>{const a=String(s)===String(e.id);return(0,c.jsxs)("button",{type:"button",className:a?"bp-tile active":"bp-tile",onClick:()=>t(e.id),children:[e.image_url?(0,c.jsx)("img",{className:"bp-avatar",src:e.image_url,alt:""}):null,(0,c.jsx)("div",{className:"bp-tile-title",children:e.name||`#${e.id}`})]},e.id)}),e.length?null:(0,c.jsx)("div",{className:"bp-empty",children:"No agents available."})]}),(0,c.jsxs)("div",{className:"bp-step-footer",children:[(0,c.jsx)("button",{type:"button",className:"bp-back",onClick:a,children:"<- Back"}),(0,c.jsx)("button",{type:"button",className:"bp-next",disabled:!i,onClick:n,children:"Next ->"})]})]})}function b({date:e,onDateChange:s,slots:t,value:a,onSlotChange:n,onBack:i,onNext:l}){const o=!!e&&!!a;return(0,c.jsxs)("div",{className:"bp-step",children:[(0,c.jsxs)("div",{className:"bp-field",children:[(0,c.jsx)("label",{className:"bp-label",children:"Date"}),(0,c.jsx)("input",{type:"date",className:"bp-input",value:e||"",onChange:e=>s(e.target.value)})]}),(0,c.jsxs)("div",{className:"bp-field",children:[(0,c.jsx)("label",{className:"bp-label",children:"Time slots"}),(0,c.jsxs)("div",{className:"bp-slot-grid",children:[t.map(e=>{const s=a?.start_time===e.start_time;return(0,c.jsx)("button",{type:"button",className:s?"bp-slot-btn active":"bp-slot-btn",onClick:()=>n(e),children:e.label||e.start_time},e.start_time)}),t.length?null:(0,c.jsx)("div",{className:"bp-empty",children:"No available time slots."})]})]}),(0,c.jsxs)("div",{className:"bp-step-footer",children:[(0,c.jsx)("button",{type:"button",className:"bp-back",onClick:i,children:"<- Back"}),(0,c.jsx)("button",{type:"button",className:"bp-next",disabled:!o,onClick:l,children:"Next ->"})]})]})}function x(e,s){return"checkbox"===s?"1"!==e:null==e||(Array.isArray(e)?0===e.length:""===String(e).trim())}function h({formFields:e,answers:s,onChange:t,onBack:a,onNext:n,onError:i}){const l=[...e?.form||[],...e?.customer||[],...e?.booking||[]];function o(e){var t;return null!==(t=s?.[e])&&void 0!==t?t:""}return(0,c.jsxs)("div",{className:"bp-step",children:[(0,c.jsx)("div",{className:"bp-form",children:l.map(e=>{const s=e.field_key||e.name_key||"",a=`${e.scope}.${s}`,n=o(a);return(0,c.jsxs)("div",{className:"bp-field",children:[(0,c.jsxs)("label",{className:"bp-label",children:[e.label," ",e.is_required?(0,c.jsx)("span",{className:"bp-required",children:"*"}):null]}),(0,c.jsx)(v,{field:e,value:n,onChange:e=>function(e,s){t(t=>({...t,[e]:s}))}(a,e)})]},a)})}),(0,c.jsxs)("div",{className:"bp-step-footer",children:[(0,c.jsx)("button",{type:"button",className:"bp-back",onClick:a,children:"<- Back"}),(0,c.jsx)("button",{type:"button",className:"bp-next",onClick:function(){for(const e of l){if(!e.is_required)continue;const s=e.field_key||e.name_key||"";if(x(o(`${e.scope}.${s}`),e.type))return void i?.(`${e.label||s} is required`)}i?.(""),n()},children:"Next ->"})]})]})}function v({field:e,value:s,onChange:t}){const a={className:"bp-input",placeholder:e.placeholder||"",value:s||"",onChange:e=>t(e.target.value)};if("textarea"===e.type)return(0,c.jsx)("textarea",{className:"bp-input bp-textarea",rows:4,placeholder:e.placeholder||"",value:s||"",onChange:e=>t(e.target.value)});if("select"===e.type){const a=e.options?.choices||[];return(0,c.jsxs)("select",{className:"bp-input",value:s||"",onChange:e=>t(e.target.value),children:[(0,c.jsx)("option",{value:"",children:"Select..."}),a.map((e,s)=>(0,c.jsx)("option",{value:e.value,children:e.label},s))]})}if("checkbox"===e.type){const a="1"===s||!0===s;return(0,c.jsxs)("label",{className:"bp-checkbox",children:[(0,c.jsx)("input",{type:"checkbox",checked:a,onChange:e=>t(e.target.checked?"1":"0")}),(0,c.jsx)("span",{children:e.placeholder||"Yes"})]})}let n="text";return"email"===e.type&&(n="email"),"tel"===e.type&&(n="tel"),"number"===e.type&&(n="number"),"date"===e.type&&(n="date"),(0,c.jsx)("input",{...a,type:n})}function g({locationId:e,categoryIds:s,serviceId:a,extraIds:n,agentId:i,date:l,slot:o,locations:r,categories:d,services:m,extras:u,agents:p,formFields:b,answers:x,onBack:h,onSubmit:v,loading:g}){const j=r.find(s=>String(s.id)===String(e)),y=m.find(e=>String(e.id)===String(a)),f=p.find(e=>String(e.id)===String(i)),k=d.filter(e=>s.includes(e.id)||s.includes(String(e.id))),S=u.filter(e=>n.includes(e.id)||n.includes(String(e.id))),C=(0,t.useMemo)(()=>[...b?.form||[],...b?.customer||[],...b?.booking||[]],[b]);return(0,c.jsxs)("div",{className:"bp-step",children:[(0,c.jsxs)("div",{className:"bp-review",children:[(0,c.jsx)(N,{label:"Location",value:j?.name}),(0,c.jsx)(N,{label:"Categories",value:k.length?k.map(e=>e.name).join(", "):"-"}),(0,c.jsx)(N,{label:"Service",value:y?.name}),(0,c.jsx)(N,{label:"Agent",value:f?.name}),(0,c.jsx)(N,{label:"Date",value:l}),(0,c.jsx)(N,{label:"Time",value:o?.start_time?`${o.start_time} - ${o.end_time}`:"-"}),(0,c.jsx)(N,{label:"Extras",value:S.length?S.map(e=>e.name).join(", "):"-"}),(0,c.jsx)("div",{className:"bp-review-section",children:"Customer Information"}),C.map(e=>{var s;const t=e.field_key||e.name_key||"",a=`${e.scope}.${t}`;let n=null!==(s=x?.[a])&&void 0!==s?s:"";return"checkbox"===e.type&&(n="1"===n?"Yes":"No"),(0,c.jsx)(N,{label:e.label,value:String(n||"")},a)})]}),(0,c.jsxs)("div",{className:"bp-step-footer",children:[(0,c.jsx)("button",{type:"button",className:"bp-back",onClick:h,children:"<- Back"}),(0,c.jsx)("button",{type:"button",className:"bp-next",disabled:g,onClick:v,children:g?"Submitting...":"Confirm Booking"})]})]})}function N({label:e,value:s}){return(0,c.jsxs)("div",{className:"bp-review-row",children:[(0,c.jsx)("div",{className:"k",children:e}),(0,c.jsx)("div",{className:"v",children:s||"-"})]})}function j({booking:e,onClose:s}){return(0,c.jsx)("div",{className:"bp-step bp-done",children:(0,c.jsxs)("div",{className:"bp-done-card",children:[(0,c.jsx)("div",{className:"bp-done-title",children:"Booking confirmed"}),e?.booking_id?(0,c.jsxs)("div",{className:"bp-done-sub",children:["Booking ID: ",e.booking_id]}):null,e?.manage_url?(0,c.jsx)("a",{className:"bp-done-link",href:e.manage_url,target:"_blank",rel:"noreferrer",children:"Manage your booking"}):null,(0,c.jsx)("div",{className:"bp-done-actions",children:(0,c.jsx)("button",{type:"button",className:"bp-next",onClick:s,children:"Close"})})]})})}const y=[{key:"location",title:"Location Selection",icon:"location-image.png"},{key:"category",title:"Choose Category",icon:"service-image.png"},{key:"service",title:"Choose Service",icon:"service-image.png"},{key:"extras",title:"Service Extras",icon:"service-image.png"},{key:"agent",title:"Choose Agent",icon:"default-avatar.jpg"},{key:"datetime",title:"Choose Date & Time",icon:"blue-dot.png"},{key:"customer",title:"Customer Information",icon:"default-avatar.jpg"},{key:"review",title:"Review Order",icon:"white-curve.png"},{key:"done",title:"Done",icon:"logo.png"}];function f({open:e,onClose:s,brand:a}){const[x,v]=(0,t.useState)(0),[N,f]=(0,t.useState)(null),[S,C]=(0,t.useState)([]),[_,w]=(0,t.useState)(null),[B,I]=(0,t.useState)([]),[O,E]=(0,t.useState)(null),[$,P]=(0,t.useState)(null),[T,L]=(0,t.useState)(null),[F,R]=(0,t.useState)({form:[],customer:[],booking:[]}),[D,M]=(0,t.useState)({}),[A,q]=(0,t.useState)([]),[J,H]=(0,t.useState)([]),[X,Y]=(0,t.useState)([]),[z,U]=(0,t.useState)([]),[W,G]=(0,t.useState)([]),[K,Q]=(0,t.useState)([]),[V,Z]=(0,t.useState)(!1),[ee,se]=(0,t.useState)(""),te=y[x],ae=(0,t.useMemo)(()=>a?.imagesBase?a.imagesBase+te.icon:"",[a,te]);function ne(){se(""),v(e=>Math.min(e+1,y.length-1))}function ie(){se(""),v(e=>Math.max(e-1,0))}return(0,t.useEffect)(()=>{if(e)return document.body.classList.add("bp-modal-open"),()=>document.body.classList.remove("bp-modal-open")},[e]),(0,t.useEffect)(()=>{e&&(v(0),se(""),f(null),C([]),w(null),I([]),E(null),P(null),L(null),M({}))},[e]),(0,t.useEffect)(()=>{e&&(async()=>{try{Z(!0);const[e,s,t]=await Promise.all([n("/front/locations"),n("/front/categories"),o()]);q(e),H(s),R(t)}catch(e){se(e?.message||"Failed to load booking data.")}finally{Z(!1)}})()},[e]),(0,t.useEffect)(()=>{e&&(async()=>{try{if("service"===te.key||"extras"===te.key||"agent"===te.key||"datetime"===te.key||"review"===te.key){const e=await(({category_ids:e=[],location_id:s=null})=>n("/front/services",{method:"POST",body:JSON.stringify({category_ids:e,location_id:s})}))({category_ids:S,location_id:N});Y(e)}}catch(e){Y([])}})()},[e,te.key,S,N]),(0,t.useEffect)(()=>{e&&(async()=>{try{if(!_)return;const[e,s]=await Promise.all([i({service_id:_}),l({service_id:_,location_id:N})]);U(e),G(s)}catch(e){U([]),G([])}})()},[e,_,N]),(0,t.useEffect)(()=>{e&&(async()=>{try{if(!_||!O||!$)return;const e=await(({service_id:e,agent_id:s,date:t})=>n("/front/slots",{method:"POST",body:JSON.stringify({service_id:e,agent_id:s,date:t})}))({service_id:_,agent_id:O,date:$});Q(e)}catch(e){Q([])}})()},[e,_,O,$]),e?(0,c.jsx)("div",{className:"bp-modal-overlay",role:"dialog","aria-modal":"true",children:(0,c.jsxs)("div",{className:"bp-modal",children:[(0,c.jsx)("button",{className:"bp-modal-close",onClick:s,"aria-label":"Close",children:"x"}),(0,c.jsxs)("div",{className:"bp-modal-grid",children:[(0,c.jsxs)("aside",{className:"bp-side",children:[(0,c.jsx)("div",{className:"bp-side-icon",children:ae?(0,c.jsx)("img",{src:ae,alt:""}):null}),(0,c.jsx)("h3",{className:"bp-side-title",children:te.title}),(0,c.jsx)("p",{className:"bp-side-desc",children:"Please complete the steps to schedule your booking."}),(0,c.jsxs)("div",{className:"bp-side-help",children:[(0,c.jsx)("div",{children:"Need help?"}),(0,c.jsx)("div",{className:"bp-help-phone",children:a?.helpPhone})]})]}),(0,c.jsxs)("main",{className:"bp-main",children:[(0,c.jsxs)("div",{className:"bp-main-head",children:[(0,c.jsx)("h2",{children:te.title}),(0,c.jsx)("div",{className:"bp-step-dots",children:y.slice(0,8).map((e,s)=>(0,c.jsx)("span",{className:s===x?"bp-dot active":"bp-dot"},e.key))})]}),ee?(0,c.jsx)("div",{className:"bp-error",children:ee}):null,V?(0,c.jsx)("div",{className:"bp-loading",children:"Loading..."}):null,"location"===te.key&&(0,c.jsx)(r,{locations:A,value:N,onChange:f,onNext:ne}),"category"===te.key&&(0,c.jsx)(d,{categories:J,value:S,onChange:C,onBack:ie,onNext:ne}),"service"===te.key&&(0,c.jsx)(m,{services:X,value:_,onChange:w,onBack:ie,onNext:ne}),"extras"===te.key&&(0,c.jsx)(u,{extras:z,value:B,onChange:I,onBack:ie,onNext:ne}),"agent"===te.key&&(0,c.jsx)(p,{agents:W,value:O,onChange:E,onBack:ie,onNext:ne}),"datetime"===te.key&&(0,c.jsx)(b,{date:$,onDateChange:P,slots:K,value:T,onSlotChange:L,onBack:ie,onNext:ne}),"customer"===te.key&&(0,c.jsx)(h,{formFields:F,answers:D,onChange:M,onBack:ie,onNext:ne,onError:se}),"review"===te.key&&(0,c.jsx)(g,{locationId:N,categoryIds:S,serviceId:_,extraIds:B,agentId:O,date:$,slot:T,locations:A,categories:J,services:X,extras:z,agents:W,formFields:F,answers:D,onBack:ie,onSubmit:async function(){try{Z(!0),se("");const e={location_id:N,category_ids:S,service_id:_,extra_ids:B,agent_id:O,date:$,start_time:T?.start_time||T?.start||"",end_time:T?.end_time||T?.end||"",field_values:D,extras:B},s=await(e=>n("/front/bookings",{method:"POST",body:JSON.stringify(e)}))(e);M(e=>({...e,__booking:s})),v(y.findIndex(e=>"done"===e.key))}catch(e){se(e?.message||"Could not submit booking.")}finally{Z(!1)}},loading:V}),"done"===te.key&&(0,c.jsx)(j,{booking:D.__booking,onClose:s})]}),(0,c.jsxs)("aside",{className:"bp-summary",children:[(0,c.jsx)("div",{className:"bp-summary-title",children:"Summary"}),(0,c.jsx)("div",{className:"bp-summary-box",children:(0,c.jsx)(k,{locations:A,categories:J,services:X,extras:z,agents:W,locationId:N,categoryIds:S,serviceId:_,extraIds:B,agentId:O,date:$,slot:T})})]})]})]})}):null}function k(e){const{locations:s,categories:t,services:a,extras:n,agents:i,locationId:l,categoryIds:o,serviceId:r,extraIds:d,agentId:m,date:u,slot:p}=e,b=s.find(e=>String(e.id)===String(l)),x=a.find(e=>String(e.id)===String(r)),h=i.find(e=>String(e.id)===String(m)),v=n.filter(e=>d.includes(e.id)||d.includes(String(e.id))),g=t.filter(e=>o.includes(e.id)||o.includes(String(e.id)));return(0,c.jsxs)("div",{className:"bp-summary-items",children:[(0,c.jsxs)("div",{className:"bp-summary-row",children:[(0,c.jsx)("div",{className:"k",children:"Location"}),(0,c.jsx)("div",{className:"v",children:b?.name||"-"})]}),(0,c.jsxs)("div",{className:"bp-summary-row",children:[(0,c.jsx)("div",{className:"k",children:"Category"}),(0,c.jsx)("div",{className:"v",children:g.length?g.map(e=>e.name).join(", "):"-"})]}),(0,c.jsxs)("div",{className:"bp-summary-row",children:[(0,c.jsx)("div",{className:"k",children:"Service"}),(0,c.jsx)("div",{className:"v",children:x?.name||"-"})]}),(0,c.jsxs)("div",{className:"bp-summary-row",children:[(0,c.jsx)("div",{className:"k",children:"Agent"}),(0,c.jsx)("div",{className:"v",children:h?.name||"-"})]}),(0,c.jsxs)("div",{className:"bp-summary-row",children:[(0,c.jsx)("div",{className:"k",children:"Date"}),(0,c.jsx)("div",{className:"v",children:u||"-"})]}),(0,c.jsxs)("div",{className:"bp-summary-row",children:[(0,c.jsx)("div",{className:"k",children:"Time"}),(0,c.jsx)("div",{className:"v",children:p?.start_time?`${p.start_time} - ${p.end_time}`:"-"})]}),(0,c.jsxs)("div",{className:"bp-summary-row",children:[(0,c.jsx)("div",{className:"k",children:"Extras"}),(0,c.jsx)("div",{className:"v",children:v.length?v.map(e=>e.name).join(", "):"-"})]})]})}function S({label:e}){const[s,a]=(0,t.useState)(!1),n=(window.BP_FRONT?.images||"").replace(/\/$/,"")+"/",i=(0,t.useMemo)(()=>({imagesBase:n,helpPhone:"+45 91 67 14 52"}),[n]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("button",{className:"bp-book-btn",type:"button",onClick:()=>a(!0),children:e||"Book Now"}),(0,c.jsx)(f,{open:s,onClose:()=>a(!1),brand:i})]})}document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".bp-front-root[data-bp-widget='wizard']").forEach(e=>{const s=(0,a.H)(e),t=e.getAttribute("data-bp-label")||"Book Now";s.render((0,c.jsx)(S,{label:t}))})})})();