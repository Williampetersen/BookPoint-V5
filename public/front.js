(()=>{var e={338(e,t,n){"use strict";var r=n(795);t.H=r.createRoot,r.hydrateRoot},556(e,t,n){e.exports=n(694)()},694(e,t,n){"use strict";var r=n(925);function a(){}function s(){}s.resetWarningCache=a,e.exports=function(){function e(e,t,n,a,s,i){if(i!==r){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:s,resetWarningCache:a};return n.PropTypes=n,n}},795(e){"use strict";e.exports=window.ReactDOM},925(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}(()=>{"use strict";const e=window.React;var t=n(338);async function r(e,t={}){var n;const r=window.BP_FRONT?.restUrl||"/wp-json/bp/v1",a=window.BP_FRONT?.nonce,s=await fetch(`${r}${e}`,{...t,headers:{"Content-Type":"application/json",...a?{"X-WP-Nonce":a}:{},...t.headers||{}}}),i=await s.json().catch(()=>({}));if(!s.ok||"error"===i?.status)throw new Error(i?.message||"Request failed");return null!==(n=i?.data)&&void 0!==n?n:i}const a=({service_id:e})=>r("/front/extras",{method:"POST",body:JSON.stringify({service_id:e})}),s=({service_id:e,location_id:t})=>r("/front/agents",{method:"POST",body:JSON.stringify({service_id:e,location_id:t})}),i=async()=>{const e=await r("/front/form-fields/active");if(e&&e.form&&e.customer&&e.booking)return e;const t=await r("/front/form-fields"),n=[],a=[],s=[];return(Array.isArray(t)?t:[]).forEach(e=>{const t=e.scope||"customer";"booking"===t?s.push(e):"form"===t?n.push(e):a.push(e)}),{form:n,customer:a,booking:s}};function o(e,t){const n=(window.BP_FRONT?.images||"").replace(/\/$/,"")+"/";return e?.image_url||e?.image||""||n+t}const c=window.ReactJSXRuntime;function l({locations:e,value:t,onChange:n,onNext:r,nextLabel:a="Next ->"}){const s=e||[],i=!!t;return(0,c.jsxs)("div",{className:"bp-step",children:[(0,c.jsxs)("div",{className:"bp-list",children:[s.map(e=>(0,c.jsx)("button",{type:"button",className:String(t)===String(e.id)?"bp-card active":"bp-card",onClick:()=>n(e.id),children:(0,c.jsxs)("div",{className:"bp-card-row",children:[(0,c.jsx)("img",{className:"bp-card-thumb",src:o(e,"location-image.png"),alt:""}),(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{className:"bp-card-title",children:e.name}),(0,c.jsx)("div",{className:"bp-card-sub",children:e.address||""})]})]})},e.id)),s.length?null:(0,c.jsx)("div",{className:"bp-empty",children:"No locations found."})]}),(0,c.jsxs)("div",{className:"bp-step-footer",children:[(0,c.jsx)("div",{}),(0,c.jsx)("button",{type:"button",className:"bp-next",disabled:!i,onClick:()=>r(),children:a})]})]})}function d({categories:e,value:t,onChange:n,onBack:r,onNext:a,backLabel:s="<- Back",nextLabel:i="Next ->"}){const l=e||[],d=(t||[]).length>0;return(0,c.jsxs)("div",{className:"bp-step",children:[(0,c.jsxs)("div",{className:"bp-list",children:[l.map(e=>{const r=(t||[]).some(t=>String(t)===String(e.id));return(0,c.jsx)("button",{type:"button",className:r?"bp-card active":"bp-card",onClick:()=>{return t=e.id,void n([t]);var t},children:(0,c.jsxs)("div",{className:"bp-card-row",children:[(0,c.jsx)("img",{className:"bp-card-thumb",src:o(e,"service-image.png"),alt:""}),(0,c.jsx)("div",{className:"bp-card-title",children:e.name})]})},e.id)}),l.length?null:(0,c.jsx)("div",{className:"bp-empty",children:"No categories found."})]}),(0,c.jsxs)("div",{className:"bp-step-footer",children:[(0,c.jsx)("button",{type:"button",className:"bp-back",onClick:r,children:s}),(0,c.jsx)("button",{type:"button",className:"bp-next",disabled:!d,onClick:a,children:i})]})]})}function u(e){const t=String(e||"").trim();if(!t)return"";const n=t.match(/[A-Za-z]{3}/);return(n?n[0]:t).toUpperCase()}function p(e,t={}){if(null==e)return"-";const n=Number(e);if(!Number.isFinite(n))return"-";const r=u(t.currency)||u(t.bp_default_currency)||u("undefined"!=typeof window?window.BP_FRONT?.currency:"")||"USD",a="after"===(t.currency_position||t.bp_currency_position||"before")?"after":"before",s=function(e){const t=u(e)||"USD";try{const e=new Intl.NumberFormat(void 0,{style:"currency",currency:t,currencyDisplay:"narrowSymbol"}).formatToParts(0).find(e=>"currency"===e.type);return e?.value||t}catch(e){return{USD:"$",EUR:"€",GBP:"£",DKK:"Kr",NOK:"Kr",SEK:"Kr",ISK:"Kr",CAD:"$",AUD:"$"}[t]||t}}(r),i=n.toLocaleString(void 0,{minimumFractionDigits:n%1==0?0:2,maximumFractionDigits:2}),o=/^[A-Z]{2,5}$/.test(s);return"after"===a?o?`${i} ${s}`:`${i}${s}`:o?`${s} ${i}`:`${s}${i}`}function m({services:e,value:t,onChange:n,onBack:r,onNext:a,settings:s,backLabel:i="<- Back",nextLabel:l="Next ->"}){const d=e||[],u=!!t;return(0,c.jsxs)("div",{className:"bp-step",children:[(0,c.jsxs)("div",{className:"bp-cardlist",children:[d.map(e=>{const r=String(t)===String(e.id);return(0,c.jsxs)("button",{type:"button",className:r?"bp-pickcard active":"bp-pickcard",onClick:()=>n(e.id),children:[(0,c.jsx)("div",{className:"bp-pickcard-left",children:(0,c.jsx)("img",{className:"bp-thumb",src:o(e,"service-image.png"),alt:""})}),(0,c.jsxs)("div",{className:"bp-pickcard-mid",children:[(0,c.jsx)("div",{className:"bp-pickcard-title",children:e.name}),!!e.description&&(0,c.jsx)("div",{className:"bp-pickcard-sub",children:e.description}),(0,c.jsxs)("div",{className:"bp-meta",children:[!!e.duration&&(0,c.jsxs)("span",{className:"bp-chip",children:[e.duration," min"]}),!!e.category_name&&(0,c.jsx)("span",{className:"bp-chip ghost",children:e.category_name})]})]}),(0,c.jsxs)("div",{className:"bp-pickcard-right",children:[(0,c.jsx)("div",{className:"bp-price",children:null!=e.price?(0,c.jsx)("span",{className:"bp-price-line",children:p(e.price,s)}):(0,c.jsx)("span",{className:"bp-price-cur",children:"Select"})}),(0,c.jsx)("div",{className:r?"bp-radio on":"bp-radio"})]})]},e.id)}),d.length?null:(0,c.jsx)("div",{className:"bp-empty",children:"No services found."})]}),(0,c.jsxs)("div",{className:"bp-step-footer",children:[(0,c.jsx)("button",{type:"button",className:"bp-back",onClick:r,children:i}),(0,c.jsx)("button",{type:"button",className:"bp-next",disabled:!u,onClick:a,children:l})]})]})}function b({extras:e,value:t,onChange:n,onBack:r,onNext:a,settings:s,backLabel:i="<- Back",nextLabel:l="Next ->"}){const d=e||[];return(0,c.jsxs)("div",{className:"bp-step",children:[(0,c.jsxs)("div",{className:"bp-cardlist",children:[d.map(e=>{const r=(t||[]).some(t=>String(t)===String(e.id));return(0,c.jsxs)("button",{type:"button",className:r?"bp-pickcard active":"bp-pickcard",onClick:()=>function(e){const r=String(e),a=(t||[]).some(e=>String(e)===r)?(t||[]).filter(e=>String(e)!==r):[...t||[],e];n(a)}(e.id),children:[(0,c.jsx)("div",{className:"bp-pickcard-left",children:(0,c.jsx)("img",{className:"bp-thumb",src:o(e,"service-image.png"),alt:""})}),(0,c.jsxs)("div",{className:"bp-pickcard-mid",children:[(0,c.jsx)("div",{className:"bp-pickcard-title",children:e.name}),(e.description||e.desc||e.summary)&&(0,c.jsx)("div",{className:"bp-pickcard-sub",children:e.description||e.desc||e.summary})]}),(0,c.jsxs)("div",{className:"bp-pickcard-right",children:[(0,c.jsx)("div",{className:"bp-price",children:null!=e.price?(0,c.jsx)("span",{className:"bp-price-line",children:p(e.price,s)}):(0,c.jsx)("span",{className:"bp-price-cur",children:"Extra"})}),(0,c.jsx)("div",{className:r?"bp-check on":"bp-check"})]})]},e.id)}),d.length?null:(0,c.jsx)("div",{className:"bp-empty",children:"No extras for this service."})]}),(0,c.jsxs)("div",{className:"bp-step-footer",children:[(0,c.jsx)("button",{type:"button",className:"bp-back",onClick:r,children:i}),(0,c.jsx)("button",{type:"button",className:"bp-next",disabled:!1,onClick:a,children:l})]})]})}function f({agents:e,value:t,onChange:n,onBack:r,onNext:a,backLabel:s="<- Back",nextLabel:i="Next ->"}){const l=e||[],d=!!t;return(0,c.jsxs)("div",{className:"bp-step",children:[(0,c.jsxs)("div",{className:"bp-cardlist",children:[l.map(e=>{const r=String(t)===String(e.id);return(0,c.jsxs)("button",{type:"button",className:r?"bp-pickcard active":"bp-pickcard",onClick:()=>n(e.id),children:[(0,c.jsx)("div",{className:"bp-pickcard-left",children:(0,c.jsx)("img",{className:"bp-avatar",src:o(e,"default-avatar.jpg"),alt:""})}),(0,c.jsxs)("div",{className:"bp-pickcard-mid",children:[(0,c.jsx)("div",{className:"bp-pickcard-title",children:e.name}),!!e.title&&(0,c.jsx)("div",{className:"bp-pickcard-sub",children:e.title}),!!e.email&&(0,c.jsx)("div",{className:"bp-pickcard-sub small",children:e.email})]}),(0,c.jsx)("div",{className:"bp-pickcard-right",children:(0,c.jsx)("div",{className:r?"bp-radio on":"bp-radio"})})]},e.id)}),l.length?null:(0,c.jsx)("div",{className:"bp-empty",children:"No agents available for this service."})]}),(0,c.jsxs)("div",{className:"bp-step-footer",children:[(0,c.jsx)("button",{type:"button",className:"bp-back",onClick:r,children:s}),(0,c.jsx)("button",{type:"button",className:"bp-next",disabled:!d,onClick:a,children:i})]})]})}const h=(e,t,n)=>new Date(Date.UTC(e,t,n,12,0,0)),g=e=>`${e.getUTCFullYear()}-${String(e.getUTCMonth()+1).padStart(2,"0")}-${String(e.getUTCDate()).padStart(2,"0")}`,y=(e,t)=>h(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()+t),v=e=>{const t=new Date,n=h(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate());return e.getTime()<n.getTime()};async function x(e,t,{signal:n}={}){const r=window.BP_FRONT?.restUrl||"/wp-json/bp/v1",a=window.BP_FRONT?.nonce,s=await fetch(`${r}${e}`,{method:"POST",headers:{"Content-Type":"application/json",...a?{"X-WP-Nonce":a}:{}},body:JSON.stringify(t),signal:n,credentials:"same-origin"}),i=await s.text();let o;try{o=JSON.parse(i)}catch(e){o={ok:!1,raw:i}}if(!s.ok){const e=o?.message||o?.raw||`HTTP ${s.status}`;throw new Error(e)}return o}function j({serviceId:t,agentId:n,locationId:r,valueDate:a,valueSlot:s,onChangeDate:i,onChangeSlot:o,onBack:l,onNext:d,backLabel:u="<- Back",nextLabel:p="Next ->"}){const[m,b]=(0,e.useState)(()=>{const e=new Date;return h(e.getUTCFullYear(),e.getUTCMonth(),1)}),[f,j]=(0,e.useState)(a||null),[k,N]=(0,e.useState)([]),[w,S]=(0,e.useState)(!1),[_,C]=(0,e.useState)([]),[P,E]=(0,e.useState)(!1),[O,T]=(0,e.useState)(""),L=(0,e.useRef)(new Map),B=(0,e.useRef)(new Map),I=(0,e.useRef)(null),$=(0,e.useRef)(null),R=(0,e.useMemo)(()=>{var e;return`${m.getUTCFullYear()}-${e=m.getUTCMonth()+1,String(e).padStart(2,"0")}`},[m]),M=(0,e.useMemo)(()=>({service_id:t,agent_id:n,location_id:r,month:R}),[t,n,r,R]);(0,e.useEffect)(()=>{if(!t||!n)return;const e=JSON.stringify(M);if(L.current.has(e))return void N(L.current.get(e));I.current&&I.current.abort();const r=new AbortController;I.current=r,S(!0),x("/front/availability/month",M,{signal:r.signal}).then(t=>{const n=t?.data?.days||[];L.current.set(e,n),N(n)}).catch(()=>{}).finally(()=>S(!1))},[M,t,n]),(0,e.useEffect)(()=>{a&&a!==f&&j(a)},[a]);const U=(0,e.useMemo)(()=>({service_id:t,agent_id:n,location_id:r,date:f}),[t,n,r,f]);(0,e.useEffect)(()=>{if(!f||!t||!n)return;const e=JSON.stringify(U);if(B.current.has(e))return void C(B.current.get(e));$.current&&$.current.abort();const r=new AbortController;$.current=r,E(!0),C([]),T(""),x("/front/availability/day",U,{signal:r.signal}).then(t=>{const n=t?.slots||[];B.current.set(e,n),C(n)}).catch(e=>{"AbortError"!==e.name&&(C([]),T("No available times for this date."))}).finally(()=>E(!1))},[U,f,t,n]);const A=(0,e.useMemo)(()=>{const e=new Map;return k.forEach(t=>e.set(t.date,t)),e},[k]),F=(0,e.useMemo)(()=>(e=>{const t=h((n=e).getUTCFullYear(),n.getUTCMonth(),1);var n;const r=(e=>(e.getUTCDay()+6)%7)(t),a=y(t,-r);return Array.from({length:42},(e,t)=>y(a,t))})(m),[m]),D=!!f&&!!s?.start_time;return(0,c.jsxs)("div",{className:"bp-step bp-datetime",children:[(0,c.jsxs)("div",{className:"bp-calendar",children:[(0,c.jsxs)("div",{className:"bp-cal-header",children:[(0,c.jsx)("button",{type:"button",className:"bp-cal-nav",onClick:()=>b(e=>h(e.getUTCFullYear(),e.getUTCMonth()-1,1)),children:"<"}),(0,c.jsx)("div",{className:"bp-cal-title",children:m.toLocaleString(void 0,{month:"long",year:"numeric",timeZone:"UTC"})}),(0,c.jsx)("button",{type:"button",className:"bp-cal-nav",onClick:()=>b(e=>h(e.getUTCFullYear(),e.getUTCMonth()+1,1)),children:">"})]}),(0,c.jsx)("div",{className:"bp-cal-weekdays",children:["M","T","W","T","F","S","S"].map(e=>(0,c.jsx)("div",{className:"bp-cal-wd",children:e},e))}),(0,c.jsx)("div",{className:"bp-cal-grid",children:F.map((e,t)=>{const n=(a=m,(r=e).getUTCFullYear()===a.getUTCFullYear()&&r.getUTCMonth()===a.getUTCMonth());var r,a;const s=v(e)||!n,l=g(e),d=f===l,u=A.get(l),p=!!u&&u.has_slots;return(0,c.jsxs)("button",{type:"button",className:`bp-cal-day ${n?"":"is-out"} ${d?"is-selected":""}`,disabled:s,onClick:()=>function(e){if(v(e))return;const t=g(e);o?.(null),i?.(t)}(e),children:[(0,c.jsx)("div",{children:e.getUTCDate()}),(0,c.jsx)("div",{style:{height:4,width:28,borderRadius:999,margin:"6px auto 0",background:p?"#22c55e":"#e5e7eb",opacity:w&&!u?.3:1}})]},`${l}-${t}`)})})]}),(0,c.jsxs)("div",{className:"bp-slots",children:[(0,c.jsxs)("div",{className:"bp-slots-title",children:["Pick a slot for ",(0,c.jsx)("strong",{children:f||"—"})]}),!f&&(0,c.jsx)("div",{className:"bp-muted",children:"Select a date to see available times."}),f&&P&&(0,c.jsxs)("div",{className:"bp-slot-skeleton",children:[(0,c.jsx)("div",{className:"bp-skel"}),(0,c.jsx)("div",{className:"bp-skel"}),(0,c.jsx)("div",{className:"bp-skel"})]}),f&&!P&&O&&(0,c.jsx)("div",{className:"bp-error",children:O}),f&&!P&&!O&&(0,c.jsxs)("div",{className:"bp-slot-grid",children:[_.map((e,t)=>(0,c.jsx)("button",{type:"button",className:"bp-slot "+(s?.start_time===e.time?"is-selected":""),onClick:()=>o?.({start_time:e.time,end_time:e.end||""}),children:e.time},`${e.time}-${t}`)),0===_.length&&(0,c.jsx)("div",{className:"bp-muted",children:"No times found for this date."})]})]}),(0,c.jsxs)("div",{className:"bp-step-footer",children:[(0,c.jsx)("button",{type:"button",className:"bp-back",onClick:l,children:u}),(0,c.jsx)("button",{type:"button",className:"bp-next",disabled:!D,onClick:d,children:p})]})]})}function k(e){return e?.id||e?.field_key||e?.name_key||""}function N(e){var t,n;return e&&"object"==typeof e?null!==(t=null!==(n=e.label)&&void 0!==n?n:e.value)&&void 0!==t?t:"":String(e)}function w(e){var t,n;return e&&"object"==typeof e?null!==(t=null!==(n=e.value)&&void 0!==n?n:e.label)&&void 0!==t?t:"":String(e)}function S({defs:e=[],layout:t=[],values:n,onChange:r,scope:a}){const s=t.map(t=>({layout:t,def:e.find(e=>k(e)===t.id)})).filter(e=>!!e.def),i=(e,t)=>{const s=a?`${a}.${e}`:e;r({...n||{},[s]:t})};return(0,c.jsx)("div",{className:"bp-fields-grid",children:s.map(({layout:e,def:t})=>{var r,s,o;const l=k(t),d=null!==(r=e.required)&&void 0!==r?r:!!(null!==(s=t.is_required)&&void 0!==s?s:t.required),u="half"===e.width?"half":"full",p=a?`${a}.${l}`:l,m=null!==(o=(n||{})[p])&&void 0!==o?o:"",b=(0,c.jsxs)("label",{className:"bp-label",children:[t.label," ",d?(0,c.jsx)("span",{className:"bp-req",children:"*"}):null]});if("textarea"===t.type)return(0,c.jsxs)("div",{className:`bp-field bp-${u}`,children:[b,(0,c.jsx)("textarea",{className:"bp-textarea",placeholder:t.placeholder||"",value:m,onChange:e=>i(l,e.target.value)})]},p);if("select"===t.type){const e=Array.isArray(t.options)?t.options:t.options?.choices||[];return(0,c.jsxs)("div",{className:`bp-field bp-${u}`,children:[b,(0,c.jsxs)("select",{className:"bp-select",value:m,onChange:e=>i(l,e.target.value),children:[(0,c.jsx)("option",{value:"",children:"Select…"}),e.map((e,t)=>(0,c.jsx)("option",{value:w(e),children:N(e)},t))]})]},p)}return"checkbox"===t.type?(0,c.jsx)("div",{className:`bp-field bp-${u}`,children:(0,c.jsxs)("label",{className:"bp-checkbox-row",children:[(0,c.jsx)("input",{type:"checkbox",checked:!!m,onChange:e=>i(l,e.target.checked)}),(0,c.jsxs)("span",{children:[t.label," ",d?(0,c.jsx)("span",{className:"bp-req",children:"*"}):null]})]})},p):"date"===t.type?(0,c.jsxs)("div",{className:`bp-field bp-${u}`,children:[b,(0,c.jsx)("input",{className:"bp-input-field",type:"date",value:m,onChange:e=>i(l,e.target.value)})]},p):(0,c.jsxs)("div",{className:`bp-field bp-${u}`,children:[b,(0,c.jsx)("input",{className:"bp-input-field",type:"tel"===t.type?"tel":"email"===t.type?"email":"text",placeholder:t.placeholder||"",value:m,onChange:e=>i(l,e.target.value)})]},p)})})}function _(e,t){return"checkbox"===t?!e:null==e||(Array.isArray(e)?0===e.length:""===String(e).trim())}function C(e){return e?.id||e?.field_key||e?.name_key||""}function P(e=[]){return e.map(e=>{var t,n;return{id:C(e),required:!(null===(t=null!==(n=e?.is_required)&&void 0!==n?n:e?.required)||void 0===t||!t),width:"full"}}).filter(e=>e.id)}function E({formFields:e,answers:t,onChange:n,onBack:r,onNext:a,onError:s,layout:i,backLabel:o="<- Back",nextLabel:l="Next ->"}){const d=e?.customer||[],u=e?.booking||[],p=i?.customer?.fields?.length?i.customer.fields:P(d),m=i?.booking?.fields?.length?i.booking.fields:P(u);function b(e,t){n(e&&"object"==typeof e&&void 0===t?e:n=>({...n,[e]:t}))}function f(e){var n;return null!==(n=t?.[e])&&void 0!==n?n:""}return(0,c.jsxs)("div",{className:"bp-step",children:[(0,c.jsx)(S,{defs:d,layout:p,values:t,onChange:b,scope:"customer"}),u.length?(0,c.jsx)("div",{style:{marginTop:14},children:(0,c.jsx)(S,{defs:u,layout:m,values:t,onChange:b,scope:"booking"})}):null,(0,c.jsxs)("div",{className:"bp-step-footer",children:[(0,c.jsx)("button",{type:"button",className:"bp-back",onClick:r,children:o}),(0,c.jsx)("button",{type:"button",className:"bp-next",onClick:function(){const e=[{scope:"customer",defs:d,layout:p},{scope:"booking",defs:u,layout:m}];for(const a of e)for(const e of a.layout){var t,n,r;const i=a.defs.find(t=>C(t)===e.id);if(i&&((null!==(t=e.required)&&void 0!==t?t:null!==(n=null!==(r=i.is_required)&&void 0!==r?r:i.required)&&void 0!==n&&n)&&_(f(`${a.scope}.${e.id}`),i.type)))return void s?.(`${i.label||e.id} is required`)}s?.(""),a()},children:l})]})]})}function O(e){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O(e)}var T,L="clover",B="https://js.stripe.com",I="".concat(B,"/").concat(L,"/stripe.js"),$=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,R=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/,M="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",U=function(e){return $.test(e)||R.test(e)},A=function(e){var t=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",n=document.createElement("script");n.src="".concat(I).concat(t);var r=document.head||document.body;if(!r)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return r.appendChild(n),n},F=null,D=null,q=null,W=!1,Y=function(){return T||(T=(e=null,null!==F?F:(F=new Promise(function(t,n){if("undefined"!=typeof window&&"undefined"!=typeof document)if(window.Stripe&&e&&console.warn(M),window.Stripe)t(window.Stripe);else try{var r=function(){for(var e=document.querySelectorAll('script[src^="'.concat(B,'"]')),t=0;t<e.length;t++){var n=e[t];if(U(n.src))return n}return null}();if(r&&e)console.warn(M);else if(r){if(r&&null!==q&&null!==D){var a;r.removeEventListener("load",q),r.removeEventListener("error",D),null===(a=r.parentNode)||void 0===a||a.removeChild(r),r=A(e)}}else r=A(e);q=function(e,t){return function(){window.Stripe?e(window.Stripe):t(new Error("Stripe.js not available"))}}(t,n),D=function(e){return function(t){e(new Error("Failed to load Stripe.js",{cause:t}))}}(n),r.addEventListener("load",q),r.addEventListener("error",D)}catch(e){return void n(e)}else t(null)})).catch(function(e){return F=null,Promise.reject(e)})).catch(function(e){return T=null,Promise.reject(e)}));var e};Promise.resolve().then(function(){return Y()}).catch(function(e){W||console.warn(e)});var J=n(556);function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach(function(t){X(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function K(e){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},K(e)}function X(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=n){var r,a,s=[],_n=!0,i=!1;try{for(n=n.call(e);!(_n=(r=n.next()).done)&&(s.push(r.value),!t||s.length!==t);_n=!0);}catch(e){i=!0,a=e}finally{try{_n||null==n.return||n.return()}finally{if(i)throw a}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return G(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?G(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var V=function(t,n,r){var a=!!r,s=e.useRef(r);e.useEffect(function(){s.current=r},[r]),e.useEffect(function(){if(!a||!t)return function(){};var e=function(){s.current&&s.current.apply(s,arguments)};return t.on(n,e),function(){t.off(n,e)}},[a,n,t,s])},Q=function(t){var n=e.useRef(t);return e.useEffect(function(){n.current=t},[t]),n.current},ee=function(e){return null!==e&&"object"===K(e)},te="[object Object]",ne=function e(t,n){if(!ee(t)||!ee(n))return t===n;var r=Array.isArray(t);if(r!==Array.isArray(n))return!1;var a=Object.prototype.toString.call(t)===te;if(a!==(Object.prototype.toString.call(n)===te))return!1;if(!a&&!r)return t===n;var s=Object.keys(t),i=Object.keys(n);if(s.length!==i.length)return!1;for(var o={},c=0;c<s.length;c+=1)o[s[c]]=!0;for(var l=0;l<i.length;l+=1)o[i[l]]=!0;var d=Object.keys(o);if(d.length!==s.length)return!1;var u=t,p=n;return d.every(function(t){return e(u[t],p[t])})},re=function(e,t,n){return ee(e)?Object.keys(e).reduce(function(r,a){var s=!ee(t)||!ne(e[a],t[a]);return n.includes(a)?(s&&console.warn("Unsupported prop change: options.".concat(a," is not a mutable property.")),r):s?H(H({},r||{}),{},X({},a,e[a])):r},null):null},ae="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",se=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ae;if(null===e||ee(t=e)&&"function"==typeof t.elements&&"function"==typeof t.createToken&&"function"==typeof t.createPaymentMethod&&"function"==typeof t.confirmCardPayment)return e;throw new Error(n)},ie=e.createContext(null);ie.displayName="ElementsContext";var oe=function(e,t){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(t," in an <Elements> provider."));return e},ce=function(t){var n=t.stripe,r=t.options,a=t.children,s=e.useMemo(function(){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ae;if(function(e){return ee(e)&&"function"==typeof e.then}(e))return{tag:"async",stripePromise:Promise.resolve(e).then(function(e){return se(e,t)})};var n=se(e,t);return null===n?{tag:"empty"}:{tag:"sync",stripe:n}}(n)},[n]),i=Z(e.useState(function(){return{stripe:"sync"===s.tag?s.stripe:null,elements:"sync"===s.tag?s.stripe.elements(r):null}}),2),o=i[0],c=i[1];e.useEffect(function(){var e=!0,t=function(e){c(function(t){return t.stripe?t:{stripe:e,elements:e.elements(r)}})};return"async"!==s.tag||o.stripe?"sync"!==s.tag||o.stripe||t(s.stripe):s.stripePromise.then(function(n){n&&e&&t(n)}),function(){e=!1}},[s,o,r]);var l=Q(n);e.useEffect(function(){null!==l&&l!==n&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[l,n]);var d=Q(r);return e.useEffect(function(){if(o.elements){var e=re(r,d,["clientSecret","fonts"]);e&&o.elements.update(e)}},[r,d,o.elements]),e.useEffect(function(){var e;(e=o.stripe)&&e._registerWrapper&&e.registerAppInfo&&(e._registerWrapper({name:"react-stripe-js",version:"5.5.0"}),e.registerAppInfo({name:"react-stripe-js",version:"5.5.0",url:"https://stripe.com/docs/stripe-js/react"}))},[o.stripe]),e.createElement(ie.Provider,{value:o},a)};ce.propTypes={stripe:J.any,options:J.object};J.func.isRequired;var le=e.createContext(null);le.displayName="CheckoutContext",J.any,J.shape({clientSecret:J.oneOfType([J.string,J.instanceOf(Promise)]).isRequired,elementsOptions:J.object}).isRequired;var de=function(t){var n=e.useContext(le),r=e.useContext(ie);if(n){if(r)throw new Error("You cannot wrap the part of your app that ".concat(t," in both <CheckoutProvider> and <Elements> providers."));return n}return oe(r,t)},ue=["mode"],pe=function(t,n){var r,a="".concat((r=t).charAt(0).toUpperCase()+r.slice(1),"Element"),s=n?function(t){de("mounts <".concat(a,">"));var n=t.id,r=t.className;return e.createElement("div",{id:n,className:r})}:function(n){var r,s=n.id,i=n.className,o=n.options,c=void 0===o?{}:o,l=n.onBlur,d=n.onFocus,u=n.onReady,p=n.onChange,m=n.onEscape,b=n.onClick,f=n.onLoadError,h=n.onLoaderStart,g=n.onNetworksChange,y=n.onConfirm,v=n.onCancel,x=n.onShippingAddressChange,j=n.onShippingRateChange,k=n.onSavedPaymentMethodRemove,N=n.onSavedPaymentMethodUpdate,w=de("mounts <".concat(a,">")),S="elements"in w?w.elements:null,_="checkoutState"in w?w.checkoutState:null,C="success"===(null==_?void 0:_.type)||"loading"===(null==_?void 0:_.type)?_.sdk:null,P=Z(e.useState(null),2),E=P[0],O=P[1],T=e.useRef(null),L=e.useRef(null);V(E,"blur",l),V(E,"focus",d),V(E,"escape",m),V(E,"click",b),V(E,"loaderror",f),V(E,"loaderstart",h),V(E,"networkschange",g),V(E,"confirm",y),V(E,"cancel",v),V(E,"shippingaddresschange",x),V(E,"shippingratechange",j),V(E,"savedpaymentmethodremove",k),V(E,"savedpaymentmethodupdate",N),V(E,"change",p),u&&(r="expressCheckout"===t?u:function(){u(E)}),V(E,"ready",r),e.useLayoutEffect(function(){if(null===T.current&&null!==L.current&&(S||C)){var e=null;if(C)switch(t){case"paymentForm":e=C.createPaymentFormElement(c);break;case"payment":e=C.createPaymentElement(c);break;case"address":if(!("mode"in c))throw new Error("You must supply options.mode. mode must be 'billing' or 'shipping'.");var n=c.mode,r=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(c,ue);if("shipping"===n)e=C.createShippingAddressElement(r);else{if("billing"!==n)throw new Error("Invalid options.mode. mode must be 'billing' or 'shipping'.");e=C.createBillingAddressElement(r)}break;case"expressCheckout":e=C.createExpressCheckoutElement(c);break;case"currencySelector":e=C.createCurrencySelectorElement();break;case"taxId":e=C.createTaxIdElement(c);break;default:throw new Error("Invalid Element type ".concat(a,". You must use either the <PaymentElement />, <AddressElement options={{mode: 'shipping'}} />, <AddressElement options={{mode: 'billing'}} />, or <ExpressCheckoutElement />."))}else S&&(e=S.create(t,c));T.current=e,O(e),e&&e.mount(L.current)}},[S,C,c]);var B=Q(c);return e.useEffect(function(){if(T.current){var e=re(c,B,["paymentRequest"]);e&&"update"in T.current&&T.current.update(e)}},[c,B]),e.useLayoutEffect(function(){return function(){if(T.current&&"function"==typeof T.current.destroy)try{T.current.destroy(),T.current=null}catch(e){}}},[]),e.createElement("div",{id:s,className:i,ref:L})};return s.propTypes={id:J.string,className:J.string,onChange:J.func,onBlur:J.func,onFocus:J.func,onReady:J.func,onEscape:J.func,onClick:J.func,onLoadError:J.func,onLoaderStart:J.func,onNetworksChange:J.func,onConfirm:J.func,onCancel:J.func,onShippingAddressChange:J.func,onShippingRateChange:J.func,onSavedPaymentMethodRemove:J.func,onSavedPaymentMethodUpdate:J.func,options:J.object},s.displayName=a,s.__elementType=t,s},me="undefined"==typeof window;e.createContext(null).displayName="EmbeddedCheckoutProviderContext",pe("auBankAccount",me),pe("card",me),pe("cardNumber",me),pe("cardExpiry",me),pe("cardCvc",me),pe("iban",me);var be=pe("payment",me);function fe({bookingId:t,onPaid:n,onBack:r}){const a=de("calls useStripe()").stripe,s=(u="calls useElements()",p=e.useContext(ie),oe(p,u)).elements,[i,o]=(0,e.useState)(!1),[l,d]=(0,e.useState)("");var u,p;return(0,c.jsxs)("div",{className:"bp-pay-wrap",children:[(0,c.jsx)("div",{className:"bp-pay-box",children:(0,c.jsx)(be,{})}),l?(0,c.jsx)("div",{className:"bp-alert bp-alert-error",children:l}):null,(0,c.jsxs)("div",{className:"bp-pay-actions",children:[(0,c.jsx)("button",{type:"button",className:"bp-btn bp-btn-light",onClick:r,disabled:i,children:"Back"}),(0,c.jsx)("button",{type:"button",className:"bp-btn bp-btn-primary",onClick:async()=>{if(d(""),a&&s){o(!0);try{const{error:e,paymentIntent:r}=await a.confirmPayment({elements:s,confirmParams:{return_url:window.location.href},redirect:"if_required"});if(e)return d(e.message||"Payment failed."),void o(!1);const i=await fetch("/wp-json/bp/v1/front/payment/stripe/confirm",{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json","X-WP-Nonce":window.BP_FRONT?.nonce||""},body:JSON.stringify({booking_id:t,payment_intent_id:r?.id||"",status:r?.status||""})}),c=await i.json();if(c?.success)return void n();d("Payment not completed yet. Please try again.")}catch(e){d(e?.message||"Payment error.")}finally{o(!1)}}},disabled:!a||i,children:i?"Processing...":"Pay now"})]})]})}function he({bookingId:t,totalLabel:n,paymentMethod:r,onPaid:a,onBack:s}){const i=window.BP_FRONT?.stripe_pk||"",o=(0,e.useMemo)(()=>i?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];W=!0;var r=Date.now();return Y().then(function(e){return function(e,t,n){if(null===e)return null;var r=t[0];if("string"!=typeof r)throw new Error("Expected publishable key to be of type string, got type ".concat(O(r)," instead."));var a=r.match(/^pk_test/),s=function(e){return 3===e?"v3":e}(e.version),i=L;a&&s!==i&&console.warn("Stripe.js@".concat(s," was loaded on the page, but @stripe/stripe-js@").concat("8.6.4"," expected Stripe.js@").concat(i,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var o=e.apply(void 0,t);return function(e,t){e&&e._registerWrapper&&e._registerWrapper({name:"stripe-js",version:"8.6.4",startTime:t})}(o,n),o}(e,t,r)})}(i):null,[i]),[l,d]=(0,e.useState)(""),[u,p]=(0,e.useState)(!1),[m,b]=(0,e.useState)("");return(0,e.useEffect)(()=>{if(!t)return;if("stripe"!==r)return;let e=!0;return b(""),p(!0),fetch("/wp-json/bp/v1/front/payment/stripe/start",{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json","X-WP-Nonce":window.BP_FRONT?.nonce||""},body:JSON.stringify({booking_id:t})}).then(e=>e.json().then(t=>({ok:e.ok,j:t}))).then(({ok:t,j:n})=>{if(e){if(!t||!n?.success||!n?.client_secret)throw new Error(n?.message||"Could not start Stripe payment.");d(n.client_secret)}}).catch(t=>{e&&b(t?.message||"Stripe start error.")}).finally(()=>e&&p(!1)),()=>{e=!1}},[t,r]),"stripe"!==r?(0,c.jsxs)("div",{className:"bp-step",children:[(0,c.jsx)("h3",{children:"Payment"}),(0,c.jsxs)("div",{className:"bp-muted",children:["Selected method: ",r]}),(0,c.jsx)("div",{className:"bp-pay-actions",style:{marginTop:12},children:(0,c.jsx)("button",{type:"button",className:"bp-btn bp-btn-light",onClick:s,children:"Back"})})]}):i?(0,c.jsxs)("div",{className:"bp-step",children:[(0,c.jsxs)("div",{className:"bp-step-head",children:[(0,c.jsx)("h3",{children:"Payment"}),(0,c.jsx)("div",{className:"bp-total",children:n})]}),m?(0,c.jsx)("div",{className:"bp-alert bp-alert-error",children:m}):null,u&&!l?(0,c.jsx)("div",{className:"bp-muted",children:"Preparing secure payment..."}):null,l&&o?(0,c.jsx)(ce,{stripe:o,options:{clientSecret:l},children:(0,c.jsx)(fe,{bookingId:t,onPaid:a,onBack:s})}):null]}):(0,c.jsxs)("div",{className:"bp-step",children:[(0,c.jsx)("h3",{children:"Payment"}),(0,c.jsx)("div",{className:"bp-alert bp-alert-error",children:"Stripe publishable key is missing. Please configure it in BookPoint Settings."}),(0,c.jsx)("div",{className:"bp-pay-actions",children:(0,c.jsx)("button",{type:"button",className:"bp-btn bp-btn-light",onClick:s,children:"Back"})})]})}function ge({locationId:t,categoryIds:n,serviceId:r,extraIds:a,agentId:s,date:i,slot:o,locations:l,categories:d,services:u,extras:p,agents:m,formFields:b,answers:f,paymentMethodLabel:h,totalLabel:g,onBack:y,onNext:v,isCreatingBooking:x,createError:j,loading:k,backLabel:N="<- Back",nextLabel:w="Next ->"}){const S=l.find(e=>String(e.id)===String(t)),_=u.find(e=>String(e.id)===String(r)),C=m.find(e=>String(e.id)===String(s)),P=d.filter(e=>n.includes(e.id)||n.includes(String(e.id))),E=p.filter(e=>a.includes(e.id)||a.includes(String(e.id))),O=(0,e.useMemo)(()=>[...b?.form||[],...b?.customer||[],...b?.booking||[]],[b]);return(0,c.jsxs)("div",{className:"bp-step",children:[(0,c.jsxs)("div",{className:"bp-review",children:[(0,c.jsx)(ye,{label:"Location",value:S?.name}),(0,c.jsx)(ye,{label:"Categories",value:P.length?P.map(e=>e.name).join(", "):"-"}),(0,c.jsx)(ye,{label:"Service",value:_?.name}),(0,c.jsx)(ye,{label:"Agent",value:C?.name}),(0,c.jsx)(ye,{label:"Date",value:i}),(0,c.jsx)(ye,{label:"Time",value:o?.start_time?`${o.start_time} - ${o.end_time}`:"-"}),(0,c.jsx)(ye,{label:"Extras",value:E.length?E.map(e=>e.name).join(", "):"-"}),h?(0,c.jsx)(ye,{label:"Payment Method",value:h}):null,g?(0,c.jsx)(ye,{label:"Total",value:g}):null,(0,c.jsx)("div",{className:"bp-review-section",children:"Customer Information"}),O.map(e=>{var t;const n=e.field_key||e.name_key||"",r=`${e.scope}.${n}`;let a=null!==(t=f?.[r])&&void 0!==t?t:"";return"checkbox"===e.type&&(a="1"===a?"Yes":"No"),(0,c.jsx)(ye,{label:e.label,value:String(a||"")},r)})]}),j?(0,c.jsx)("div",{className:"bp-alert bp-alert-error bp-mt-12",children:j}):null,(0,c.jsxs)("div",{className:"bp-step-footer",children:[(0,c.jsx)("button",{type:"button",className:"bp-back",onClick:y,children:N}),(0,c.jsx)("button",{type:"button",className:"bp-next",disabled:!!x,onClick:v,children:x?"Preparing payment...":w})]})]})}function ye({label:e,value:t}){return(0,c.jsxs)("div",{className:"bp-review-row",children:[(0,c.jsx)("div",{className:"k",children:e}),(0,c.jsx)("div",{className:"v",children:t||"-"})]})}function ve({bookingId:e,confirmInfo:t,loading:n,error:r,onRetry:a,onClose:s,summary:i}){const o=t?.status||"",l=t?.payment_status||"",d="confirmed"===o&&"paid"===l,u="pending_payment"===o||"unpaid"===l||"processing"===l;return(0,c.jsxs)("div",{className:"bp-step",children:[(0,c.jsx)("div",{className:"bp-step-head",children:(0,c.jsx)("h3",{children:"Confirmation"})}),n?(0,c.jsx)("div",{className:"bp-muted",children:"Loading booking status..."}):null,r?(0,c.jsx)("div",{className:"bp-alert bp-alert-error",children:r}):null,n||r?null:(0,c.jsxs)(c.Fragment,{children:[d?(0,c.jsx)("div",{className:"bp-alert bp-alert-success",children:"✅ Payment successful. Your booking is confirmed."}):u?(0,c.jsx)("div",{className:"bp-alert bp-alert-warn",children:"⏳ Payment is still processing. If it doesn’t confirm in a moment, click Retry."}):(0,c.jsx)("div",{className:"bp-alert bp-alert-error",children:"❌ Payment was not completed. Please try again."}),(0,c.jsxs)("div",{className:"bp-confirm-card",children:[(0,c.jsxs)("div",{className:"bp-row",children:[(0,c.jsx)("strong",{children:"Booking ID:"})," ",(0,c.jsxs)("span",{children:["#",e]})]}),(0,c.jsxs)("div",{className:"bp-row",children:[(0,c.jsx)("strong",{children:"Status:"})," ",(0,c.jsx)("span",{children:o||"-"})]}),(0,c.jsxs)("div",{className:"bp-row",children:[(0,c.jsx)("strong",{children:"Payment:"})," ",(0,c.jsx)("span",{children:l||"-"})]}),t?.payment_method?(0,c.jsxs)("div",{className:"bp-row",children:[(0,c.jsx)("strong",{children:"Method:"})," ",(0,c.jsx)("span",{children:t.payment_method})]}):null]}),i?(0,c.jsxs)("div",{className:"bp-confirm-summary",children:[(0,c.jsx)("h4",{children:"Summary"}),(0,c.jsx)("div",{className:"bp-muted",children:i})]}):null,(0,c.jsxs)("div",{className:"bp-pay-actions",style:{justifyContent:"space-between"},children:[(0,c.jsx)("button",{type:"button",className:"bp-btn bp-btn-light",onClick:s,children:"Close"}),d?null:(0,c.jsx)("button",{type:"button",className:"bp-btn bp-btn-primary",onClick:a,children:"Retry payment"})]})]})]})}pe("expressCheckout",me),pe("paymentRequestButton",me),pe("linkAuthentication",me),pe("address",me),pe("shippingAddress",me),pe("paymentMethodMessaging",me),pe("taxId",me);let xe="undefined"!=typeof window&&window.BP_FRONT?.settings||null;const je=[{key:"location",title:"Location Selection",icon:"location-image.png"},{key:"category",title:"Choose Category",icon:"service-image.png"},{key:"service",title:"Choose Service",icon:"service-image.png"},{key:"extras",title:"Service Extras",icon:"service-image.png"},{key:"agent",title:"Choose Agent",icon:"default-avatar.jpg"},{key:"datetime",title:"Choose Date & Time",icon:"blue-dot.png"},{key:"customer",title:"Customer Information",icon:"default-avatar.jpg"},{key:"review",title:"Review Order",icon:"white-curve.png"},{key:"payment",title:"Payment",icon:"payment_now.png"},{key:"confirmation",title:"Confirm",icon:"logo.png"}],ke=["location","category","service","extras","agent","datetime","customer","review","payment","confirmation"].slice(),Ne=new Set(["service","agent","datetime","customer","review","confirmation"]);function we(e){return e?"agents"===e||"agent"===e?"agent":"done"===e||"confirm"===e||"confirmation"===e?"confirmation":e:""}function Se(e){return!1!==e&&0!==e&&"0"!==e}function _e(){return(window.BP_FRONT?.restUrl||"/wp-json/bp/v1").replace(/\/$/,"")}async function Ce(e){const t=await fetch(`${_e()}/front/bookings/${e}/status?_t=${Date.now()}`,{credentials:"same-origin",headers:{"X-WP-Nonce":window.BP_FRONT?.nonce||""}}),n=await t.json().catch(()=>({}));if(!t.ok||!n?.success)throw new Error(n?.message||"Could not load booking status");return n.booking}function Pe({open:t,onClose:n,brand:o}){const[u,h]=(0,e.useState)(0),{config:g,loading:y,error:v}=function(t){const[n,r]=(0,e.useState)(!1),[a,s]=(0,e.useState)(null),[i,o]=(0,e.useState)("");return(0,e.useEffect)(()=>{if(!t)return;let e=!0;r(!0),o("");const n=`/wp-json/bp/v1/front/booking-form-design?_t=${Date.now()}`;return fetch(n,{credentials:"same-origin"}).then(async e=>{const t=await e.json().catch(()=>null);if(!e.ok)throw new Error(t?.message||`Design fetch failed (${e.status})`);return t}).then(t=>{e&&s(t?.config||null)}).catch(t=>{e&&(s(null),o(t.message||"Design fetch failed"))}).finally(()=>{e&&r(!1)}),()=>{e=!1}},[t]),{config:a,loading:n,error:i}}(t),x=(0,e.useMemo)(()=>function(e){const t=new Map(je.map(e=>[e.key,e])),n=Array.isArray(e?.steps)?e.steps:[],r=[],a=new Set;for(const e of n){const t=we(e?.key);t&&(a.has(t)||(a.add(t),r.push({key:t,enabled:Se(e?.enabled),title:e?.title,subtitle:e?.subtitle,image:e?.image,buttonBackLabel:e?.buttonBackLabel,buttonNextLabel:e?.buttonNextLabel,accentOverride:e?.accentOverride,showLeftPanel:e?.showLeftPanel,showHelpBox:e?.showHelpBox})))}for(const e of je)a.has(e.key)||r.push({key:e.key,enabled:!0});const s=new Map(r.map(e=>[e.key,e]));return ke.filter(e=>s.has(e)).map(e=>{const n=s.get(e)||{},r=t.get(e)||{key:e,title:e,icon:"service-image.png"};return{...r,key:e,enabled:!!Ne.has(e)||Se(n.enabled),title:null!=n.title&&""!==String(n.title).trim()?String(n.title):r.title,subtitle:null!=n.subtitle?String(n.subtitle):"",icon:n.image||r.icon,image:n.image||r.icon,buttonBackLabel:n.buttonBackLabel,buttonNextLabel:n.buttonNextLabel,accentOverride:n.accentOverride,showLeftPanel:n.showLeftPanel,showHelpBox:n.showHelpBox}}).filter(e=>!!e&&!1!==e.enabled)}(g),[g]),{settings:k}=function(t){const[n,r]=(0,e.useState)(xe),[a,s]=(0,e.useState)(!xe&&!!t);return(0,e.useEffect)(()=>{if(!t)return;if(xe)return void r(xe);let e=!0;s(!0);const n=("undefined"!=typeof window?window.BP_FRONT?.restUrl:"")||"/wp-json/bp/v1",a=`${String(n).replace(/\/$/,"")}/public/settings?_t=${Date.now()}`;return fetch(a,{credentials:"same-origin"}).then(e=>e.json()).then(t=>{e&&(xe=t?.data||t?.settings||null,r(xe))}).catch(()=>{e&&r(null)}).finally(()=>{e&&s(!1)}),()=>{e=!1}},[t]),{settings:n,loading:a}}(t),[N,w]=(0,e.useState)(null),[S,_]=(0,e.useState)([]),[C,P]=(0,e.useState)(null),[O,T]=(0,e.useState)([]),[L,B]=(0,e.useState)(null),[I,$]=(0,e.useState)(null),[R,M]=(0,e.useState)(null),[U,A]=(0,e.useState)(""),[F,D]=(0,e.useState)(0),[q,W]=(0,e.useState)(null),[Y,J]=(0,e.useState)(!1),[z,H]=(0,e.useState)(null),[K,X]=(0,e.useState)({mode:"",bookingId:0,token:"",action:""}),[Z,G]=(0,e.useState)(!1),[V,Q]=(0,e.useState)(""),[ee,te]=(0,e.useState)(null),[ne,re]=(0,e.useState)(null),[ae,se]=(0,e.useState)(!1),[ie,oe]=(0,e.useState)(""),[ce,le]=(0,e.useState)({form:[],customer:[],booking:[]}),[de,ue]=(0,e.useState)({}),[pe,me]=(0,e.useState)([]),[be,fe]=(0,e.useState)([]),[ye,Pe]=(0,e.useState)([]),[Oe,Te]=(0,e.useState)([]),[Le,Be]=(0,e.useState)([]),[Ie,$e]=(0,e.useState)(!1),[Re,Me]=(0,e.useState)(""),Ue=(Array.isArray(k?.payments_enabled_methods)&&k.payments_enabled_methods.length&&k.payments_enabled_methods,0!==k?.payments_enabled),Ae=(0,e.useMemo)(()=>Ue?x:x.filter(e=>"payment"!==e.key),[x,Ue]),Fe=(0,e.useMemo)(()=>Ae.some(e=>"payment"===e.key),[Ae]),De=(0,e.useMemo)(()=>Ae.some(e=>"service"===e.key),[Ae]),qe=(0,e.useMemo)(()=>Ae.some(e=>"agent"===e.key),[Ae]),We=Ae[u]||Ae[0]||je[0],Ye=g?.appearance?.primaryColor||"",Je=We?.accentOverride&&""!==String(We.accentOverride).trim()?String(We.accentOverride).trim():Ye&&""!==String(Ye).trim()?String(Ye).trim():"",ze=(0,e.useMemo)(()=>{const e={};return Je&&(e["--bp-accent"]=Je),"square"===String(g?.appearance?.borderStyle||"").toLowerCase()&&(e.borderRadius=0),e},[Je,g?.appearance?.borderStyle]),He=(0,e.useMemo)(()=>{if(We?.imageUrl)return We.imageUrl;const e=We?.icon||We?.image||"service-image.png";return o?.imagesBase?o.imagesBase+e:""},[o,We]),Ke=g?.texts?.helpTitle||"Need help?",Xe=g?.texts?.helpPhone||g?.layout?.helpPhone||o?.helpPhone||"",Ze=!1!==We?.showLeftPanel,Ge=!1!==We?.showHelpBox,Ve=g?.texts?.nextLabel||"Next ->",Qe=g?.texts?.backLabel||"<- Back",et=(0,e.useMemo)(()=>({next:null!=We?.buttonNextLabel&&""!==String(We.buttonNextLabel).trim()?String(We.buttonNextLabel):Ve,back:null!=We?.buttonBackLabel&&""!==String(We.buttonBackLabel).trim()?String(We.buttonBackLabel):Qe}),[We?.buttonNextLabel,We?.buttonBackLabel,Ve,Qe]),tt=(0,e.useMemo)(()=>{const e=ye.find(e=>String(e.id)===String(C));return(null!=e?.price?Number(e.price):0)+Oe.filter(e=>O.includes(e.id)||O.includes(String(e.id))).reduce((e,t)=>e+(null!=t?.price?Number(t.price):0),0)},[ye,C,Oe,O]);(0,e.useEffect)(()=>{if(t)return document.body.classList.add("bp-modal-open"),()=>document.body.classList.remove("bp-modal-open")},[t]),(0,e.useEffect)(()=>{t&&(h(0),Me(""),w(null),_([]),P(null),T([]),B(null),$(null),M(null),A(""),D(0),W(null),J(!1),H(null),X({mode:"",bookingId:0,token:"",action:""}),G(!1),Q(""),te(null),ue({}))},[t]),(0,e.useEffect)(()=>{t&&(De||C||1!==ye.length||P(ye[0].id))},[t,De,C,ye]),(0,e.useEffect)(()=>{t&&(qe||L||1!==Le.length||B(Le[0].id))},[t,qe,L,Le]),(0,e.useEffect)(()=>{t&&(Ue?!U&&k?.payments_default_method&&A(k.payments_default_method):A("cash"))},[t,k,U,Ue]),(0,e.useEffect)(()=>{if(!t)return;const e=new URLSearchParams(window.location.search),n=e.get("bp_payment"),r=e.get("token")||"",a=Number(e.get("booking_id")||0),s="paypal_return"===n||"paypal_cancel"===n;a&&("stripe_success"===n||"stripe_cancel"===n?X({mode:"stripe",bookingId:a,token:"",action:"stripe_cancel"===n?"cancel":"success"}):s&&X({mode:"paypal",bookingId:a,token:r,action:"paypal_cancel"===n?"cancel":"success"}))},[t]),(0,e.useEffect)(()=>{if(!t)return;if(!K.bookingId||!K.mode)return;let e=!0;return G(!0),Q(""),(async()=>{try{if("cancel"===K.action)throw await fetch(`${_e()}/front/bookings/${K.bookingId}/payment-cancel`,{method:"POST",credentials:"same-origin"}),new Error("Payment cancelled.");if("paypal"===K.mode){if(!K.token)throw await fetch(`${_e()}/front/bookings/${K.bookingId}/payment-cancel`,{method:"POST",credentials:"same-origin"}),new Error("Payment cancelled.");await async function(e,t){const n=await fetch(`${_e()}/front/payments/paypal/capture`,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify({order_id:e,booking_id:t})}),r=await n.json().catch(()=>({}));if(!n.ok)throw new Error(r?.message||"PayPal capture failed");return r}(K.token,K.bookingId)}const t=await async function(e){let t=null;for(let n=0;n<10;n++){const n=await Ce(e);if(t=n,"confirmed"===n?.status&&"paid"===n?.payment_status)return n;await new Promise(e=>setTimeout(e,1e3))}return t}(K.bookingId);if(!e)return;W(K.bookingId),D(K.bookingId),ue(e=>({...e,__booking:{booking_id:K.bookingId}})),te("confirmed"===t?.status&&"paid"===t?.payment_status?{booking:t,paid:!0,error:""}:{booking:t,paid:!1,error:"",pending:!0}),st("confirmation")}catch(t){if(!e)return;const n=t?.message||"Payment failed";Q(n),W(K.bookingId),D(K.bookingId),ue(e=>({...e,__booking:{booking_id:K.bookingId}})),te({booking:{id:K.bookingId},paid:!1,error:n}),st("confirmation")}finally{if(!e)return;G(!1),function(){const e=new URL(window.location.href);e.searchParams.delete("bp_payment"),e.searchParams.delete("booking_id"),e.searchParams.delete("token"),window.history.replaceState({},"",e.toString())}()}})(),()=>{e=!1}},[t,K]),(0,e.useEffect)(()=>{"Select a payment method"===Re&&U&&Me("")},[Re,U]),(0,e.useEffect)(()=>{t&&(async()=>{try{$e(!0);const[e,t,n]=await Promise.all([r("/front/locations"),r("/front/categories"),i()]);me(e),fe(t),le(n)}catch(e){Me(e?.message||"Failed to load booking data.")}finally{$e(!1)}})()},[t]),(0,e.useEffect)(()=>{t&&Ae.map(e=>e.key).join("|")&&h(0)},[t,Ae]),(0,e.useEffect)(()=>{h(e=>e<0?0:e>=Ae.length?Math.max(0,Ae.length-1):e)},[Ae.length]);const nt=Ae[u]?.key;function rt(){Me(""),"payment"!==We?.key||U?h(e=>Math.min(e+1,Ae.length-1)):Me("Select a payment method")}function at(){Me(""),h(e=>Math.max(e-1,0))}function st(e){const t=Ae.findIndex(t=>t.key===e);t>=0&&h(t)}(0,e.useEffect)(()=>{if(!t)return;if("confirmation"!==nt)return;if(!q)return;let e=!0;return se(!0),oe(""),Ce(q).then(t=>e&&re(t)).catch(t=>e&&oe(t.message||"Error")).finally(()=>e&&se(!1)),()=>{e=!1}},[t,nt,q]),(0,e.useEffect)(()=>{t&&(async()=>{try{if("service"===We.key||"extras"===We.key||"agent"===We.key||"datetime"===We.key||"review"===We.key){const e=await(({category_ids:e=[],location_id:t=null})=>r("/front/services",{method:"POST",body:JSON.stringify({category_ids:e,location_id:t})}))({category_ids:S,location_id:N});Pe(e)}}catch(e){Pe([])}})()},[t,We.key,S,N]),(0,e.useEffect)(()=>{t&&(async()=>{try{if(!C)return;const[e,t]=await Promise.all([a({service_id:C}),s({service_id:C,location_id:N})]);Te(e),Be(t)}catch(e){Te([]),Be([])}})()},[t,C,N]);const it=()=>{const e={},t={};Object.entries(de||{}).forEach(([n,r])=>{n.startsWith("customer.")?e[n.slice(9)]=r:n.startsWith("booking.")&&(t[n.slice(8)]=r)});const n=k?.currency||window.BP_FRONT?.currency||"USD";return{location_id:N,category_ids:S,service_id:C,extra_ids:O,agent_id:L,date:I,start_time:R?.start_time||R?.start||"",end_time:R?.end_time||R?.end||"",field_values:de,customer_fields:e,booking_fields:t,extras:O,total_price:tt,currency:n}};return t?y&&!g?(0,c.jsx)("div",{className:"bp-wizard-loading",children:"Loading booking form…"}):v&&!g?(0,c.jsxs)("div",{className:"bp-wizard-loading",children:["Wizard error: ",v]}):Ae.length?(0,c.jsx)("div",{className:"bp-modal-overlay",role:"dialog","aria-modal":"true",children:(0,c.jsxs)("div",{className:"bp-modal",style:ze,children:[(0,c.jsx)("button",{className:"bp-modal-close",onClick:n,"aria-label":"Close",children:"x"}),(0,c.jsxs)("div",{className:"bp-modal-grid",children:[Ze?(0,c.jsxs)("aside",{className:"bp-side",children:[(0,c.jsx)("div",{className:"bp-side-icon",children:He?(0,c.jsx)("img",{src:He,alt:""}):null}),(0,c.jsx)("h3",{className:"bp-side-title",children:We.title}),(0,c.jsx)("p",{className:"bp-side-desc",children:We.subtitle||"Please complete the steps to schedule your booking."}),Ge?(0,c.jsxs)("div",{className:"bp-side-help",children:[(0,c.jsx)("div",{children:Ke}),(0,c.jsx)("div",{className:"bp-help-phone",children:Xe})]}):null]}):null,(0,c.jsxs)("main",{className:"bp-main",children:[(0,c.jsxs)("div",{className:"bp-main-head",children:[(0,c.jsx)("h2",{children:We.title}),(0,c.jsx)("div",{className:"bp-step-dots",children:Ae.slice(0,8).map((e,t)=>(0,c.jsx)("span",{className:t===u?"bp-dot active":"bp-dot"},e.key))})]}),Re?(0,c.jsx)("div",{className:"bp-error",children:Re}):null,Ie?(0,c.jsx)("div",{className:"bp-loading",children:"Loading..."}):null,"location"===We.key&&(0,c.jsx)(l,{locations:pe,value:N,onChange:w,onNext:rt,nextLabel:et.next}),"category"===We.key&&(0,c.jsx)(d,{categories:be,value:S,onChange:_,onBack:at,onNext:rt,backLabel:et.back,nextLabel:et.next}),"service"===We.key&&(0,c.jsx)(m,{services:ye,value:C,onChange:P,onBack:at,onNext:rt,settings:k,backLabel:et.back,nextLabel:et.next}),"extras"===We.key&&(0,c.jsx)(b,{extras:Oe,value:O,onChange:T,onBack:at,onNext:rt,settings:k,backLabel:et.back,nextLabel:et.next}),"agent"===We.key&&(0,c.jsx)(f,{agents:Le,value:L,onChange:B,onBack:at,onNext:rt,backLabel:et.back,nextLabel:et.next}),"datetime"===We.key&&(0,c.jsx)(j,{locationId:N,serviceId:C,agentId:L,serviceDurationMin:ye.find(e=>String(e.id)===String(C))?.duration||30,valueDate:I,valueSlot:R,onChangeDate:e=>{$(e),M(null)},onChangeSlot:M,onBack:at,onNext:rt,backLabel:et.back,nextLabel:et.next}),"customer"===We.key&&(0,c.jsx)(E,{formFields:ce,answers:de,onChange:ue,onBack:at,onNext:rt,onError:Me,layout:g?.fieldsLayout,backLabel:et.back,nextLabel:et.next}),"payment"===We.key&&(0,c.jsx)(he,{bookingId:q,paymentMethod:U,totalLabel:p(tt,k),onBack:()=>st("review"),onPaid:()=>st("confirmation")}),"review"===We.key&&(0,c.jsx)(ge,{locationId:N,categoryIds:S,serviceId:C,extraIds:O,agentId:L,date:I,slot:R,locations:pe,categories:be,services:ye,extras:Oe,agents:Le,formFields:ce,answers:de,bookingId:q,paymentMethodLabel:{free:"Free (no payment)",cash:"Pay at location (Cash)",woocommerce:"Pay with WooCommerce",stripe:"Pay with Stripe",paypal:"Pay with PayPal"}[U]||U||"-",totalLabel:p(tt,k),onBack:at,onNext:async()=>{if(Ue&&Fe)return await(async()=>{if(q)return q;J(!0),H(null);try{const e=it();e.payment_method=U||"cash";const t=await fetch(`${_e()}/front/booking/create`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.BP_FRONT?.nonce||""},credentials:"same-origin",body:JSON.stringify(e)}),n=await t.json().catch(()=>({}));if(!t.ok||!n?.success)throw new Error(n?.message||"Could not create booking");return W(n.booking_id),n.booking_id}catch(e){throw H(e.message||"Create booking failed"),e}finally{J(!1)}})(),void st("payment");await async function(){try{$e(!0),Me("");const e=it(),t=Ue&&(U||k?.payments_default_method)||"cash";if(e.payment_method=t,"woocommerce"===t){const t=await(e=>r("/front/payments/woocommerce/start",{method:"POST",body:JSON.stringify(e)}))(e);if(!t?.checkout_url)throw new Error("Checkout URL missing");return void(window.location.href=t.checkout_url)}if("stripe"===t){const t=await(e=>r("/front/payments/stripe/start",{method:"POST",body:JSON.stringify(e)}))(e);if(!t?.checkout_url)throw new Error("Stripe checkout URL missing");return void(window.location.href=t.checkout_url)}if("paypal"===t){const t=await(e=>r("/front/payments/paypal/start",{method:"POST",body:JSON.stringify(e)}))(e);if(!t?.approve_url)throw new Error("PayPal approve URL missing");return void(window.location.href=t.approve_url)}if("cash"!==t&&"free"!==t)throw new Error("Unsupported payment method");const n=await(e=>r("/front/bookings",{method:"POST",body:JSON.stringify(e)}))(e);W(n?.booking_id||null),D(n?.booking_id||0),te({booking:n,paid:"free"===t,error:""}),ue(e=>({...e,__booking:n}));const a=Ae.findIndex(e=>"confirmation"===e.key);h(a>=0?a:Ae.length-1)}catch(e){Me(e?.message||"Could not submit booking.")}finally{$e(!1)}}()},isCreatingBooking:Y,createError:z,loading:Ie,backLabel:et.back,nextLabel:et.next}),"confirmation"===We.key&&(0,c.jsx)(ve,{bookingId:q,confirmInfo:ne,loading:ae,error:ie,summary:null,onClose:n,onRetry:()=>st("payment")})]}),(0,c.jsxs)("aside",{className:"bp-summary",children:[(0,c.jsx)("div",{className:"bp-summary-title",children:"Summary"}),(0,c.jsx)("div",{className:"bp-summary-box",children:(0,c.jsx)(Ee,{settings:k,locations:pe,categories:be,services:ye,extras:Oe,agents:Le,locationId:N,categoryIds:S,serviceId:C,extraIds:O,agentId:L,date:I,slot:R})})]})]})]})}):(0,c.jsx)("div",{className:"bp-wizard-loading",children:"Wizard config invalid (no steps)"}):null}function Ee(e){const{settings:t,locations:n,categories:r,services:a,extras:s,agents:i,locationId:o,categoryIds:l,serviceId:d,extraIds:u,agentId:m,date:b,slot:f}=e,h=n.find(e=>String(e.id)===String(o)),g=a.find(e=>String(e.id)===String(d)),y=i.find(e=>String(e.id)===String(m)),v=s.filter(e=>u.includes(e.id)||u.includes(String(e.id))),x=r.filter(e=>l.includes(e.id)||l.includes(String(e.id))),j=null!=g?.price?Number(g.price):0,k=v.reduce((e,t)=>e+(null!=t?.price?Number(t.price):0),0),N=j+k;return(0,c.jsxs)("div",{className:"bp-summary-items",children:[(0,c.jsxs)("div",{className:"bp-summary-row",children:[(0,c.jsx)("div",{className:"k",children:"Location"}),(0,c.jsx)("div",{className:"v",children:h?.name||"-"})]}),(0,c.jsxs)("div",{className:"bp-summary-row",children:[(0,c.jsx)("div",{className:"k",children:"Category"}),(0,c.jsx)("div",{className:"v",children:x.length?x.map(e=>e.name).join(", "):"-"})]}),(0,c.jsxs)("div",{className:"bp-summary-row",children:[(0,c.jsx)("div",{className:"k",children:"Service"}),(0,c.jsx)("div",{className:"v",children:g?.name||"-"})]}),(0,c.jsxs)("div",{className:"bp-summary-row",children:[(0,c.jsx)("div",{className:"k",children:"Service Price"}),(0,c.jsx)("div",{className:"v",children:null!=g?.price?p(j,t):"-"})]}),(0,c.jsxs)("div",{className:"bp-summary-row",children:[(0,c.jsx)("div",{className:"k",children:"Agent"}),(0,c.jsx)("div",{className:"v",children:y?.name||"-"})]}),(0,c.jsxs)("div",{className:"bp-summary-row",children:[(0,c.jsx)("div",{className:"k",children:"Date"}),(0,c.jsx)("div",{className:"v",children:b||"-"})]}),(0,c.jsxs)("div",{className:"bp-summary-row",children:[(0,c.jsx)("div",{className:"k",children:"Time"}),(0,c.jsx)("div",{className:"v",children:f?.start_time?`${f.start_time} - ${f.end_time}`:"-"})]}),(0,c.jsxs)("div",{className:"bp-summary-row",children:[(0,c.jsx)("div",{className:"k",children:"Extras"}),(0,c.jsx)("div",{className:"v",children:v.length?v.map(e=>e.name).join(", "):"-"})]}),(0,c.jsxs)("div",{className:"bp-summary-row",children:[(0,c.jsx)("div",{className:"k",children:"Extras Price"}),(0,c.jsx)("div",{className:"v",children:v.length?p(k,t):"-"})]}),(0,c.jsxs)("div",{className:"bp-summary-row",children:[(0,c.jsx)("div",{className:"k",children:"Total"}),(0,c.jsx)("div",{className:"v",children:null!=g?.price||v.length?p(N,t):"-"})]})]})}function Oe({label:t,mountEl:n}){const[r,a]=(0,e.useState)(!1),s="1"===n?.getAttribute("data-bp-fallback"),i=(window.BP_FRONT?.images||"").replace(/\/$/,"")+"/",o=(0,e.useMemo)(()=>({imagesBase:i,helpPhone:"+1 234 567 89"}),[i]);return(0,e.useEffect)(()=>function(e,t){return e?(e.__bpOpen=()=>t(!0),()=>{e.__bpOpen&&delete e.__bpOpen}):()=>{}}(n,a),[n]),(0,c.jsxs)(c.Fragment,{children:[!s&&(0,c.jsx)("button",{className:"bp-book-btn",type:"button",onClick:()=>a(!0),children:t||"Book Now"}),(0,c.jsx)(Pe,{open:r,onClose:()=>a(!1),brand:o})]})}function Te(){const e=document.querySelectorAll(".bp-front-root[data-bp-widget='wizard']");e.length?(e.forEach(e=>{const n=(0,t.H)(e),r=e.getAttribute("data-bp-label")||"Book Now";n.render((0,c.jsx)(Oe,{label:r,mountEl:e}))}),document.addEventListener("click",e=>{const t=e.target;if(!(t instanceof Element))return;const n=t.closest('.bp-fallback-btn, [data-bp-open="wizard"]');if(!n)return;const r=n.nextElementSibling,a=r&&r.classList.contains("bp-front-root")?r:n.closest(".bp-front-root")||document.querySelector(".bp-front-root");a&&"function"==typeof a.__bpOpen&&(e.preventDefault(),a.__bpOpen())})):function(){const e=document.getElementById("bp-front-root");if(!e)return;const n=(0,t.H)(e),r={imagesBase:(window.BP_FRONT?.images||"").replace(/\/$/,"")+"/",helpPhone:"+1 234 567 89"};document.addEventListener("click",t=>{const a=t.target;a instanceof Element&&a.closest(".bp-open-wizard")&&(t.preventDefault(),e.style.display="block",n.render((0,c.jsx)(Pe,{open:!0,onClose:()=>{n.render(null),e.style.display="none"},brand:r})))})}()}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",Te):Te()})()})();